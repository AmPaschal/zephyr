
<html>
<head>
<title>zephyr/include/zephyr/logging/log_msg.h</title>
<link rel="stylesheet" type="text/css" href="../../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /*</div><div id="2" class="line none">    2  * Copyright (c) 2021 Nordic Semiconductor ASA</div><div id="3" class="line none">    3  *</div><div id="4" class="line none">    4  * SPDX-License-Identifier: Apache-2.0</div><div id="5" class="line none">    5  */</div><div id="6" class="line none">    6 #ifndef <a href="log_msg.h.html#7">ZEPHYR_INCLUDE_LOGGING_LOG_MSG_H_</a></div><div id="7" class="line none">    7 #define <a href="log_msg.h.html#7">ZEPHYR_INCLUDE_LOGGING_LOG_MSG_H_</a></div><div id="8" class="line none">    8 </div><div id="9" class="line none">    9 #include &lt;zephyr/logging/log_instance.h&gt;</div><div id="10" class="line none">   10 #include &lt;zephyr/sys/mpsc_packet.h&gt;</div><div id="11" class="line none">   11 #include &lt;zephyr/sys/cbprintf.h&gt;</div><div id="12" class="line none">   12 #include &lt;zephyr/sys/atomic.h&gt;</div><div id="13" class="line none">   13 #include &lt;zephyr/sys/iterable_sections.h&gt;</div><div id="14" class="line none">   14 #include &lt;zephyr/sys/util.h&gt;</div><div id="15" class="line none">   15 #include &lt;string.h&gt;</div><div id="16" class="line none">   16 #include &lt;zephyr/toolchain.h&gt;</div><div id="17" class="line none">   17 </div><div id="18" class="line none">   18 #ifdef __GNUC__</div><div id="19" class="line none">   19 #ifndef <a href="log_msg.h.html#20">alloca</a></div><div id="20" class="line none">   20 #define <a href="log_msg.h.html#20">alloca</a> __builtin_alloca</div><div id="21" class="line none">   21 #endif</div><div id="22" class="line none">   22 #else</div><div id="23" class="line none">   23 #include &lt;<a href="log_msg.h.html#20">alloca</a>.h&gt;</div><div id="24" class="line none">   24 #endif</div><div id="25" class="line none">   25 </div><div id="26" class="line none">   26 #ifdef __cplusplus</div><div id="27" class="line none">   27 extern "C" {</div><div id="28" class="line none">   28 #endif</div><div id="29" class="line none">   29 </div><div id="30" class="line none">   30 #define <a href="log_msg.h.html#30">LOG_MSG_DEBUG</a> 0</div><div id="31" class="line none">   31 #define <a href="log_msg.h.html#31">LOG_MSG_DBG</a>(...) IF_ENABLED(<a href="log_msg.h.html#30">LOG_MSG_DEBUG</a>, (printk(__VA_ARGS__)))</div><div id="32" class="line none">   32 </div><div id="33" class="line none">   33 #ifdef CONFIG_LOG_TIMESTAMP_64BIT</div><div id="34" class="line none">   34 typedef uint64_t <a href="log_msg.h.html#34">log_timestamp_t</a>;</div><div id="35" class="line none">   35 #else</div><div id="36" class="line none">   36 typedef uint32_t <a href="log_msg.h.html#34">log_timestamp_t</a>;</div><div id="37" class="line none">   37 #endif</div><div id="38" class="line none">   38 </div><div id="39" class="line none">   39 /**</div><div id="40" class="line none">   40  * @brief Log message API</div><div id="41" class="line none">   41  * @defgroup log_msg Log message API</div><div id="42" class="line none">   42  * @ingroup logger</div><div id="43" class="line none">   43  * @{</div><div id="44" class="line none">   44  */</div><div id="45" class="line none">   45 </div><div id="46" class="line none">   46 #define <a href="log_msg.h.html#46">Z_LOG_MSG_LOG</a> 0</div><div id="47" class="line none">   47 </div><div id="48" class="line none">   48 #define <a href="log_msg.h.html#48">Z_LOG_MSG_PACKAGE_BITS</a> 11</div><div id="49" class="line none">   49 </div><div id="50" class="line none">   50 #define <a href="log_msg.h.html#50">Z_LOG_MSG_MAX_PACKAGE</a> BIT_MASK(<a href="log_msg.h.html#48">Z_LOG_MSG_PACKAGE_BITS</a>)</div><div id="51" class="line none">   51 </div><div id="52" class="line none">   52 #define <a href="log_msg.h.html#52">LOG_MSG_GENERIC_HDR</a> \</div><div id="53" class="line none">   53         MPSC_PBUF_HDR;\</div><div id="54" class="line none">   54         uint32_t <a href="../kernel.h.html#5723">type</a>:1</div><div id="55" class="line none">   55 </div><div id="56" class="line none">   56 struct <a href="log_msg.h.html#56">log_msg_desc</a> {</div><div id="57" class="line none">   57         <a href="log_msg.h.html#52">LOG_MSG_GENERIC_HDR</a>;</div><div id="58" class="line none">   58         uint32_t <a href="log_msg.h.html#58">domain</a>:3;</div><div id="59" class="line none">   59         uint32_t <a href="log_instance.h.html#19">level</a>:3;</div><div id="60" class="line none">   60         uint32_t <a href="log_msg.h.html#60">package_len</a>:<a href="log_msg.h.html#48">Z_LOG_MSG_PACKAGE_BITS</a>;</div><div id="61" class="line none">   61         uint32_t <a href="log_msg.h.html#61">data_len</a>:12;</div><div id="62" class="line none">   62 };</div><div id="63" class="line none">   63 </div><div id="64" class="line none">   64 union <a href="log_msg.h.html#64">log_msg_source</a> {</div><div id="65" class="line none">   65         const struct <a href="log_instance.h.html#17">log_source_const_data</a> *<a href="log_msg.h.html#65">fixed</a>;</div><div id="66" class="line none">   66         struct <a href="log_instance.h.html#30">log_source_dynamic_data</a> *<a href="log_msg.h.html#66">dynamic</a>;</div><div id="67" class="line none">   67         void *<a href="log_msg.h.html#67">raw</a>;</div><div id="68" class="line none">   68 };</div><div id="69" class="line none">   69 </div><div id="70" class="line none">   70 struct <a href="log_msg.h.html#70">log_msg_hdr</a> {</div><div id="71" class="line none">   71         struct <a href="log_msg.h.html#56">log_msg_desc</a> <a href="log_msg.h.html#71">desc</a>;</div><div id="72" class="line none">   72 /* Attempting to keep best alignment. When address is 64 bit and timestamp 32</div><div id="73" class="line none">   73  * swap the order to have 16 byte header instead of 24 byte.</div><div id="74" class="line none">   74  */</div><div id="75" class="line none">   75 #if (INTPTR_MAX &gt; INT32_MAX) &amp;&amp; !defined(CONFIG_LOG_TIMESTAMP_64BIT)</div><div id="76" class="line none">   76         <a href="log_msg.h.html#34">log_timestamp_t</a> <a href="log_msg.h.html#76">timestamp</a>;</div><div id="77" class="line none">   77         const void *<a href="log_msg.h.html#77">source</a>;</div><div id="78" class="line none">   78 #else</div><div id="79" class="line none">   79         const void *<a href="log_msg.h.html#77">source</a>;</div><div id="80" class="line none">   80         <a href="log_msg.h.html#34">log_timestamp_t</a> <a href="log_msg.h.html#76">timestamp</a>;</div><div id="81" class="line none">   81 #endif</div><div id="82" class="line none">   82 #if defined(CONFIG_LOG_THREAD_ID_PREFIX)</div><div id="83" class="line none">   83         void *<a href="log_msg.h.html#83">tid</a>;</div><div id="84" class="line none">   84 #endif</div><div id="85" class="line none">   85 };</div><div id="86" class="line none">   86 /* Messages are aligned to alignment required by cbprintf package. */</div><div id="87" class="line none">   87 #define <a href="log_msg.h.html#87">Z_LOG_MSG_ALIGNMENT</a> CBPRINTF_PACKAGE_ALIGNMENT</div><div id="88" class="line none">   88 </div><div id="89" class="line none">   89 #define <a href="log_msg.h.html#89">Z_LOG_MSG_PADDING</a> \</div><div id="90" class="line none">   90         ((sizeof(struct <a href="log_msg.h.html#70">log_msg_hdr</a>) % <a href="log_msg.h.html#87">Z_LOG_MSG_ALIGNMENT</a>) &gt; 0 ? \</div><div id="91" class="line none">   91         (<a href="log_msg.h.html#87">Z_LOG_MSG_ALIGNMENT</a> - (sizeof(struct <a href="log_msg.h.html#70">log_msg_hdr</a>) % <a href="log_msg.h.html#87">Z_LOG_MSG_ALIGNMENT</a>)) : \</div><div id="92" class="line none">   92                 0)</div><div id="93" class="line none">   93 </div><div id="94" class="line none">   94 struct <a href="log_msg.h.html#94">log_msg</a> {</div><div id="95" class="line none">   95         struct <a href="log_msg.h.html#70">log_msg_hdr</a> <a href="log_msg.h.html#95">hdr</a>;</div><div id="96" class="line none">   96         /* Adding padding to ensure that cbprintf package that follows is</div><div id="97" class="line none">   97          * properly aligned.</div><div id="98" class="line none">   98          */</div><div id="99" class="line none">   99         uint8_t <a href="log_msg.h.html#99">padding</a>[<a href="log_msg.h.html#89">Z_LOG_MSG_PADDING</a>];</div><div id="100" class="line none">  100         uint8_t <a href="log_msg.h.html#100">data</a>[];</div><div id="101" class="line none">  101 };</div><div id="102" class="line none">  102 </div><div id="103" class="line none">  103 /**</div><div id="104" class="line none">  104  * @cond INTERNAL_HIDDEN</div><div id="105" class="line none">  105  */</div><div id="106" class="line none">  106 BUILD_ASSERT(sizeof(struct <a href="log_msg.h.html#94">log_msg</a>) % <a href="log_msg.h.html#87">Z_LOG_MSG_ALIGNMENT</a> == 0,</div><div id="107" class="line none">  107              "Log msg size must aligned");</div><div id="108" class="line none">  108 /**</div><div id="109" class="line none">  109  * @endcond</div><div id="110" class="line none">  110  */</div><div id="111" class="line none">  111 </div><div id="112" class="line none">  112 </div><div id="113" class="line none">  113 struct <a href="log_msg.h.html#113">log_msg_generic_hdr</a> {</div><div id="114" class="line none">  114         <a href="log_msg.h.html#52">LOG_MSG_GENERIC_HDR</a>;</div><div id="115" class="line none">  115 };</div><div id="116" class="line none">  116 </div><div id="117" class="line none">  117 union <a href="log_msg.h.html#117">log_msg_generic</a> {</div><div id="118" class="line none">  118         union mpsc_pbuf_generic <a href="log_msg.h.html#118">buf</a>;</div><div id="119" class="line none">  119         struct <a href="log_msg.h.html#113">log_msg_generic_hdr</a> <a href="log_msg.h.html#119">generic</a>;</div><div id="120" class="line none">  120         struct <a href="log_msg.h.html#94">log_msg</a> <a href="log_msg.h.html#120">log</a>;</div><div id="121" class="line none">  121 };</div><div id="122" class="line none">  122 </div><div id="123" class="line none">  123 /** @brief Method used for creating a log message.</div><div id="124" class="line none">  124  *</div><div id="125" class="line none">  125  * It is used for testing purposes to validate that expected mode was used.</div><div id="126" class="line none">  126  */</div><div id="127" class="line none">  127 enum <a href="log_msg.h.html#127">z_log_msg_mode</a> {</div><div id="128" class="line none">  128         /* Runtime mode is least efficient but supports all cases thus it is</div><div id="129" class="line none">  129          * treated as a fallback method when others cannot be used.</div><div id="130" class="line none">  130          */</div><div id="131" class="line none">  131         <a href="log_msg.h.html#131">Z_LOG_MSG_MODE_RUNTIME</a>,</div><div id="132" class="line none">  132         /* Mode creates statically a string package on stack and calls a</div><div id="133" class="line none">  133          * function for creating a message. It takes code size than</div><div id="134" class="line none">  134          * Z_LOG_MSG_MODE_ZERO_COPY but is a bit slower.</div><div id="135" class="line none">  135          */</div><div id="136" class="line none">  136         <a href="log_msg.h.html#136">Z_LOG_MSG_MODE_FROM_STACK</a>,</div><div id="137" class="line none">  137 </div><div id="138" class="line none">  138         /* Mode calculates size of the message and allocates it and writes</div><div id="139" class="line none">  139          * directly to the message space. It is the fastest method but requires</div><div id="140" class="line none">  140          * more code size.</div><div id="141" class="line none">  141          */</div><div id="142" class="line none">  142         <a href="log_msg.h.html#142">Z_LOG_MSG_MODE_ZERO_COPY</a>,</div><div id="143" class="line none">  143 </div><div id="144" class="line none">  144         /* Mode optimized for simple messages with 0 to 2 32 bit word arguments.*/</div><div id="145" class="line none">  145         <a href="log_msg.h.html#145">Z_LOG_MSG_MODE_SIMPLE</a>,</div><div id="146" class="line none">  146 };</div><div id="147" class="line none">  147 </div><div id="148" class="line none">  148 #define <a href="log_msg.h.html#148">Z_LOG_MSG_DESC_INITIALIZER</a>(_domain_id, _level, _plen, _dlen) \</div><div id="149" class="line none">  149 { \</div><div id="150" class="line none">  150         .valid = 0, \</div><div id="151" class="line none">  151         .busy = 0, \</div><div id="152" class="line none">  152         .<a href="../kernel.h.html#5723">type</a> = <a href="log_msg.h.html#46">Z_LOG_MSG_LOG</a>, \</div><div id="153" class="line none">  153         .<a href="log_msg.h.html#58">domain</a> = (_domain_id), \</div><div id="154" class="line none">  154         .<a href="log_instance.h.html#19">level</a> = (_level), \</div><div id="155" class="line none">  155         .<a href="log_msg.h.html#60">package_len</a> = (_plen), \</div><div id="156" class="line none">  156         .<a href="log_msg.h.html#61">data_len</a> = (_dlen), \</div><div id="157" class="line none">  157 }</div><div id="158" class="line none">  158 </div><div id="159" class="line none">  159 #define <a href="log_msg.h.html#159">Z_LOG_MSG_CBPRINTF_FLAGS</a>(_cstr_cnt) \</div><div id="160" class="line none">  160         (CBPRINTF_PACKAGE_FIRST_RO_STR_CNT(_cstr_cnt) | \</div><div id="161" class="line none">  161         (IS_ENABLED(CONFIG_LOG_MSG_APPEND_RO_STRING_LOC) ? \</div><div id="162" class="line none">  162          CBPRINTF_PACKAGE_ADD_STRING_IDXS : 0))</div><div id="163" class="line none">  163 </div><div id="164" class="line none">  164 #ifdef CONFIG_LOG_USE_VLA</div><div id="165" class="line none">  165 #define <a href="log_msg.h.html#165">Z_LOG_MSG_ON_STACK_ALLOC</a>(ptr, <a href="../net/mqtt.h.html#172">len</a>) \</div><div id="166" class="line none">  166         long long _ll_buf[DIV_ROUND_UP(<a href="../net/mqtt.h.html#172">len</a>, sizeof(long long))]; \</div><div id="167" class="line none">  167         long double _ld_buf[DIV_ROUND_UP(<a href="../net/mqtt.h.html#172">len</a>, sizeof(long double))]; \</div><div id="168" class="line none">  168         (ptr) = (sizeof(long double) == <a href="log_msg.h.html#87">Z_LOG_MSG_ALIGNMENT</a>) ? \</div><div id="169" class="line none">  169                         (struct <a href="log_msg.h.html#94">log_msg</a> *)_ld_buf : (struct <a href="log_msg.h.html#94">log_msg</a> *)_ll_buf; \</div><div id="170" class="line none">  170         if (IS_ENABLED(CONFIG_LOG_TEST_CLEAR_MESSAGE_SPACE)) { \</div><div id="171" class="line none">  171                 /* During test fill with 0's to simplify message comparison */ \</div><div id="172" class="line none">  172                 memset((ptr), 0, (<a href="../net/mqtt.h.html#172">len</a>)); \</div><div id="173" class="line none">  173         }</div><div id="174" class="line none">  174 #else /* Z_LOG_MSG_USE_VLA */</div><div id="175" class="line none">  175 /* When VLA cannot be used we need to trick compiler a bit and create multiple</div><div id="176" class="line none">  176  * fixed size arrays and take the smallest one that will fit the message.</div><div id="177" class="line none">  177  * Compiler will remove unused arrays and stack usage will be kept similar</div><div id="178" class="line none">  178  * to vla case, rounded to the size of the used buffer.</div><div id="179" class="line none">  179  */</div><div id="180" class="line none">  180 #define <a href="log_msg.h.html#165">Z_LOG_MSG_ON_STACK_ALLOC</a>(ptr, <a href="../net/mqtt.h.html#172">len</a>) \</div><div id="181" class="line none">  181         long long _ll_buf32[32 / sizeof(long long)]; \</div><div id="182" class="line none">  182         long long _ll_buf48[48 / sizeof(long long)]; \</div><div id="183" class="line none">  183         long long _ll_buf64[64 / sizeof(long long)]; \</div><div id="184" class="line none">  184         long long _ll_buf128[128 / sizeof(long long)]; \</div><div id="185" class="line none">  185         long long _ll_buf256[256 / sizeof(long long)]; \</div><div id="186" class="line none">  186         long double _ld_buf32[32 / sizeof(long double)]; \</div><div id="187" class="line none">  187         long double _ld_buf48[48 / sizeof(long double)]; \</div><div id="188" class="line none">  188         long double _ld_buf64[64 / sizeof(long double)]; \</div><div id="189" class="line none">  189         long double _ld_buf128[128 / sizeof(long double)]; \</div><div id="190" class="line none">  190         long double _ld_buf256[256 / sizeof(long double)]; \</div><div id="191" class="line none">  191         if (sizeof(long double) == <a href="log_msg.h.html#87">Z_LOG_MSG_ALIGNMENT</a>) { \</div><div id="192" class="line none">  192                 ptr = (<a href="../net/mqtt.h.html#172">len</a> &gt; 128) ? (struct <a href="log_msg.h.html#94">log_msg</a> *)_ld_buf256 : \</div><div id="193" class="line none">  193                         ((<a href="../net/mqtt.h.html#172">len</a> &gt; 64) ? (struct <a href="log_msg.h.html#94">log_msg</a> *)_ld_buf128 : \</div><div id="194" class="line none">  194                         ((<a href="../net/mqtt.h.html#172">len</a> &gt; 48) ? (struct <a href="log_msg.h.html#94">log_msg</a> *)_ld_buf64 : \</div><div id="195" class="line none">  195                         ((<a href="../net/mqtt.h.html#172">len</a> &gt; 32) ? (struct <a href="log_msg.h.html#94">log_msg</a> *)_ld_buf48 : \</div><div id="196" class="line none">  196                                       (struct <a href="log_msg.h.html#94">log_msg</a> *)_ld_buf32)));\</div><div id="197" class="line none">  197         } else { \</div><div id="198" class="line none">  198                 ptr = (<a href="../net/mqtt.h.html#172">len</a> &gt; 128) ? (struct <a href="log_msg.h.html#94">log_msg</a> *)_ll_buf256 : \</div><div id="199" class="line none">  199                         ((<a href="../net/mqtt.h.html#172">len</a> &gt; 64) ? (struct <a href="log_msg.h.html#94">log_msg</a> *)_ll_buf128 : \</div><div id="200" class="line none">  200                         ((<a href="../net/mqtt.h.html#172">len</a> &gt; 48) ? (struct <a href="log_msg.h.html#94">log_msg</a> *)_ll_buf64 : \</div><div id="201" class="line none">  201                         ((<a href="../net/mqtt.h.html#172">len</a> &gt; 32) ? (struct <a href="log_msg.h.html#94">log_msg</a> *)_ll_buf48 : \</div><div id="202" class="line none">  202                                       (struct <a href="log_msg.h.html#94">log_msg</a> *)_ll_buf32)));\</div><div id="203" class="line none">  203         } \</div><div id="204" class="line none">  204         if (IS_ENABLED(CONFIG_LOG_TEST_CLEAR_MESSAGE_SPACE)) { \</div><div id="205" class="line none">  205                 /* During test fill with 0's to simplify message comparison */ \</div><div id="206" class="line none">  206                 memset((ptr), 0, (<a href="../net/mqtt.h.html#172">len</a>)); \</div><div id="207" class="line none">  207         }</div><div id="208" class="line none">  208 #endif /* Z_LOG_MSG_USE_VLA */</div><div id="209" class="line none">  209 </div><div id="210" class="line none">  210 #define <a href="log_msg.h.html#210">Z_LOG_MSG_ALIGN_OFFSET</a> \</div><div id="211" class="line none">  211         offsetof(struct <a href="log_msg.h.html#94">log_msg</a>, <a href="log_msg.h.html#100">data</a>)</div><div id="212" class="line none">  212 </div><div id="213" class="line none">  213 #define <a href="log_msg.h.html#213">Z_LOG_MSG_LEN</a>(pkg_len, <a href="log_msg.h.html#61">data_len</a>) \</div><div id="214" class="line none">  214         (offsetof(struct <a href="log_msg.h.html#94">log_msg</a>, <a href="log_msg.h.html#100">data</a>) + (pkg_len) + (<a href="log_msg.h.html#61">data_len</a>))</div><div id="215" class="line none">  215 </div><div id="216" class="line none">  216 #define <a href="log_msg.h.html#216">Z_LOG_MSG_ALIGNED_WLEN</a>(pkg_len, <a href="log_msg.h.html#61">data_len</a>) \</div><div id="217" class="line none">  217         DIV_ROUND_UP(ROUND_UP(<a href="log_msg.h.html#213">Z_LOG_MSG_LEN</a>(pkg_len, <a href="log_msg.h.html#61">data_len</a>), \</div><div id="218" class="line none">  218                                   <a href="log_msg.h.html#87">Z_LOG_MSG_ALIGNMENT</a>), \</div><div id="219" class="line none">  219                          sizeof(uint32_t))</div><div id="220" class="line none">  220 </div><div id="221" class="line none">  221 /*</div><div id="222" class="line none">  222  * With Zephyr SDK 0.14.2, aarch64-zephyr-elf-gcc (10.3.0) fails to ensure $sp</div><div id="223" class="line none">  223  * is below the active memory during message construction. As a result,</div><div id="224" class="line none">  224  * interrupts happening in the middle of that process can end up smashing active</div><div id="225" class="line none">  225  * data and causing a logging fault. Work around this by inserting a compiler</div><div id="226" class="line none">  226  * barrier after the allocation and before any use to make sure GCC moves the</div><div id="227" class="line none">  227  * stack pointer soon enough</div><div id="228" class="line none">  228  */</div><div id="229" class="line none">  229 </div><div id="230" class="line none">  230 #define <a href="log_msg.h.html#230">Z_LOG_ARM64_VLA_PROTECT</a>() compiler_barrier()</div><div id="231" class="line none">  231 </div><div id="232" class="line none">  232 #define <a href="log_msg.h.html#232">_LOG_MSG_SIMPLE_XXXX0</a> 1</div><div id="233" class="line none">  233 #define <a href="log_msg.h.html#233">_LOG_MSG_SIMPLE_XXXX1</a> 1</div><div id="234" class="line none">  234 #define <a href="log_msg.h.html#234">_LOG_MSG_SIMPLE_XXXX2</a> 1</div><div id="235" class="line none">  235 </div><div id="236" class="line none">  236 /* Determine if amount of arguments (less than 3) qualifies to  simple message. */</div><div id="237" class="line none">  237 #define <a href="log_msg.h.html#237">LOG_MSG_SIMPLE_ARG_CNT_CHECK</a>(...) \</div><div id="238" class="line none">  238         COND_CODE_1(UTIL_CAT(_LOG_MSG_SIMPLE_XXXX, NUM_VA_ARGS_LESS_1(__VA_ARGS__)), (1), (0))</div><div id="239" class="line none">  239 </div><div id="240" class="line none">  240 /* Set of marcos used to determine if arguments type allows simplified message creation mode. */</div><div id="241" class="line none">  241 #define <a href="log_msg.h.html#241">LOG_MSG_SIMPLE_ARG_TYPE_CHECK_0</a>(fmt) 1</div><div id="242" class="line none">  242 #define <a href="log_msg.h.html#242">LOG_MSG_SIMPLE_ARG_TYPE_CHECK_1</a>(fmt, arg) Z_CBPRINTF_IS_WORD_NUM(arg)</div><div id="243" class="line none">  243 #define <a href="log_msg.h.html#243">LOG_MSG_SIMPLE_ARG_TYPE_CHECK_2</a>(fmt, arg0, arg1) \</div><div id="244" class="line none">  244         Z_CBPRINTF_IS_WORD_NUM(arg0) &amp;&amp; Z_CBPRINTF_IS_WORD_NUM(arg1)</div><div id="245" class="line none">  245 </div><div id="246" class="line none">  246 /** brief Determine if string arguments types allow to use simplified message creation mode.</div><div id="247" class="line none">  247  *</div><div id="248" class="line none">  248  * @param ... String with arguments.</div><div id="249" class="line none">  249  */</div><div id="250" class="line none">  250 #define <a href="log_msg.h.html#250">LOG_MSG_SIMPLE_ARG_TYPE_CHECK</a>(...) \</div><div id="251" class="line none">  251         UTIL_CAT(LOG_MSG_SIMPLE_ARG_TYPE_CHECK_, NUM_VA_ARGS_LESS_1(__VA_ARGS__))(__VA_ARGS__)</div><div id="252" class="line none">  252 </div><div id="253" class="line none">  253 /** @brief Check if message can be handled using simplified method.</div><div id="254" class="line none">  254  *</div><div id="255" class="line none">  255  * Following conditions must be met:</div><div id="256" class="line none">  256  * - 32 bit platform</div><div id="257" class="line none">  257  * - Number of arguments from 0 to 2</div><div id="258" class="line none">  258  * - Type of an argument must be a numeric value that fits in 32 bit word.</div><div id="259" class="line none">  259  *</div><div id="260" class="line none">  260  * @param ... String with arguments.</div><div id="261" class="line none">  261  *</div><div id="262" class="line none">  262  * @retval 1 if message qualifies.</div><div id="263" class="line none">  263  * @retval 0 if message does not qualify.</div><div id="264" class="line none">  264  */</div><div id="265" class="line none">  265 #define <a href="log_msg.h.html#265">LOG_MSG_SIMPLE_CHECK</a>(...) \</div><div id="266" class="line none">  266         COND_CODE_1(CONFIG_64BIT, (0), (\</div><div id="267" class="line none">  267                 COND_CODE_1(<a href="log_msg.h.html#237">LOG_MSG_SIMPLE_ARG_CNT_CHECK</a>(__VA_ARGS__), ( \</div><div id="268" class="line none">  268                                 <a href="log_msg.h.html#250">LOG_MSG_SIMPLE_ARG_TYPE_CHECK</a>(__VA_ARGS__)), (0))))</div><div id="269" class="line none">  269 </div><div id="270" class="line none">  270 /* Helper macro for handing log with one argument. Macro casts the first argument to uint32_t. */</div><div id="271" class="line none">  271 #define <a href="log_msg.h.html#271">Z_LOG_MSG_SIMPLE_CREATE_1</a>(_source, _level, ...) \</div><div id="272" class="line none">  272         z_log_msg_simple_create_1(_source, _level, GET_ARG_N(1, __VA_ARGS__), \</div><div id="273" class="line none">  273                         (uint32_t)(uintptr_t)GET_ARG_N(2, __VA_ARGS__))</div><div id="274" class="line none">  274 </div><div id="275" class="line none">  275 /* Helper macro for handing log with two arguments. Macro casts arguments to uint32_t.</div><div id="276" class="line none">  276  */</div><div id="277" class="line none">  277 #define <a href="log_msg.h.html#277">Z_LOG_MSG_SIMPLE_CREATE_2</a>(_source, _level, ...) \</div><div id="278" class="line none">  278         z_log_msg_simple_create_2(_source, _level, GET_ARG_N(1, __VA_ARGS__), \</div><div id="279" class="line none">  279                         (uint32_t)(uintptr_t)GET_ARG_N(2, __VA_ARGS__), \</div><div id="280" class="line none">  280                         (uint32_t)(uintptr_t)GET_ARG_N(3, __VA_ARGS__))</div><div id="281" class="line none">  281 </div><div id="282" class="line none">  282 /* Call specific function based on the number of arguments.</div><div id="283" class="line none">  283  * Since up 2 to arguments are supported COND_CODE_0 and COND_CODE_1 can be used to</div><div id="284" class="line none">  284  * handle all cases (0, 1 and 2 arguments). When tracing is enable then for each</div><div id="285" class="line none">  285  * function a macro is create. The difference between function and macro is that</div><div id="286" class="line none">  286  * macro is applied to any input arguments so we need to make sure that it is</div><div id="287" class="line none">  287  * always called with proper number of arguments. For that it is wrapped around</div><div id="288" class="line none">  288  * into another macro and dummy arguments to cover for cases when there is less</div><div id="289" class="line none">  289  * arguments in a log call.</div><div id="290" class="line none">  290  */</div><div id="291" class="line none">  291 #define <a href="log_msg.h.html#291">Z_LOG_MSG_SIMPLE_FUNC2</a>(arg_cnt, _source, _level, ...) \</div><div id="292" class="line none">  292         COND_CODE_0(arg_cnt, \</div><div id="293" class="line none">  293                         (z_log_msg_simple_create_0(_source, _level, GET_ARG_N(1, __VA_ARGS__))), \</div><div id="294" class="line none">  294                         (COND_CODE_1(arg_cnt, ( \</div><div id="295" class="line none">  295                             <a href="log_msg.h.html#271">Z_LOG_MSG_SIMPLE_CREATE_1</a>(_source, _level, __VA_ARGS__, <a href="../kernel/thread.h.html#246">dummy</a>) \</div><div id="296" class="line none">  296                             ), ( \</div><div id="297" class="line none">  297                             <a href="log_msg.h.html#277">Z_LOG_MSG_SIMPLE_CREATE_2</a>(_source, _level, __VA_ARGS__, <a href="../kernel/thread.h.html#246">dummy</a>, <a href="../kernel/thread.h.html#246">dummy</a>) \</div><div id="298" class="line none">  298                             ) \</div><div id="299" class="line none">  299                         )))</div><div id="300" class="line none">  300 </div><div id="301" class="line none">  301 /** @brief Call specific function to create a log message.</div><div id="302" class="line none">  302  *</div><div id="303" class="line none">  303  * Macro picks matching function (based on number of arguments) and calls it.</div><div id="304" class="line none">  304  * String arguments are casted to uint32_t.</div><div id="305" class="line none">  305  *</div><div id="306" class="line none">  306  * @param _source       Source.</div><div id="307" class="line none">  307  * @param _level        Severity level.</div><div id="308" class="line none">  308  * @param ...           String with arguments.</div><div id="309" class="line none">  309  */</div><div id="310" class="line none">  310 #define <a href="log_msg.h.html#310">LOG_MSG_SIMPLE_FUNC</a>(_source, _level, ...) \</div><div id="311" class="line none">  311         <a href="log_msg.h.html#291">Z_LOG_MSG_SIMPLE_FUNC2</a>(NUM_VA_ARGS_LESS_1(__VA_ARGS__), _source, _level, __VA_ARGS__)</div><div id="312" class="line none">  312 </div><div id="313" class="line none">  313 /** @brief Create log message using simplified method.</div><div id="314" class="line none">  314  *</div><div id="315" class="line none">  315  * Macro is gated by the argument count check to run @ref LOG_MSG_SIMPLE_FUNC only</div><div id="316" class="line none">  316  * on entries with 2 or less arguments.</div><div id="317" class="line none">  317  *</div><div id="318" class="line none">  318  * @param _domain_id    Domain ID.</div><div id="319" class="line none">  319  * @param _source       Pointer to the source structure.</div><div id="320" class="line none">  320  * @param _level        Severity level.</div><div id="321" class="line none">  321  * @param ...           String with arguments.</div><div id="322" class="line none">  322  */</div><div id="323" class="line none">  323 #define <a href="log_msg.h.html#323">Z_LOG_MSG_SIMPLE_ARGS_CREATE</a>(_domain_id, _source, _level, ...) \</div><div id="324" class="line none">  324         IF_ENABLED(<a href="log_msg.h.html#237">LOG_MSG_SIMPLE_ARG_CNT_CHECK</a>(__VA_ARGS__), (\</div><div id="325" class="line none">  325                 <a href="log_msg.h.html#310">LOG_MSG_SIMPLE_FUNC</a>(_source, _level, __VA_ARGS__); \</div><div id="326" class="line none">  326         ))</div><div id="327" class="line none">  327 </div><div id="328" class="line none">  328 #define <a href="log_msg.h.html#328">Z_LOG_MSG_STACK_CREATE</a>(_cstr_cnt, _domain_id, _source, _level, _data, _dlen, ...) \</div><div id="329" class="line none">  329 do { \</div><div id="330" class="line none">  330         int _plen; \</div><div id="331" class="line none">  331         uint32_t _options = <a href="log_msg.h.html#159">Z_LOG_MSG_CBPRINTF_FLAGS</a>(_cstr_cnt) | \</div><div id="332" class="line none">  332                           CBPRINTF_PACKAGE_ADD_RW_STR_POS; \</div><div id="333" class="line none">  333         if (GET_ARG_N(1, __VA_ARGS__) == NULL) { \</div><div id="334" class="line none">  334                 _plen = 0; \</div><div id="335" class="line none">  335         } else { \</div><div id="336" class="line none">  336                 CBPRINTF_STATIC_PACKAGE(NULL, 0, _plen, <a href="log_msg.h.html#210">Z_LOG_MSG_ALIGN_OFFSET</a>, _options, \</div><div id="337" class="line none">  337                                         __VA_ARGS__); \</div><div id="338" class="line none">  338         } \</div><div id="339" class="line none">  339         TOOLCHAIN_IGNORE_WSHADOW_BEGIN \</div><div id="340" class="line none">  340         struct <a href="log_msg.h.html#94">log_msg</a> *_msg; \</div><div id="341" class="line none">  341         TOOLCHAIN_IGNORE_WSHADOW_END \</div><div id="342" class="line none">  342         <a href="log_msg.h.html#165">Z_LOG_MSG_ON_STACK_ALLOC</a>(_msg, <a href="log_msg.h.html#213">Z_LOG_MSG_LEN</a>(_plen, 0)); \</div><div id="343" class="line none">  343         <a href="log_msg.h.html#230">Z_LOG_ARM64_VLA_PROTECT</a>(); \</div><div id="344" class="line none">  344         if (_plen != 0) { \</div><div id="345" class="line none">  345                 CBPRINTF_STATIC_PACKAGE(_msg-&gt;<a href="log_msg.h.html#100">data</a>, _plen, \</div><div id="346" class="line none">  346                                         _plen, <a href="log_msg.h.html#210">Z_LOG_MSG_ALIGN_OFFSET</a>, _options, \</div><div id="347" class="line none">  347                                         __VA_ARGS__);\</div><div id="348" class="line none">  348         } \</div><div id="349" class="line none">  349         struct <a href="log_msg.h.html#56">log_msg_desc</a> _desc = \</div><div id="350" class="line none">  350                 <a href="log_msg.h.html#148">Z_LOG_MSG_DESC_INITIALIZER</a>(_domain_id, _level, \</div><div id="351" class="line none">  351                                            (uint32_t)_plen, _dlen); \</div><div id="352" class="line none">  352         <a href="log_msg.h.html#31">LOG_MSG_DBG</a>("creating message on stack: package len: %d, data len: %d\n", \</div><div id="353" class="line none">  353                         _plen, (int)(_dlen)); \</div><div id="354" class="line none">  354         z_log_msg_static_create((void *)(_source), _desc, _msg-&gt;<a href="log_msg.h.html#100">data</a>, (_data)); \</div><div id="355" class="line none">  355 } while (false)</div><div id="356" class="line none">  356 </div><div id="357" class="line none">  357 #ifdef CONFIG_LOG_SPEED</div><div id="358" class="line none">  358 #define <a href="log_msg.h.html#358">Z_LOG_MSG_SIMPLE_CREATE</a>(_cstr_cnt, _domain_id, _source, _level, ...) do { \</div><div id="359" class="line none">  359         int _plen; \</div><div id="360" class="line none">  360         CBPRINTF_STATIC_PACKAGE(NULL, 0, _plen, <a href="log_msg.h.html#210">Z_LOG_MSG_ALIGN_OFFSET</a>, \</div><div id="361" class="line none">  361                                 <a href="log_msg.h.html#159">Z_LOG_MSG_CBPRINTF_FLAGS</a>(_cstr_cnt), \</div><div id="362" class="line none">  362                                 __VA_ARGS__); \</div><div id="363" class="line none">  363         size_t _msg_wlen = <a href="log_msg.h.html#216">Z_LOG_MSG_ALIGNED_WLEN</a>(_plen, 0); \</div><div id="364" class="line none">  364         struct <a href="log_msg.h.html#94">log_msg</a> *_msg = z_log_msg_alloc(_msg_wlen); \</div><div id="365" class="line none">  365         struct <a href="log_msg.h.html#56">log_msg_desc</a> _desc = \</div><div id="366" class="line none">  366                 <a href="log_msg.h.html#148">Z_LOG_MSG_DESC_INITIALIZER</a>(_domain_id, _level, (uint32_t)_plen, 0); \</div><div id="367" class="line none">  367         <a href="log_msg.h.html#31">LOG_MSG_DBG</a>("creating message zero copy: package len: %d, msg: %p\n", \</div><div id="368" class="line none">  368                         _plen, _msg); \</div><div id="369" class="line none">  369         if (_msg) { \</div><div id="370" class="line none">  370                 CBPRINTF_STATIC_PACKAGE(_msg-&gt;<a href="log_msg.h.html#100">data</a>, _plen, _plen, \</div><div id="371" class="line none">  371                                         <a href="log_msg.h.html#210">Z_LOG_MSG_ALIGN_OFFSET</a>, \</div><div id="372" class="line none">  372                                         <a href="log_msg.h.html#159">Z_LOG_MSG_CBPRINTF_FLAGS</a>(_cstr_cnt), \</div><div id="373" class="line none">  373                                         __VA_ARGS__); \</div><div id="374" class="line none">  374         } \</div><div id="375" class="line none">  375         z_log_msg_finalize(_msg, (void *)_source, _desc, NULL); \</div><div id="376" class="line none">  376 } while (false)</div><div id="377" class="line none">  377 #else</div><div id="378" class="line none">  378 /* Alternative empty macro created to speed up compilation when LOG_SPEED is</div><div id="379" class="line none">  379  * disabled (default).</div><div id="380" class="line none">  380  */</div><div id="381" class="line none">  381 #define <a href="log_msg.h.html#358">Z_LOG_MSG_SIMPLE_CREATE</a>(...)</div><div id="382" class="line none">  382 #endif</div><div id="383" class="line none">  383 </div><div id="384" class="line none">  384 /* Macro handles case when local variable with log message string is created. It</div><div id="385" class="line none">  385  * replaces original string literal with that variable.</div><div id="386" class="line none">  386  */</div><div id="387" class="line none">  387 #define <a href="log_msg.h.html#387">Z_LOG_FMT_ARGS_2</a>(_name, ...) \</div><div id="388" class="line none">  388         COND_CODE_1(CONFIG_LOG_FMT_SECTION, \</div><div id="389" class="line none">  389                 (COND_CODE_0(NUM_VA_ARGS_LESS_1(__VA_ARGS__), \</div><div id="390" class="line none">  390                    (_name), (_name, GET_ARGS_LESS_N(1, __VA_ARGS__)))), \</div><div id="391" class="line none">  391                 (__VA_ARGS__))</div><div id="392" class="line none">  392 </div><div id="393" class="line none">  393 /** @brief Wrapper for log message string with arguments.</div><div id="394" class="line none">  394  *</div><div id="395" class="line none">  395  * Wrapper is replacing first argument with a variable from a dedicated memory</div><div id="396" class="line none">  396  * section if option is enabled. Macro handles the case when there is no</div><div id="397" class="line none">  397  * log message provided.</div><div id="398" class="line none">  398  *</div><div id="399" class="line none">  399  * @param _name Name of the variable with log message string. It is optionally used.</div><div id="400" class="line none">  400  * @param ... Optional log message with arguments (may be empty).</div><div id="401" class="line none">  401  */</div><div id="402" class="line none">  402 #define <a href="log_msg.h.html#402">Z_LOG_FMT_ARGS</a>(_name, ...) \</div><div id="403" class="line none">  403         COND_CODE_0(NUM_VA_ARGS_LESS_1(_, ##__VA_ARGS__), \</div><div id="404" class="line none">  404                 (NULL), \</div><div id="405" class="line none">  405                 (<a href="log_msg.h.html#387">Z_LOG_FMT_ARGS_2</a>(_name, ##__VA_ARGS__)))</div><div id="406" class="line none">  406 </div><div id="407" class="line none">  407 #if defined(CONFIG_LOG_USE_TAGGED_ARGUMENTS)</div><div id="408" class="line none">  408 </div><div id="409" class="line none">  409 #define <a href="log_msg.h.html#409">Z_LOG_FMT_TAGGED_ARGS_2</a>(_name, ...) \</div><div id="410" class="line none">  410         COND_CODE_1(CONFIG_LOG_FMT_SECTION, \</div><div id="411" class="line none">  411                     (_name, Z_CBPRINTF_TAGGED_ARGS(NUM_VA_ARGS_LESS_1(__VA_ARGS__), \</div><div id="412" class="line none">  412                                                    GET_ARGS_LESS_N(1, __VA_ARGS__))), \</div><div id="413" class="line none">  413                     (GET_ARG_N(1, __VA_ARGS__), \</div><div id="414" class="line none">  414                      Z_CBPRINTF_TAGGED_ARGS(NUM_VA_ARGS_LESS_1(__VA_ARGS__), \</div><div id="415" class="line none">  415                                             GET_ARGS_LESS_N(1, __VA_ARGS__))))</div><div id="416" class="line none">  416 </div><div id="417" class="line none">  417 /** @brief Wrapper for log message string with tagged arguments.</div><div id="418" class="line none">  418  *</div><div id="419" class="line none">  419  * Wrapper is replacing first argument with a variable from a dedicated memory</div><div id="420" class="line none">  420  * section if option is enabled. Macro handles the case when there is no</div><div id="421" class="line none">  421  * log message provided. Each subsequent arguments are tagged by preceding</div><div id="422" class="line none">  422  * each argument with its type value.</div><div id="423" class="line none">  423  *</div><div id="424" class="line none">  424  * @param _name Name of the variable with log message string. It is optionally used.</div><div id="425" class="line none">  425  * @param ... Optional log message with arguments (may be empty).</div><div id="426" class="line none">  426  */</div><div id="427" class="line none">  427 #define <a href="log_msg.h.html#427">Z_LOG_FMT_TAGGED_ARGS</a>(_name, ...) \</div><div id="428" class="line none">  428         COND_CODE_0(NUM_VA_ARGS_LESS_1(_, ##__VA_ARGS__), \</div><div id="429" class="line none">  429                 (Z_CBPRINTF_TAGGED_ARGS(0)), \</div><div id="430" class="line none">  430                 (<a href="log_msg.h.html#409">Z_LOG_FMT_TAGGED_ARGS_2</a>(_name, ##__VA_ARGS__)))</div><div id="431" class="line none">  431 </div><div id="432" class="line none">  432 #define <a href="log_msg.h.html#432">Z_LOG_FMT_RUNTIME_ARGS</a>(...) \</div><div id="433" class="line none">  433         <a href="log_msg.h.html#427">Z_LOG_FMT_TAGGED_ARGS</a>(__VA_ARGS__)</div><div id="434" class="line none">  434 </div><div id="435" class="line none">  435 #else</div><div id="436" class="line none">  436 </div><div id="437" class="line none">  437 #define <a href="log_msg.h.html#432">Z_LOG_FMT_RUNTIME_ARGS</a>(...) \</div><div id="438" class="line none">  438         <a href="log_msg.h.html#402">Z_LOG_FMT_ARGS</a>(__VA_ARGS__)</div><div id="439" class="line none">  439 </div><div id="440" class="line none">  440 #endif /* CONFIG_LOG_USE_TAGGED_ARGUMENTS */</div><div id="441" class="line none">  441 </div><div id="442" class="line none">  442 /* Macro handles case when there is no string provided, in that case variable</div><div id="443" class="line none">  443  * is not created.</div><div id="444" class="line none">  444  */</div><div id="445" class="line none">  445 #define <a href="log_msg.h.html#445">Z_LOG_MSG_STR_VAR_IN_SECTION</a>(_name, ...) \</div><div id="446" class="line none">  446         COND_CODE_0(NUM_VA_ARGS_LESS_1(_, ##__VA_ARGS__), \</div><div id="447" class="line none">  447                     (/* No args provided, no variable */), \</div><div id="448" class="line none">  448                     (static const char _name[] \</div><div id="449" class="line none">  449                      __in_section(_log_strings, static, _CONCAT(_name, _)) __used __noasan = \</div><div id="450" class="line none">  450                         GET_ARG_N(1, __VA_ARGS__);))</div><div id="451" class="line none">  451 </div><div id="452" class="line none">  452 /** @brief Create variable in the dedicated memory section (if enabled).</div><div id="453" class="line none">  453  *</div><div id="454" class="line none">  454  * Variable is initialized with a format string from the log message.</div><div id="455" class="line none">  455  *</div><div id="456" class="line none">  456  * @param _name Variable name.</div><div id="457" class="line none">  457  * @param ... Optional log message with arguments (may be empty).</div><div id="458" class="line none">  458  */</div><div id="459" class="line none">  459 #define <a href="log_msg.h.html#459">Z_LOG_MSG_STR_VAR</a>(_name, ...) \</div><div id="460" class="line none">  460         IF_ENABLED(CONFIG_LOG_FMT_SECTION, \</div><div id="461" class="line none">  461                    (<a href="log_msg.h.html#445">Z_LOG_MSG_STR_VAR_IN_SECTION</a>(_name, ##__VA_ARGS__)))</div><div id="462" class="line none">  462 </div><div id="463" class="line none">  463 /** @brief Create log message and write it into the logger buffer.</div><div id="464" class="line none">  464  *</div><div id="465" class="line none">  465  * Macro handles creation of log message which includes storing log message</div><div id="466" class="line none">  466  * description, timestamp, arguments, copying string arguments into message and</div><div id="467" class="line none">  467  * copying user data into the message space. There are 3 modes of message</div><div id="468" class="line none">  468  * creation:</div><div id="469" class="line none">  469  * - at compile time message size is determined, message is allocated and</div><div id="470" class="line none">  470  *   content is written directly to the message. It is the fastest but cannot</div><div id="471" class="line none">  471  *   be used in user mode. Message size cannot be determined at compile time if</div><div id="472" class="line none">  472  *   it contains data or string arguments which are string pointers.</div><div id="473" class="line none">  473  * - at compile time message size is determined, string package is created on</div><div id="474" class="line none">  474  *   stack, message is created in function call. String package can only be</div><div id="475" class="line none">  475  *   created on stack if it does not contain unexpected pointers to strings.</div><div id="476" class="line none">  476  * - string package is created at runtime. This mode has no limitations but</div><div id="477" class="line none">  477  *   it is significantly slower.</div><div id="478" class="line none">  478  *</div><div id="479" class="line none">  479  * @param _try_0cpy If positive then, if possible, message content is written</div><div id="480" class="line none">  480  * directly to message. If 0 then, if possible, string package is created on</div><div id="481" class="line none">  481  * the stack and message is created in the function call.</div><div id="482" class="line none">  482  *</div><div id="483" class="line none">  483  * @param _mode Used for testing. It is set according to message creation mode</div><div id="484" class="line none">  484  *              used.</div><div id="485" class="line none">  485  *</div><div id="486" class="line none">  486  * @param _cstr_cnt Number of constant strings present in the string. It is</div><div id="487" class="line none">  487  * used to help detect messages which must be runtime processed, compared to</div><div id="488" class="line none">  488  * message which can be prebuilt at compile time.</div><div id="489" class="line none">  489  *</div><div id="490" class="line none">  490  * @param _domain_id Domain ID.</div><div id="491" class="line none">  491  *</div><div id="492" class="line none">  492  * @param _source Pointer to the constant descriptor of the log message source.</div><div id="493" class="line none">  493  *</div><div id="494" class="line none">  494  * @param _level Log message level.</div><div id="495" class="line none">  495  *</div><div id="496" class="line none">  496  * @param _data Pointer to the data. Can be null.</div><div id="497" class="line none">  497  *</div><div id="498" class="line none">  498  * @param _dlen Number of data bytes. 0 if data is not provided.</div><div id="499" class="line none">  499  *</div><div id="500" class="line none">  500  * @param ...  Optional string with arguments (fmt, ...). It may be empty.</div><div id="501" class="line none">  501  */</div><div id="502" class="line none">  502 #if defined(CONFIG_LOG_ALWAYS_RUNTIME) || !defined(CONFIG_LOG)</div><div id="503" class="line none">  503 #define <a href="log_msg.h.html#503">Z_LOG_MSG_CREATE2</a>(_try_0cpy, _mode,  _cstr_cnt, _domain_id, _source,\</div><div id="504" class="line none">  504                           _level, _data, _dlen, ...) \</div><div id="505" class="line none">  505 do {\</div><div id="506" class="line none">  506         <a href="log_msg.h.html#459">Z_LOG_MSG_STR_VAR</a>(_fmt, ##__VA_ARGS__) \</div><div id="507" class="line none">  507         <a href="log_msg.h.html#705">z_log_msg_runtime_create</a>((_domain_id), (void *)(_source), \</div><div id="508" class="line none">  508                                   (_level), (uint8_t *)(_data), (_dlen),\</div><div id="509" class="line none">  509                                   <a href="log_msg.h.html#159">Z_LOG_MSG_CBPRINTF_FLAGS</a>(_cstr_cnt) | \</div><div id="510" class="line none">  510                                   (IS_ENABLED(CONFIG_LOG_USE_TAGGED_ARGUMENTS) ? \</div><div id="511" class="line none">  511                                    CBPRINTF_PACKAGE_ARGS_ARE_TAGGED : 0), \</div><div id="512" class="line none">  512                                   <a href="log_msg.h.html#432">Z_LOG_FMT_RUNTIME_ARGS</a>(_fmt, ##__VA_ARGS__));\</div><div id="513" class="line none">  513         (_mode) = <a href="log_msg.h.html#131">Z_LOG_MSG_MODE_RUNTIME</a>; \</div><div id="514" class="line none">  514 } while (false)</div><div id="515" class="line none">  515 #else /* CONFIG_LOG_ALWAYS_RUNTIME || !CONFIG_LOG */</div><div id="516" class="line none">  516 #define <a href="log_msg.h.html#516">Z_LOG_MSG_CREATE3</a>(_try_0cpy, _mode,  _cstr_cnt, _domain_id, _source,\</div><div id="517" class="line none">  517                           _level, _data, _dlen, ...) \</div><div id="518" class="line none">  518 do { \</div><div id="519" class="line none">  519         <a href="log_msg.h.html#459">Z_LOG_MSG_STR_VAR</a>(_fmt, ##__VA_ARGS__); \</div><div id="520" class="line none">  520         bool has_rw_str = CBPRINTF_MUST_RUNTIME_PACKAGE( \</div><div id="521" class="line none">  521                                         <a href="log_msg.h.html#159">Z_LOG_MSG_CBPRINTF_FLAGS</a>(_cstr_cnt), \</div><div id="522" class="line none">  522                                         __VA_ARGS__); \</div><div id="523" class="line none">  523         if (IS_ENABLED(CONFIG_LOG_SPEED) &amp;&amp; (_try_0cpy) &amp;&amp; ((_dlen) == 0) &amp;&amp; !has_rw_str) {\</div><div id="524" class="line none">  524                 <a href="log_msg.h.html#31">LOG_MSG_DBG</a>("create zero-copy message\n");\</div><div id="525" class="line none">  525                 <a href="log_msg.h.html#358">Z_LOG_MSG_SIMPLE_CREATE</a>(_cstr_cnt, _domain_id, _source, \</div><div id="526" class="line none">  526                                         _level, <a href="log_msg.h.html#402">Z_LOG_FMT_ARGS</a>(_fmt, ##__VA_ARGS__)); \</div><div id="527" class="line none">  527                 (_mode) = <a href="log_msg.h.html#142">Z_LOG_MSG_MODE_ZERO_COPY</a>; \</div><div id="528" class="line none">  528         } else { \</div><div id="529" class="line none">  529                 IF_ENABLED(UTIL_AND(IS_ENABLED(CONFIG_LOG_SIMPLE_MSG_OPTIMIZE), \</div><div id="530" class="line none">  530                                     UTIL_AND(UTIL_NOT(_domain_id), UTIL_NOT(_cstr_cnt))), \</div><div id="531" class="line none">  531                         ( \</div><div id="532" class="line none">  532                         bool can_simple = <a href="log_msg.h.html#265">LOG_MSG_SIMPLE_CHECK</a>(__VA_ARGS__); \</div><div id="533" class="line none">  533                         if (can_simple &amp;&amp; ((_dlen) == 0) &amp;&amp; !<a href="../syscall.h.html#115">k_is_user_context</a>()) { \</div><div id="534" class="line none">  534                                 <a href="log_msg.h.html#31">LOG_MSG_DBG</a>("create fast message\n");\</div><div id="535" class="line none">  535                                 <a href="log_msg.h.html#323">Z_LOG_MSG_SIMPLE_ARGS_CREATE</a>(_domain_id, _source, _level, \</div><div id="536" class="line none">  536                                                      <a href="log_msg.h.html#402">Z_LOG_FMT_ARGS</a>(_fmt, ##__VA_ARGS__)); \</div><div id="537" class="line none">  537                                 _mode = <a href="log_msg.h.html#145">Z_LOG_MSG_MODE_SIMPLE</a>; \</div><div id="538" class="line none">  538                                 break; \</div><div id="539" class="line none">  539                         } \</div><div id="540" class="line none">  540                         ) \</div><div id="541" class="line none">  541                 ) \</div><div id="542" class="line none">  542                 <a href="log_msg.h.html#31">LOG_MSG_DBG</a>("create on stack message\n");\</div><div id="543" class="line none">  543                 <a href="log_msg.h.html#328">Z_LOG_MSG_STACK_CREATE</a>(_cstr_cnt, _domain_id, _source, _level, _data, \</div><div id="544" class="line none">  544                                         _dlen, <a href="log_msg.h.html#402">Z_LOG_FMT_ARGS</a>(_fmt, ##__VA_ARGS__)); \</div><div id="545" class="line none">  545                 (_mode) = <a href="log_msg.h.html#136">Z_LOG_MSG_MODE_FROM_STACK</a>; \</div><div id="546" class="line none">  546         } \</div><div id="547" class="line none">  547         (void)(_mode); \</div><div id="548" class="line none">  548 } while (false)</div><div id="549" class="line none">  549 </div><div id="550" class="line none">  550 #if defined(__cplusplus)</div><div id="551" class="line none">  551 #define <a href="log_msg.h.html#551">Z_AUTO_TYPE</a> auto</div><div id="552" class="line none">  552 #else</div><div id="553" class="line none">  553 #define <a href="log_msg.h.html#551">Z_AUTO_TYPE</a> __auto_type</div><div id="554" class="line none">  554 #endif</div><div id="555" class="line none">  555 </div><div id="556" class="line none">  556 /* Macro for getting name of a local variable with the exception of the first argument</div><div id="557" class="line none">  557  * which is a formatted string in log message.</div><div id="558" class="line none">  558  */</div><div id="559" class="line none">  559 #define <a href="log_msg.h.html#559">Z_LOG_LOCAL_ARG_NAME</a>(idx, arg) COND_CODE_0(idx, (arg), (_v##idx))</div><div id="560" class="line none">  560 </div><div id="561" class="line none">  561 /* Create local variable from input variable (expect for the first (fmt) argument). */</div><div id="562" class="line none">  562 #define <a href="log_msg.h.html#562">Z_LOG_LOCAL_ARG_CREATE</a>(idx, arg) \</div><div id="563" class="line none">  563         COND_CODE_0(idx, (), (<a href="log_msg.h.html#551">Z_AUTO_TYPE</a> <a href="log_msg.h.html#559">Z_LOG_LOCAL_ARG_NAME</a>(idx, arg) = (arg) + 0))</div><div id="564" class="line none">  564 </div><div id="565" class="line none">  565 /* First level of processing creates stack variables to be passed for further processing.</div><div id="566" class="line none">  566  * This is done to prevent multiple evaluations of input arguments (in case argument</div><div id="567" class="line none">  567  * evaluation has side effects, e.g. it is a non-pure function call).</div><div id="568" class="line none">  568  */</div><div id="569" class="line none">  569 #define <a href="log_msg.h.html#503">Z_LOG_MSG_CREATE2</a>(_try_0cpy, _mode, _cstr_cnt,  _domain_id, _source, \</div><div id="570" class="line none">  570                            _level, _data, _dlen, ...) \</div><div id="571" class="line none">  571 do { \</div><div id="572" class="line none">  572         _Pragma("GCC diagnostic push") \</div><div id="573" class="line none">  573         _Pragma("GCC diagnostic ignored \"-Wpointer-arith\"") \</div><div id="574" class="line none">  574         FOR_EACH_IDX(<a href="log_msg.h.html#562">Z_LOG_LOCAL_ARG_CREATE</a>, (;), __VA_ARGS__); \</div><div id="575" class="line none">  575         _Pragma("GCC diagnostic pop") \</div><div id="576" class="line none">  576         <a href="log_msg.h.html#516">Z_LOG_MSG_CREATE3</a>(_try_0cpy, _mode,  _cstr_cnt, _domain_id, _source,\</div><div id="577" class="line none">  577                            _level, _data, _dlen, \</div><div id="578" class="line none">  578                            FOR_EACH_IDX(<a href="log_msg.h.html#559">Z_LOG_LOCAL_ARG_NAME</a>, (,), __VA_ARGS__)); \</div><div id="579" class="line none">  579 } while (false)</div><div id="580" class="line none">  580 #endif /* CONFIG_LOG_ALWAYS_RUNTIME || !CONFIG_LOG */</div><div id="581" class="line none">  581 </div><div id="582" class="line none">  582 </div><div id="583" class="line none">  583 #define <a href="log_msg.h.html#583">Z_LOG_MSG_CREATE</a>(_try_0cpy, _mode,  _domain_id, _source,\</div><div id="584" class="line none">  584                           _level, _data, _dlen, ...) \</div><div id="585" class="line none">  585         <a href="log_msg.h.html#503">Z_LOG_MSG_CREATE2</a>(_try_0cpy, _mode, UTIL_CAT(Z_LOG_FUNC_PREFIX_, _level), \</div><div id="586" class="line none">  586                            _domain_id, _source, _level, _data, _dlen, \</div><div id="587" class="line none">  587                            <a href="log_core.h.html#139">Z_LOG_STR</a>(_level, __VA_ARGS__))</div><div id="588" class="line none">  588 </div><div id="589" class="line none">  589 /** @brief Allocate log message.</div><div id="590" class="line none">  590  *</div><div id="591" class="line none">  591  * @param wlen Length in 32 bit words.</div><div id="592" class="line none">  592  *</div><div id="593" class="line none">  593  * @return allocated space or null if cannot be allocated.</div><div id="594" class="line none">  594  */</div><div id="595" class="line none">  595 struct <a href="log_msg.h.html#94">log_msg</a> *z_log_msg_alloc(uint32_t wlen);</div><div id="596" class="line none">  596 </div><div id="597" class="line none">  597 /** @brief Finalize message.</div><div id="598" class="line none">  598  *</div><div id="599" class="line none">  599  * Finalization includes setting source, copying data and timestamp in the</div><div id="600" class="line none">  600  * message followed by committing the message.</div><div id="601" class="line none">  601  *</div><div id="602" class="line none">  602  * @param msg Message.</div><div id="603" class="line none">  603  *</div><div id="604" class="line none">  604  * @param source Address of the source descriptor.</div><div id="605" class="line none">  605  *</div><div id="606" class="line none">  606  * @param desc Message descriptor.</div><div id="607" class="line none">  607  *</div><div id="608" class="line none">  608  * @param data Data.</div><div id="609" class="line none">  609  */</div><div id="610" class="line none">  610 void z_log_msg_finalize(struct <a href="log_msg.h.html#94">log_msg</a> *msg, const void *<a href="log_msg.h.html#77">source</a>,</div><div id="611" class="line none">  611                          const struct <a href="log_msg.h.html#56">log_msg_desc</a> <a href="log_msg.h.html#71">desc</a>, const void *<a href="log_msg.h.html#100">data</a>);</div><div id="612" class="line none">  612 </div><div id="613" class="line none">  613 /** @brief Create log message using simplified method for string with no arguments.</div><div id="614" class="line none">  614  *</div><div id="615" class="line none">  615  * @param source Pointer to the source structure.</div><div id="616" class="line none">  616  * @param level  Severity level.</div><div id="617" class="line none">  617  * @param fmt    String pointer.</div><div id="618" class="line none">  618  */</div><div id="619" class="line none">  619 __syscall void z_log_msg_simple_create_0(const void *<a href="log_msg.h.html#77">source</a>, uint32_t <a href="log_instance.h.html#19">level</a>,</div><div id="620" class="line none">  620                                          const char *fmt);</div><div id="621" class="line none">  621 </div><div id="622" class="line none">  622 /** @brief Create log message using simplified method for string with a one argument.</div><div id="623" class="line none">  623  *</div><div id="624" class="line none">  624  * @param source Pointer to the source structure.</div><div id="625" class="line none">  625  * @param level  Severity level.</div><div id="626" class="line none">  626  * @param fmt    String pointer.</div><div id="627" class="line none">  627  * @param arg    String argument.</div><div id="628" class="line none">  628  */</div><div id="629" class="line none">  629 __syscall void z_log_msg_simple_create_1(const void *<a href="log_msg.h.html#77">source</a>, uint32_t <a href="log_instance.h.html#19">level</a>,</div><div id="630" class="line none">  630                                          const char *fmt, uint32_t arg);</div><div id="631" class="line none">  631 </div><div id="632" class="line none">  632 /** @brief Create log message using simplified method for string with two arguments.</div><div id="633" class="line none">  633  *</div><div id="634" class="line none">  634  * @param source Pointer to the source structure.</div><div id="635" class="line none">  635  * @param level  Severity level.</div><div id="636" class="line none">  636  * @param fmt    String pointer.</div><div id="637" class="line none">  637  * @param arg0   String argument.</div><div id="638" class="line none">  638  * @param arg1   String argument.</div><div id="639" class="line none">  639  */</div><div id="640" class="line none">  640 __syscall void z_log_msg_simple_create_2(const void *<a href="log_msg.h.html#77">source</a>, uint32_t <a href="log_instance.h.html#19">level</a>,</div><div id="641" class="line none">  641                                          const char *fmt, uint32_t arg0, uint32_t arg1);</div><div id="642" class="line none">  642 </div><div id="643" class="line none">  643 /** @brief Create a logging message from message details and string package.</div><div id="644" class="line none">  644  *</div><div id="645" class="line none">  645  * @param source Source.</div><div id="646" class="line none">  646  *</div><div id="647" class="line none">  647  * @param desc Message descriptor.</div><div id="648" class="line none">  648  *</div><div id="649" class="line none">  649  * @param package Package.</div><div id="650" class="line none">  650  *</div><div id="651" class="line none">  651  * @param data Data.</div><div id="652" class="line none">  652  */</div><div id="653" class="line none">  653 __syscall void z_log_msg_static_create(const void *<a href="log_msg.h.html#77">source</a>,</div><div id="654" class="line none">  654                                         const struct <a href="log_msg.h.html#56">log_msg_desc</a> <a href="log_msg.h.html#71">desc</a>,</div><div id="655" class="line none">  655                                         uint8_t *package, const void *<a href="log_msg.h.html#100">data</a>);</div><div id="656" class="line none">  656 </div><div id="657" class="line none">  657 /** @brief Create message at runtime.</div><div id="658" class="line none">  658  *</div><div id="659" class="line none">  659  * Function allows to build any log message based on input data. Processing</div><div id="660" class="line none">  660  * time is significantly higher than statically message creating.</div><div id="661" class="line none">  661  *</div><div id="662" class="line none">  662  * @param domain_id Domain ID.</div><div id="663" class="line none">  663  *</div><div id="664" class="line none">  664  * @param source Source.</div><div id="665" class="line none">  665  *</div><div id="666" class="line none">  666  * @param level Log level.</div><div id="667" class="line none">  667  *</div><div id="668" class="line none">  668  * @param data Data.</div><div id="669" class="line none">  669  *</div><div id="670" class="line none">  670  * @param dlen Data length.</div><div id="671" class="line none">  671  *</div><div id="672" class="line none">  672  * @param package_flags Package flags.</div><div id="673" class="line none">  673  *</div><div id="674" class="line none">  674  * @param fmt String.</div><div id="675" class="line none">  675  *</div><div id="676" class="line none">  676  * @param ap Variable list of string arguments.</div><div id="677" class="line none">  677  */</div><div id="678" class="line none">  678 void <a href="log_msg.h.html#678">z_log_msg_runtime_vcreate</a>(uint8_t domain_id, const void *<a href="log_msg.h.html#77">source</a>,</div><div id="679" class="line none">  679                                 uint8_t <a href="log_instance.h.html#19">level</a>, const void *<a href="log_msg.h.html#100">data</a>,</div><div id="680" class="line none">  680                                 size_t dlen, uint32_t package_flags,</div><div id="681" class="line none">  681                                 const char *fmt,</div><div id="682" class="line none">  682                                 va_list ap);</div><div id="683" class="line none">  683 </div><div id="684" class="line none">  684 /** @brief Create message at runtime.</div><div id="685" class="line none">  685  *</div><div id="686" class="line none">  686  * Function allows to build any log message based on input data. Processing</div><div id="687" class="line none">  687  * time is significantly higher than statically message creating.</div><div id="688" class="line none">  688  *</div><div id="689" class="line none">  689  * @param domain_id Domain ID.</div><div id="690" class="line none">  690  *</div><div id="691" class="line none">  691  * @param source Source.</div><div id="692" class="line none">  692  *</div><div id="693" class="line none">  693  * @param level Log level.</div><div id="694" class="line none">  694  *</div><div id="695" class="line none">  695  * @param data Data.</div><div id="696" class="line none">  696  *</div><div id="697" class="line none">  697  * @param dlen Data length.</div><div id="698" class="line none">  698  *</div><div id="699" class="line none">  699  * @param package_flags Package flags.</div><div id="700" class="line none">  700  *</div><div id="701" class="line none">  701  * @param fmt String.</div><div id="702" class="line none">  702  *</div><div id="703" class="line none">  703  * @param ... String arguments.</div><div id="704" class="line none">  704  */</div><div id="705" class="line none">  705 static inline void <a href="log_msg.h.html#705">z_log_msg_runtime_create</a>(uint8_t domain_id,</div><div id="706" class="line none">  706                                              const void *<a href="log_msg.h.html#77">source</a>,</div><div id="707" class="line none">  707                                              uint8_t <a href="log_instance.h.html#19">level</a>, const void *<a href="log_msg.h.html#100">data</a>,</div><div id="708" class="line none">  708                                              size_t dlen, uint32_t package_flags,</div><div id="709" class="line none">  709                                              const char *fmt, ...)</div><div id="710" class="line none">  710 {</div><div id="711" class="line missed">  711         va_list ap;</div><div id="712" class="line none">  712 </div><div id="713" class="line missed">  713         va_start(ap, fmt);</div><div id="714" class="line missed">  714         <a href="log_msg.h.html#678">z_log_msg_runtime_vcreate</a>(domain_id, <a href="log_msg.h.html#77">source</a>, <a href="log_instance.h.html#19">level</a>,</div><div id="715" class="line missed">  715                                    <a href="log_msg.h.html#100">data</a>, dlen, package_flags, fmt, ap);</div><div id="716" class="line missed">  716         va_end(ap);</div><div id="717" class="line missed">  717 }</div><div id="718" class="line none">  718 </div><div id="719" class="line none">  719 static inline bool <a href="log_msg.h.html#719">z_log_item_is_msg</a>(const union <a href="log_msg.h.html#117">log_msg_generic</a> *msg)</div><div id="720" class="line none">  720 {</div><div id="721" class="line none">  721         return msg-&gt;<a href="log_msg.h.html#119">generic</a>.<a href="../kernel.h.html#5723">type</a> == <a href="log_msg.h.html#46">Z_LOG_MSG_LOG</a>;</div><div id="722" class="line none">  722 }</div><div id="723" class="line none">  723 </div><div id="724" class="line none">  724 /** @brief Get total length (in 32 bit words) of a log message.</div><div id="725" class="line none">  725  *</div><div id="726" class="line none">  726  * @param desc Log message descriptor.</div><div id="727" class="line none">  727  *</div><div id="728" class="line none">  728  * @return Length.</div><div id="729" class="line none">  729  */</div><div id="730" class="line none">  730 static inline uint32_t <a href="log_msg.h.html#730">log_msg_get_total_wlen</a>(const struct <a href="log_msg.h.html#56">log_msg_desc</a> <a href="log_msg.h.html#71">desc</a>)</div><div id="731" class="line none">  731 {</div><div id="732" class="line none">  732         return <a href="log_msg.h.html#216">Z_LOG_MSG_ALIGNED_WLEN</a>(<a href="log_msg.h.html#71">desc</a>.<a href="log_msg.h.html#60">package_len</a>, <a href="log_msg.h.html#71">desc</a>.<a href="log_msg.h.html#61">data_len</a>);</div><div id="733" class="line none">  733 }</div><div id="734" class="line none">  734 </div><div id="735" class="line none">  735 /** @brief Get length of the log item.</div><div id="736" class="line none">  736  *</div><div id="737" class="line none">  737  * @param item Item.</div><div id="738" class="line none">  738  *</div><div id="739" class="line none">  739  * @return Length in 32 bit words.</div><div id="740" class="line none">  740  */</div><div id="741" class="line none">  741 static inline uint32_t <a href="log_msg.h.html#741">log_msg_generic_get_wlen</a>(const union mpsc_pbuf_generic *item)</div><div id="742" class="line none">  742 {</div><div id="743" class="line none">  743         const union <a href="log_msg.h.html#117">log_msg_generic</a> *generic_msg = (const union <a href="log_msg.h.html#117">log_msg_generic</a> *)item;</div><div id="744" class="line none">  744 </div><div id="745" class="line none">  745         if (<a href="log_msg.h.html#719">z_log_item_is_msg</a>(generic_msg)) {</div><div id="746" class="line none">  746                 const struct <a href="log_msg.h.html#94">log_msg</a> *msg = (const struct <a href="log_msg.h.html#94">log_msg</a> *)generic_msg;</div><div id="747" class="line none">  747 </div><div id="748" class="line none">  748                 return <a href="log_msg.h.html#730">log_msg_get_total_wlen</a>(msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#71">desc</a>);</div><div id="749" class="line none">  749         }</div><div id="750" class="line none">  750 </div><div id="751" class="line none">  751         return 0;</div><div id="752" class="line none">  752 }</div><div id="753" class="line none">  753 </div><div id="754" class="line none">  754 /** @brief Get log message domain ID.</div><div id="755" class="line none">  755  *</div><div id="756" class="line none">  756  * @param msg Log message.</div><div id="757" class="line none">  757  *</div><div id="758" class="line none">  758  * @return Domain ID</div><div id="759" class="line none">  759  */</div><div id="760" class="line none">  760 static inline uint8_t <a href="log_msg.h.html#760">log_msg_get_domain</a>(struct <a href="log_msg.h.html#94">log_msg</a> *msg)</div><div id="761" class="line none">  761 {</div><div id="762" class="line none">  762         return msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#71">desc</a>.<a href="log_msg.h.html#58">domain</a>;</div><div id="763" class="line none">  763 }</div><div id="764" class="line none">  764 </div><div id="765" class="line none">  765 /** @brief Get log message level.</div><div id="766" class="line none">  766  *</div><div id="767" class="line none">  767  * @param msg Log message.</div><div id="768" class="line none">  768  *</div><div id="769" class="line none">  769  * @return Log level.</div><div id="770" class="line none">  770  */</div><div id="771" class="line none">  771 static inline uint8_t <a href="log_msg.h.html#771">log_msg_get_level</a>(struct <a href="log_msg.h.html#94">log_msg</a> *msg)</div><div id="772" class="line none">  772 {</div><div id="773" class="line none">  773         return msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#71">desc</a>.<a href="log_instance.h.html#19">level</a>;</div><div id="774" class="line none">  774 }</div><div id="775" class="line none">  775 </div><div id="776" class="line none">  776 /** @brief Get message source data.</div><div id="777" class="line none">  777  *</div><div id="778" class="line none">  778  * @param msg Log message.</div><div id="779" class="line none">  779  *</div><div id="780" class="line none">  780  * @return Pointer to the source data.</div><div id="781" class="line none">  781  */</div><div id="782" class="line none">  782 static inline const void *<a href="log_msg.h.html#782">log_msg_get_source</a>(struct <a href="log_msg.h.html#94">log_msg</a> *msg)</div><div id="783" class="line none">  783 {</div><div id="784" class="line none">  784         return msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#77">source</a>;</div><div id="785" class="line none">  785 }</div><div id="786" class="line none">  786 </div><div id="787" class="line none">  787 /** @brief Get log message source ID.</div><div id="788" class="line none">  788  *</div><div id="789" class="line none">  789  * @param msg Log message.</div><div id="790" class="line none">  790  *</div><div id="791" class="line none">  791  * @return Source ID, or -1 if not available.</div><div id="792" class="line none">  792  */</div><div id="793" class="line none">  793 int16_t log_msg_get_source_id(struct <a href="log_msg.h.html#94">log_msg</a> *msg);</div><div id="794" class="line none">  794 </div><div id="795" class="line none">  795 /** @brief Get timestamp.</div><div id="796" class="line none">  796  *</div><div id="797" class="line none">  797  * @param msg Log message.</div><div id="798" class="line none">  798  *</div><div id="799" class="line none">  799  * @return Timestamp.</div><div id="800" class="line none">  800  */</div><div id="801" class="line none">  801 static inline <a href="log_msg.h.html#34">log_timestamp_t</a> <a href="log_msg.h.html#801">log_msg_get_timestamp</a>(struct <a href="log_msg.h.html#94">log_msg</a> *msg)</div><div id="802" class="line none">  802 {</div><div id="803" class="line none">  803         return msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#76">timestamp</a>;</div><div id="804" class="line none">  804 }</div><div id="805" class="line none">  805 </div><div id="806" class="line none">  806 /** @brief Get Thread ID.</div><div id="807" class="line none">  807  *</div><div id="808" class="line none">  808  * @param msg Log message.</div><div id="809" class="line none">  809  *</div><div id="810" class="line none">  810  * @return Thread ID.</div><div id="811" class="line none">  811  */</div><div id="812" class="line none">  812 static inline void *<a href="log_msg.h.html#812">log_msg_get_tid</a>(struct <a href="log_msg.h.html#94">log_msg</a> *msg)</div><div id="813" class="line none">  813 {</div><div id="814" class="line none">  814 #if defined(CONFIG_LOG_THREAD_ID_PREFIX)</div><div id="815" class="line none">  815         return msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#83">tid</a>;</div><div id="816" class="line none">  816 #else</div><div id="817" class="line none">  817         ARG_UNUSED(msg);</div><div id="818" class="line none">  818         return NULL;</div><div id="819" class="line none">  819 #endif</div><div id="820" class="line none">  820 }</div><div id="821" class="line none">  821 </div><div id="822" class="line none">  822 /** @brief Get data buffer.</div><div id="823" class="line none">  823  *</div><div id="824" class="line none">  824  * @param msg log message.</div><div id="825" class="line none">  825  *</div><div id="826" class="line none">  826  * @param len location where data length is written.</div><div id="827" class="line none">  827  *</div><div id="828" class="line none">  828  * @return pointer to the data buffer.</div><div id="829" class="line none">  829  */</div><div id="830" class="line none">  830 static inline uint8_t *<a href="log_msg.h.html#830">log_msg_get_data</a>(struct <a href="log_msg.h.html#94">log_msg</a> *msg, size_t *<a href="../net/mqtt.h.html#172">len</a>)</div><div id="831" class="line none">  831 {</div><div id="832" class="line none">  832         *<a href="../net/mqtt.h.html#172">len</a> = msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#71">desc</a>.<a href="log_msg.h.html#61">data_len</a>;</div><div id="833" class="line none">  833 </div><div id="834" class="line none">  834         return msg-&gt;<a href="log_msg.h.html#100">data</a> + msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#71">desc</a>.<a href="log_msg.h.html#60">package_len</a>;</div><div id="835" class="line none">  835 }</div><div id="836" class="line none">  836 </div><div id="837" class="line none">  837 /** @brief Get string package.</div><div id="838" class="line none">  838  *</div><div id="839" class="line none">  839  * @param msg log message.</div><div id="840" class="line none">  840  *</div><div id="841" class="line none">  841  * @param len location where string package length is written.</div><div id="842" class="line none">  842  *</div><div id="843" class="line none">  843  * @return pointer to the package.</div><div id="844" class="line none">  844  */</div><div id="845" class="line none">  845 static inline uint8_t *<a href="log_msg.h.html#845">log_msg_get_package</a>(struct <a href="log_msg.h.html#94">log_msg</a> *msg, size_t *<a href="../net/mqtt.h.html#172">len</a>)</div><div id="846" class="line none">  846 {</div><div id="847" class="line none">  847         *<a href="../net/mqtt.h.html#172">len</a> = msg-&gt;<a href="log_msg.h.html#95">hdr</a>.<a href="log_msg.h.html#71">desc</a>.<a href="log_msg.h.html#60">package_len</a>;</div><div id="848" class="line none">  848 </div><div id="849" class="line none">  849         return msg-&gt;<a href="log_msg.h.html#100">data</a>;</div><div id="850" class="line none">  850 }</div><div id="851" class="line none">  851 </div><div id="852" class="line none">  852 /**</div><div id="853" class="line none">  853  * @}</div><div id="854" class="line none">  854  */</div><div id="855" class="line none">  855 </div><div id="856" class="line none">  856 #include &lt;zephyr/syscalls/<a href="log_msg.h.html#94">log_msg</a>.h&gt;</div><div id="857" class="line none">  857 </div><div id="858" class="line none">  858 #ifdef __cplusplus</div><div id="859" class="line none">  859 }</div><div id="860" class="line none">  860 #endif</div><div id="861" class="line none">  861 </div><div id="862" class="line none">  862 #endif /* ZEPHYR_INCLUDE_LOGGING_LOG_MSG_H_ */</div>
</div>
</body>
</html>
