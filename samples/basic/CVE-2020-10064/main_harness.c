#include <ieee802154_frame.c>

uint16_t nondet_uint16_t();

void harness()
{

	// size_t buf_size;
	// __CPROVER_assume(buf_size > 0 && buf_size <= IEEE802154_MTU);
	// uint8_t *buf = malloc(buf_size);
	// __CPROVER_assume(buf != NULL);

	struct ieee802154_fcf_seq fs;
	__CPROVER_assume(&fs != NULL);
	uint8_t *buf = (uint8_t *)&fs;

	uint8_t length;

	struct ieee802154_mpdu mpdu;
	__CPROVER_assume(&mpdu != NULL);
	mpdu.mhr.fs = &fs;

	struct ieee802154_beacon beacon;
	struct ieee802154_command command;
	__CPROVER_assume(&beacon != NULL);
	__CPROVER_assume(&command != NULL);
	mpdu.beacon = &beacon;
	mpdu.command = &command;

	struct ieee802154_address_field dst_addr;
	struct ieee802154_address_field src_addr;
	__CPROVER_assume(&dst_addr != NULL);
	__CPROVER_assume(&src_addr != NULL);
	mpdu.mhr.dst_addr = &dst_addr;
	mpdu.mhr.src_addr = &src_addr;

	bool result = ieee802154_validate_frame(buf, length, &mpdu);
}

int main(void)
{
	harness();
	return 0;
}
