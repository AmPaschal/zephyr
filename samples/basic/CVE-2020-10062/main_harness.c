#include <mqtt_decoder.c>

void harness()
{

	struct buf_ctx buf;

	size_t buffer_size;
	__CPROVER_assume(buffer_size > 0 && buffer_size < 1000);
	buf.cur = malloc(buffer_size);
	__CPROVER_assume(buf.cur != NULL);
	buf.end = buffer_size == 0 ? buf.cur : buf.cur + buffer_size - 1;

	uint32_t *length = malloc(sizeof(uint32_t));
	__CPROVER_assume(length != NULL);

	int result = packet_length_decode(&buf, length);
}

int main(void)
{

	harness();
	return 0;
}
