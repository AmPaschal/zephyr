#include "mqtt/mqtt_internal.h"
#include "zephyr/net/mqtt.h"

int harness() {

	// Model input variables:

	struct mqtt_client client;
	uint8_t tflags;
	uint32_t length;
	struct buf_ctx bctx;

	// Allocate buffer:

	uint16_t size;

	// Define maximum size:

	__CPROVER_assume(size <= 100);

	// Allocate buffer:

	uint8_t *buf = malloc(size);

	// Set values:

	bctx.cur = buf;

	if (size == 0) {
		bctx.end = buf;
	}

	else {

		bctx.end = buf + (size - 1);
	}

	int res = mqtt_handle_packet(&client, tflags, length, &bctx);
}

int main() {

	harness();
	return 0;
}
