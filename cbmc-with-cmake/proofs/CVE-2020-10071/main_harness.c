#include "mqtt/mqtt_internal.h"
#include "zephyr/net/mqtt.h"

int harness() {

	// Model input variables:

	uint8_t flags;
	uint32_t var_length;
	struct buf_ctx bctx;
	struct mqtt_publish_param params;

	// Allocate buffer to utilize:

	uint16_t size;

	// Define maximum size:

	__CPROVER_assume(size <= 100);

	// Allocate buffer:

	uint8_t *buf = malloc(size);

	// Set values:

	bctx.cur = buf;

	if (size == 0) {
		bctx.end = buf;
	}

	else {

		bctx.end = buf + (size - 1);
	}

	// Call harnessed function:

	int res = publish_decode(flags, var_length, &bctx, &params);
}

int main() {

	harness();
	return 0;
}
