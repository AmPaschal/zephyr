
<html>
<head>
<title>zephyr/include/zephyr/net/net_ip.h</title>
<link rel="stylesheet" type="text/css" href="../../../../viewer.css">
</head>

<body>
<div class="code">
<div id="1" class="line none">    1 /** @file</div><div id="2" class="line none">    2  * @brief IPv6 and IPv4 definitions</div><div id="3" class="line none">    3  *</div><div id="4" class="line none">    4  * Generic IPv6 and IPv4 address definitions.</div><div id="5" class="line none">    5  */</div><div id="6" class="line none">    6 </div><div id="7" class="line none">    7 /*</div><div id="8" class="line none">    8  * Copyright (c) 2016 Intel Corporation</div><div id="9" class="line none">    9  *</div><div id="10" class="line none">   10  * SPDX-License-Identifier: Apache-2.0</div><div id="11" class="line none">   11  */</div><div id="12" class="line none">   12 </div><div id="13" class="line none">   13 #ifndef <a href="net_ip.h.html#14">ZEPHYR_INCLUDE_NET_NET_IP_H_</a></div><div id="14" class="line none">   14 #define <a href="net_ip.h.html#14">ZEPHYR_INCLUDE_NET_NET_IP_H_</a></div><div id="15" class="line none">   15 </div><div id="16" class="line none">   16 /**</div><div id="17" class="line none">   17  * @brief IPv4/IPv6 primitives and helpers</div><div id="18" class="line none">   18  * @defgroup ip_4_6 IPv4/IPv6 primitives and helpers</div><div id="19" class="line none">   19  * @ingroup networking</div><div id="20" class="line none">   20  * @{</div><div id="21" class="line none">   21  */</div><div id="22" class="line none">   22 </div><div id="23" class="line none">   23 #include &lt;string.h&gt;</div><div id="24" class="line none">   24 #include &lt;zephyr/types.h&gt;</div><div id="25" class="line none">   25 #include &lt;stdbool.h&gt;</div><div id="26" class="line none">   26 #include &lt;zephyr/sys/util.h&gt;</div><div id="27" class="line none">   27 #include &lt;zephyr/sys/byteorder.h&gt;</div><div id="28" class="line none">   28 #include &lt;zephyr/toolchain.h&gt;</div><div id="29" class="line none">   29 </div><div id="30" class="line none">   30 #include &lt;zephyr/net/net_linkaddr.h&gt;</div><div id="31" class="line none">   31 </div><div id="32" class="line none">   32 #ifdef __cplusplus</div><div id="33" class="line none">   33 extern "C" {</div><div id="34" class="line none">   34 #endif</div><div id="35" class="line none">   35 </div><div id="36" class="line none">   36 /** @cond INTERNAL_HIDDEN */</div><div id="37" class="line none">   37 /* Specifying VLAN tag here in order to avoid circular dependencies */</div><div id="38" class="line none">   38 #define <a href="net_ip.h.html#38">NET_VLAN_TAG_UNSPEC</a> 0x0fff</div><div id="39" class="line none">   39 /** @endcond */</div><div id="40" class="line none">   40 </div><div id="41" class="line none">   41 /* Protocol families. */</div><div id="42" class="line none">   42 #define <a href="net_ip.h.html#42">PF_UNSPEC</a>       0          /**&lt; Unspecified protocol family.  */</div><div id="43" class="line none">   43 #define <a href="net_ip.h.html#43">PF_INET</a>         1          /**&lt; IP protocol family version 4. */</div><div id="44" class="line none">   44 #define <a href="net_ip.h.html#44">PF_INET6</a>        2          /**&lt; IP protocol family version 6. */</div><div id="45" class="line none">   45 #define <a href="net_ip.h.html#45">PF_PACKET</a>       3          /**&lt; Packet family.                */</div><div id="46" class="line none">   46 #define <a href="net_ip.h.html#46">PF_CAN</a>          4          /**&lt; Controller Area Network.      */</div><div id="47" class="line none">   47 #define <a href="net_ip.h.html#47">PF_NET_MGMT</a>     5          /**&lt; Network management info.      */</div><div id="48" class="line none">   48 #define <a href="net_ip.h.html#48">PF_LOCAL</a>        6          /**&lt; Inter-process communication   */</div><div id="49" class="line none">   49 #define <a href="net_ip.h.html#49">PF_UNIX</a>         <a href="net_ip.h.html#48">PF_LOCAL</a>   /**&lt; Inter-process communication   */</div><div id="50" class="line none">   50 </div><div id="51" class="line none">   51 /* Address families. */</div><div id="52" class="line none">   52 #define <a href="net_ip.h.html#52">AF_UNSPEC</a>      <a href="net_ip.h.html#42">PF_UNSPEC</a>   /**&lt; Unspecified address family.   */</div><div id="53" class="line none">   53 #define <a href="net_ip.h.html#53">AF_INET</a>        <a href="net_ip.h.html#43">PF_INET</a>     /**&lt; IP protocol family version 4. */</div><div id="54" class="line none">   54 #define <a href="net_ip.h.html#54">AF_INET6</a>       <a href="net_ip.h.html#44">PF_INET6</a>    /**&lt; IP protocol family version 6. */</div><div id="55" class="line none">   55 #define <a href="net_ip.h.html#55">AF_PACKET</a>      <a href="net_ip.h.html#45">PF_PACKET</a>   /**&lt; Packet family.                */</div><div id="56" class="line none">   56 #define <a href="net_ip.h.html#56">AF_CAN</a>         <a href="net_ip.h.html#46">PF_CAN</a>      /**&lt; Controller Area Network.      */</div><div id="57" class="line none">   57 #define <a href="net_ip.h.html#57">AF_NET_MGMT</a>    <a href="net_ip.h.html#47">PF_NET_MGMT</a> /**&lt; Network management info.      */</div><div id="58" class="line none">   58 #define <a href="net_ip.h.html#58">AF_LOCAL</a>       <a href="net_ip.h.html#48">PF_LOCAL</a>    /**&lt; Inter-process communication   */</div><div id="59" class="line none">   59 #define <a href="net_ip.h.html#59">AF_UNIX</a>        <a href="net_ip.h.html#49">PF_UNIX</a>     /**&lt; Inter-process communication   */</div><div id="60" class="line none">   60 </div><div id="61" class="line none">   61 /** Protocol numbers from IANA/BSD */</div><div id="62" class="line none">   62 enum <a href="net_ip.h.html#62">net_ip_protocol</a> {</div><div id="63" class="line none">   63         <a href="net_ip.h.html#63">IPPROTO_IP</a> = 0,            /**&lt; IP protocol (pseudo-val for setsockopt() */</div><div id="64" class="line none">   64         <a href="net_ip.h.html#64">IPPROTO_ICMP</a> = 1,          /**&lt; ICMP protocol   */</div><div id="65" class="line none">   65         <a href="net_ip.h.html#65">IPPROTO_IGMP</a> = 2,          /**&lt; IGMP protocol   */</div><div id="66" class="line none">   66         <a href="net_ip.h.html#66">IPPROTO_IPIP</a> = 4,          /**&lt; IPIP tunnels    */</div><div id="67" class="line none">   67         <a href="net_ip.h.html#67">IPPROTO_TCP</a> = 6,           /**&lt; TCP protocol    */</div><div id="68" class="line none">   68         <a href="net_ip.h.html#68">IPPROTO_UDP</a> = 17,          /**&lt; UDP protocol    */</div><div id="69" class="line none">   69         <a href="net_ip.h.html#69">IPPROTO_IPV6</a> = 41,         /**&lt; IPv6 protocol   */</div><div id="70" class="line none">   70         <a href="net_ip.h.html#70">IPPROTO_ICMPV6</a> = 58,       /**&lt; ICMPv6 protocol */</div><div id="71" class="line none">   71         <a href="net_ip.h.html#71">IPPROTO_RAW</a> = 255,         /**&lt; RAW IP packets  */</div><div id="72" class="line none">   72 };</div><div id="73" class="line none">   73 </div><div id="74" class="line none">   74 /** Protocol numbers for TLS protocols */</div><div id="75" class="line none">   75 enum <a href="net_ip.h.html#75">net_ip_protocol_secure</a> {</div><div id="76" class="line none">   76         <a href="net_ip.h.html#76">IPPROTO_TLS_1_0</a> = 256,     /**&lt; TLS 1.0 protocol */</div><div id="77" class="line none">   77         <a href="net_ip.h.html#77">IPPROTO_TLS_1_1</a> = 257,     /**&lt; TLS 1.1 protocol */</div><div id="78" class="line none">   78         <a href="net_ip.h.html#78">IPPROTO_TLS_1_2</a> = 258,     /**&lt; TLS 1.2 protocol */</div><div id="79" class="line none">   79         <a href="net_ip.h.html#79">IPPROTO_DTLS_1_0</a> = 272,    /**&lt; DTLS 1.0 protocol */</div><div id="80" class="line none">   80         <a href="net_ip.h.html#80">IPPROTO_DTLS_1_2</a> = 273,    /**&lt; DTLS 1.2 protocol */</div><div id="81" class="line none">   81 };</div><div id="82" class="line none">   82 </div><div id="83" class="line none">   83 /** Socket type */</div><div id="84" class="line none">   84 enum <a href="net_ip.h.html#84">net_sock_type</a> {</div><div id="85" class="line none">   85         <a href="net_ip.h.html#85">SOCK_STREAM</a> = 1,           /**&lt; Stream socket type   */</div><div id="86" class="line none">   86         <a href="net_ip.h.html#86">SOCK_DGRAM</a>,                /**&lt; Datagram socket type */</div><div id="87" class="line none">   87         <a href="net_ip.h.html#87">SOCK_RAW</a>                   /**&lt; RAW socket type      */</div><div id="88" class="line none">   88 };</div><div id="89" class="line none">   89 </div><div id="90" class="line none">   90 /** @brief Convert 16-bit value from network to host byte order.</div><div id="91" class="line none">   91  *</div><div id="92" class="line none">   92  * @param x The network byte order value to convert.</div><div id="93" class="line none">   93  *</div><div id="94" class="line none">   94  * @return Host byte order value.</div><div id="95" class="line none">   95  */</div><div id="96" class="line none">   96 #define <a href="net_ip.h.html#96">ntohs</a>(x) sys_be16_to_cpu(x)</div><div id="97" class="line none">   97 </div><div id="98" class="line none">   98 /** @brief Convert 32-bit value from network to host byte order.</div><div id="99" class="line none">   99  *</div><div id="100" class="line none">  100  * @param x The network byte order value to convert.</div><div id="101" class="line none">  101  *</div><div id="102" class="line none">  102  * @return Host byte order value.</div><div id="103" class="line none">  103  */</div><div id="104" class="line none">  104 #define <a href="net_ip.h.html#104">ntohl</a>(x) sys_be32_to_cpu(x)</div><div id="105" class="line none">  105 </div><div id="106" class="line none">  106 /** @brief Convert 64-bit value from network to host byte order.</div><div id="107" class="line none">  107  *</div><div id="108" class="line none">  108  * @param x The network byte order value to convert.</div><div id="109" class="line none">  109  *</div><div id="110" class="line none">  110  * @return Host byte order value.</div><div id="111" class="line none">  111  */</div><div id="112" class="line none">  112 #define <a href="net_ip.h.html#112">ntohll</a>(x) sys_be64_to_cpu(x)</div><div id="113" class="line none">  113 </div><div id="114" class="line none">  114 /** @brief Convert 16-bit value from host to network byte order.</div><div id="115" class="line none">  115  *</div><div id="116" class="line none">  116  * @param x The host byte order value to convert.</div><div id="117" class="line none">  117  *</div><div id="118" class="line none">  118  * @return Network byte order value.</div><div id="119" class="line none">  119  */</div><div id="120" class="line none">  120 #define <a href="net_ip.h.html#120">htons</a>(x) sys_cpu_to_be16(x)</div><div id="121" class="line none">  121 </div><div id="122" class="line none">  122 /** @brief Convert 32-bit value from host to network byte order.</div><div id="123" class="line none">  123  *</div><div id="124" class="line none">  124  * @param x The host byte order value to convert.</div><div id="125" class="line none">  125  *</div><div id="126" class="line none">  126  * @return Network byte order value.</div><div id="127" class="line none">  127  */</div><div id="128" class="line none">  128 #define <a href="net_ip.h.html#128">htonl</a>(x) sys_cpu_to_be32(x)</div><div id="129" class="line none">  129 </div><div id="130" class="line none">  130 /** @brief Convert 64-bit value from host to network byte order.</div><div id="131" class="line none">  131  *</div><div id="132" class="line none">  132  * @param x The host byte order value to convert.</div><div id="133" class="line none">  133  *</div><div id="134" class="line none">  134  * @return Network byte order value.</div><div id="135" class="line none">  135  */</div><div id="136" class="line none">  136 #define <a href="net_ip.h.html#136">htonll</a>(x) sys_cpu_to_be64(x)</div><div id="137" class="line none">  137 </div><div id="138" class="line none">  138 /** IPv6 address struct */</div><div id="139" class="line none">  139 struct <a href="net_ip.h.html#139">in6_addr</a> {</div><div id="140" class="line none">  140         union {</div><div id="141" class="line none">  141                 uint8_t <a href="net_ip.h.html#141">s6_addr</a>[16];   /**&lt; IPv6 address buffer */</div><div id="142" class="line none">  142                 uint16_t <a href="net_ip.h.html#142">s6_addr16</a>[8]; /**&lt; In big endian */</div><div id="143" class="line none">  143                 uint32_t <a href="net_ip.h.html#143">s6_addr32</a>[4]; /**&lt; In big endian */</div><div id="144" class="line none">  144         };</div><div id="145" class="line none">  145 };</div><div id="146" class="line none">  146 </div><div id="147" class="line none">  147 /** Binary size of the IPv6 address */</div><div id="148" class="line none">  148 #define <a href="net_ip.h.html#148">NET_IPV6_ADDR_SIZE</a> 16</div><div id="149" class="line none">  149 </div><div id="150" class="line none">  150 /** IPv4 address struct */</div><div id="151" class="line none">  151 struct <a href="net_ip.h.html#151">in_addr</a> {</div><div id="152" class="line none">  152         union {</div><div id="153" class="line none">  153                 uint8_t <a href="net_ip.h.html#153">s4_addr</a>[4];    /**&lt; IPv4 address buffer */</div><div id="154" class="line none">  154                 uint16_t <a href="net_ip.h.html#154">s4_addr16</a>[2]; /**&lt; In big endian */</div><div id="155" class="line none">  155                 uint32_t <a href="net_ip.h.html#155">s4_addr32</a>[1]; /**&lt; In big endian */</div><div id="156" class="line none">  156                 uint32_t <a href="net_ip.h.html#156">s_addr</a>; /**&lt; In big endian, for POSIX compatibility. */</div><div id="157" class="line none">  157         };</div><div id="158" class="line none">  158 };</div><div id="159" class="line none">  159 </div><div id="160" class="line none">  160 /** Binary size of the IPv4 address */</div><div id="161" class="line none">  161 #define <a href="net_ip.h.html#161">NET_IPV4_ADDR_SIZE</a> 4</div><div id="162" class="line none">  162 </div><div id="163" class="line none">  163 /** Socket address family type */</div><div id="164" class="line none">  164 typedef unsigned short int <a href="net_ip.h.html#164">sa_family_t</a>;</div><div id="165" class="line none">  165 </div><div id="166" class="line none">  166 /** Length of a socket address */</div><div id="167" class="line none">  167 #ifndef <a href="net_ip.h.html#169">__socklen_t_defined</a></div><div id="168" class="line none">  168 typedef size_t <a href="net_ip.h.html#168">socklen_t</a>;</div><div id="169" class="line none">  169 #define <a href="net_ip.h.html#169">__socklen_t_defined</a></div><div id="170" class="line none">  170 #endif</div><div id="171" class="line none">  171 </div><div id="172" class="line none">  172 /*</div><div id="173" class="line none">  173  * Note that the sin_port and sin6_port are in network byte order</div><div id="174" class="line none">  174  * in various sockaddr* structs.</div><div id="175" class="line none">  175  */</div><div id="176" class="line none">  176 </div><div id="177" class="line none">  177 /** Socket address struct for IPv6. */</div><div id="178" class="line none">  178 struct <a href="net_ip.h.html#178">sockaddr_in6</a> {</div><div id="179" class="line none">  179         <a href="net_ip.h.html#164">sa_family_t</a>             <a href="net_ip.h.html#179">sin6_family</a>;   /**&lt; AF_INET6               */</div><div id="180" class="line none">  180         uint16_t                <a href="net_ip.h.html#180">sin6_port</a>;     /**&lt; Port number            */</div><div id="181" class="line none">  181         struct <a href="net_ip.h.html#139">in6_addr</a>         <a href="net_ip.h.html#181">sin6_addr</a>;     /**&lt; IPv6 address           */</div><div id="182" class="line none">  182         uint8_t                 <a href="net_ip.h.html#182">sin6_scope_id</a>; /**&lt; Interfaces for a scope */</div><div id="183" class="line none">  183 };</div><div id="184" class="line none">  184 </div><div id="185" class="line none">  185 /** Socket address struct for IPv4. */</div><div id="186" class="line none">  186 struct <a href="net_ip.h.html#186">sockaddr_in</a> {</div><div id="187" class="line none">  187         <a href="net_ip.h.html#164">sa_family_t</a>             <a href="net_ip.h.html#187">sin_family</a>;    /**&lt; AF_INET      */</div><div id="188" class="line none">  188         uint16_t                <a href="net_ip.h.html#188">sin_port</a>;      /**&lt; Port number  */</div><div id="189" class="line none">  189         struct <a href="net_ip.h.html#151">in_addr</a>          <a href="net_ip.h.html#189">sin_addr</a>;      /**&lt; IPv4 address */</div><div id="190" class="line none">  190 };</div><div id="191" class="line none">  191 </div><div id="192" class="line none">  192 /** Socket address struct for packet socket. */</div><div id="193" class="line none">  193 struct <a href="net_ip.h.html#193">sockaddr_ll</a> {</div><div id="194" class="line none">  194         <a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#194">sll_family</a>;   /**&lt; Always AF_PACKET                   */</div><div id="195" class="line none">  195         uint16_t    <a href="net_ip.h.html#195">sll_protocol</a>; /**&lt; Physical-layer protocol            */</div><div id="196" class="line none">  196         int         <a href="net_ip.h.html#196">sll_ifindex</a>;  /**&lt; Interface number                   */</div><div id="197" class="line none">  197         uint16_t    <a href="net_ip.h.html#197">sll_hatype</a>;   /**&lt; ARP hardware type                  */</div><div id="198" class="line none">  198         uint8_t     <a href="net_ip.h.html#198">sll_pkttype</a>;  /**&lt; Packet type                        */</div><div id="199" class="line none">  199         uint8_t     <a href="net_ip.h.html#199">sll_halen</a>;    /**&lt; Length of address                  */</div><div id="200" class="line none">  200         uint8_t     <a href="net_ip.h.html#200">sll_addr</a>[8];  /**&lt; Physical-layer address, big endian */</div><div id="201" class="line none">  201 };</div><div id="202" class="line none">  202 </div><div id="203" class="line none">  203 /** @cond INTERNAL_HIDDEN */</div><div id="204" class="line none">  204 </div><div id="205" class="line none">  205 /** Socket address struct for IPv6 where address is a pointer */</div><div id="206" class="line none">  206 struct <a href="net_ip.h.html#206">sockaddr_in6_ptr</a> {</div><div id="207" class="line none">  207         <a href="net_ip.h.html#164">sa_family_t</a>             <a href="net_ip.h.html#179">sin6_family</a>;   /**&lt; AF_INET6               */</div><div id="208" class="line none">  208         uint16_t                <a href="net_ip.h.html#180">sin6_port</a>;     /**&lt; Port number            */</div><div id="209" class="line none">  209         struct <a href="net_ip.h.html#139">in6_addr</a>         *<a href="net_ip.h.html#181">sin6_addr</a>;    /**&lt; IPv6 address           */</div><div id="210" class="line none">  210         uint8_t                 <a href="net_ip.h.html#182">sin6_scope_id</a>; /**&lt; interfaces for a scope */</div><div id="211" class="line none">  211 };</div><div id="212" class="line none">  212 </div><div id="213" class="line none">  213 /** Socket address struct for IPv4 where address is a pointer */</div><div id="214" class="line none">  214 struct <a href="net_ip.h.html#214">sockaddr_in_ptr</a> {</div><div id="215" class="line none">  215         <a href="net_ip.h.html#164">sa_family_t</a>             <a href="net_ip.h.html#187">sin_family</a>;    /**&lt; AF_INET      */</div><div id="216" class="line none">  216         uint16_t                <a href="net_ip.h.html#188">sin_port</a>;      /**&lt; Port number  */</div><div id="217" class="line none">  217         struct <a href="net_ip.h.html#151">in_addr</a>          *<a href="net_ip.h.html#189">sin_addr</a>;     /**&lt; IPv4 address */</div><div id="218" class="line none">  218 };</div><div id="219" class="line none">  219 </div><div id="220" class="line none">  220 /** Socket address struct for packet socket where address is a pointer */</div><div id="221" class="line none">  221 struct <a href="net_ip.h.html#221">sockaddr_ll_ptr</a> {</div><div id="222" class="line none">  222         <a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#194">sll_family</a>;   /**&lt; Always AF_PACKET                   */</div><div id="223" class="line none">  223         uint16_t    <a href="net_ip.h.html#195">sll_protocol</a>; /**&lt; Physical-layer protocol            */</div><div id="224" class="line none">  224         int         <a href="net_ip.h.html#196">sll_ifindex</a>;  /**&lt; Interface number                   */</div><div id="225" class="line none">  225         uint16_t    <a href="net_ip.h.html#197">sll_hatype</a>;   /**&lt; ARP hardware type                  */</div><div id="226" class="line none">  226         uint8_t     <a href="net_ip.h.html#198">sll_pkttype</a>;  /**&lt; Packet type                        */</div><div id="227" class="line none">  227         uint8_t     <a href="net_ip.h.html#199">sll_halen</a>;    /**&lt; Length of address                  */</div><div id="228" class="line none">  228         uint8_t     *<a href="net_ip.h.html#200">sll_addr</a>;    /**&lt; Physical-layer address, big endian */</div><div id="229" class="line none">  229 };</div><div id="230" class="line none">  230 </div><div id="231" class="line none">  231 struct <a href="net_ip.h.html#231">sockaddr_can_ptr</a> {</div><div id="232" class="line none">  232         <a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#232">can_family</a>;</div><div id="233" class="line none">  233         int         <a href="net_ip.h.html#233">can_ifindex</a>;</div><div id="234" class="line none">  234 };</div><div id="235" class="line none">  235 </div><div id="236" class="line none">  236 /** @endcond */</div><div id="237" class="line none">  237 </div><div id="238" class="line none">  238 #if !defined(HAVE_IOVEC)</div><div id="239" class="line none">  239 /** IO vector array element */</div><div id="240" class="line none">  240 struct <a href="net_ip.h.html#240">iovec</a> {</div><div id="241" class="line none">  241         void  *<a href="net_ip.h.html#241">iov_base</a>; /**&lt; Pointer to data */</div><div id="242" class="line none">  242         size_t <a href="net_ip.h.html#242">iov_len</a>;  /**&lt; Length of the data */</div><div id="243" class="line none">  243 };</div><div id="244" class="line none">  244 #endif</div><div id="245" class="line none">  245 </div><div id="246" class="line none">  246 /** Message struct */</div><div id="247" class="line none">  247 struct <a href="net_ip.h.html#247">msghdr</a> {</div><div id="248" class="line none">  248         void         *<a href="net_ip.h.html#248">msg_name</a>;       /**&lt; Optional socket address, big endian */</div><div id="249" class="line none">  249         <a href="net_ip.h.html#168">socklen_t</a>     <a href="net_ip.h.html#249">msg_namelen</a>;    /**&lt; Size of socket address */</div><div id="250" class="line none">  250         struct <a href="net_ip.h.html#240">iovec</a> *<a href="net_ip.h.html#250">msg_iov</a>;        /**&lt; Scatter/gather array */</div><div id="251" class="line none">  251         size_t        <a href="net_ip.h.html#251">msg_iovlen</a>;     /**&lt; Number of elements in msg_iov */</div><div id="252" class="line none">  252         void         *<a href="net_ip.h.html#252">msg_control</a>;    /**&lt; Ancillary data */</div><div id="253" class="line none">  253         size_t        <a href="net_ip.h.html#253">msg_controllen</a>; /**&lt; Ancillary data buffer len */</div><div id="254" class="line none">  254         int           <a href="net_ip.h.html#254">msg_flags</a>;      /**&lt; Flags on received message */</div><div id="255" class="line none">  255 };</div><div id="256" class="line none">  256 </div><div id="257" class="line none">  257 /** Control message ancillary data */</div><div id="258" class="line none">  258 struct <a href="net_ip.h.html#258">cmsghdr</a> {</div><div id="259" class="line none">  259         <a href="net_ip.h.html#168">socklen_t</a> <a href="net_ip.h.html#259">cmsg_len</a>;    /**&lt; Number of bytes, including header */</div><div id="260" class="line none">  260         int       <a href="net_ip.h.html#260">cmsg_level</a>;  /**&lt; Originating protocol */</div><div id="261" class="line none">  261         int       <a href="net_ip.h.html#261">cmsg_type</a>;   /**&lt; Protocol-specific type */</div><div id="262" class="line none">  262         z_max_align_t <a href="net_ip.h.html#262">cmsg_data</a>[]; /**&lt; Flexible array member to force alignment of cmsghdr */</div><div id="263" class="line none">  263 };</div><div id="264" class="line none">  264 </div><div id="265" class="line none">  265 /** @cond INTERNAL_HIDDEN */</div><div id="266" class="line none">  266 </div><div id="267" class="line none">  267 /* Alignment for headers and data. These are arch specific but define</div><div id="268" class="line none">  268  * them here atm if not found already.</div><div id="269" class="line none">  269  */</div><div id="270" class="line none">  270 #if !defined(<a href="net_ip.h.html#271">ALIGN_H</a>)</div><div id="271" class="line none">  271 #define <a href="net_ip.h.html#271">ALIGN_H</a>(x) ROUND_UP(x, __alignof__(struct <a href="net_ip.h.html#258">cmsghdr</a>))</div><div id="272" class="line none">  272 #endif</div><div id="273" class="line none">  273 #if !defined(<a href="net_ip.h.html#274">ALIGN_D</a>)</div><div id="274" class="line none">  274 #define <a href="net_ip.h.html#274">ALIGN_D</a>(x) ROUND_UP(x, __alignof__(z_max_align_t))</div><div id="275" class="line none">  275 #endif</div><div id="276" class="line none">  276 </div><div id="277" class="line none">  277 /** @endcond */</div><div id="278" class="line none">  278 </div><div id="279" class="line none">  279 #if !defined(<a href="net_ip.h.html#285">CMSG_FIRSTHDR</a>)</div><div id="280" class="line none">  280 /**</div><div id="281" class="line none">  281  * Returns a pointer to the first cmsghdr in the ancillary data buffer</div><div id="282" class="line none">  282  * associated with the passed msghdr.  It returns NULL if there isn't</div><div id="283" class="line none">  283  * enough space for a cmsghdr in the buffer.</div><div id="284" class="line none">  284  */</div><div id="285" class="line none">  285 #define <a href="net_ip.h.html#285">CMSG_FIRSTHDR</a>(<a href="net_ip.h.html#247">msghdr</a>)                                   \</div><div id="286" class="line none">  286         ((<a href="net_ip.h.html#247">msghdr</a>)-&gt;<a href="net_ip.h.html#253">msg_controllen</a> &gt;= sizeof(struct <a href="net_ip.h.html#258">cmsghdr</a>) ?   \</div><div id="287" class="line none">  287          (struct <a href="net_ip.h.html#258">cmsghdr</a> *)((<a href="net_ip.h.html#247">msghdr</a>)-&gt;<a href="net_ip.h.html#252">msg_control</a>) : NULL)</div><div id="288" class="line none">  288 #endif</div><div id="289" class="line none">  289 </div><div id="290" class="line none">  290 #if !defined(<a href="net_ip.h.html#295">CMSG_NXTHDR</a>)</div><div id="291" class="line none">  291 /**</div><div id="292" class="line none">  292  * Returns the next valid cmsghdr after the passed cmsghdr. It returns NULL</div><div id="293" class="line none">  293  * when there isn't enough space left in the buffer.</div><div id="294" class="line none">  294  */</div><div id="295" class="line none">  295 #define <a href="net_ip.h.html#295">CMSG_NXTHDR</a>(<a href="net_ip.h.html#247">msghdr</a>, cmsg)                                        \</div><div id="296" class="line none">  296         (((cmsg) == NULL) ? <a href="net_ip.h.html#285">CMSG_FIRSTHDR</a>(<a href="net_ip.h.html#247">msghdr</a>) :                      \</div><div id="297" class="line none">  297          (((uint8_t *)(cmsg) + <a href="net_ip.h.html#271">ALIGN_H</a>((cmsg)-&gt;<a href="net_ip.h.html#259">cmsg_len</a>) +               \</div><div id="298" class="line none">  298            <a href="net_ip.h.html#274">ALIGN_D</a>(sizeof(struct <a href="net_ip.h.html#258">cmsghdr</a>)) &gt;                             \</div><div id="299" class="line none">  299            (uint8_t *)((<a href="net_ip.h.html#247">msghdr</a>)-&gt;<a href="net_ip.h.html#252">msg_control</a>) + (<a href="net_ip.h.html#247">msghdr</a>)-&gt;<a href="net_ip.h.html#253">msg_controllen</a>) ? \</div><div id="300" class="line none">  300           NULL :                                                         \</div><div id="301" class="line none">  301           (struct <a href="net_ip.h.html#258">cmsghdr</a> *)((uint8_t *)(cmsg) +                         \</div><div id="302" class="line none">  302                              <a href="net_ip.h.html#271">ALIGN_H</a>((cmsg)-&gt;<a href="net_ip.h.html#259">cmsg_len</a>))))</div><div id="303" class="line none">  303 #endif</div><div id="304" class="line none">  304 </div><div id="305" class="line none">  305 #if !defined(<a href="net_ip.h.html#313">CMSG_DATA</a>)</div><div id="306" class="line none">  306 /**</div><div id="307" class="line none">  307  * Returns a pointer to the data portion of a cmsghdr.  The pointer returned</div><div id="308" class="line none">  308  * cannot be assumed to be suitably aligned for accessing arbitrary payload</div><div id="309" class="line none">  309  * data types. Applications should not cast it to a pointer type matching</div><div id="310" class="line none">  310  * the payload, but should instead use memcpy(3) to copy data to or from a</div><div id="311" class="line none">  311  * suitably declared object.</div><div id="312" class="line none">  312  */</div><div id="313" class="line none">  313 #define <a href="net_ip.h.html#313">CMSG_DATA</a>(cmsg) ((uint8_t *)(cmsg) + <a href="net_ip.h.html#274">ALIGN_D</a>(sizeof(struct <a href="net_ip.h.html#258">cmsghdr</a>)))</div><div id="314" class="line none">  314 #endif</div><div id="315" class="line none">  315 </div><div id="316" class="line none">  316 #if !defined(<a href="net_ip.h.html#321">CMSG_SPACE</a>)</div><div id="317" class="line none">  317 /**</div><div id="318" class="line none">  318  * Returns the number of bytes an ancillary element with payload of the passed</div><div id="319" class="line none">  319  * data length occupies.</div><div id="320" class="line none">  320  */</div><div id="321" class="line none">  321 #define <a href="net_ip.h.html#321">CMSG_SPACE</a>(length) (<a href="net_ip.h.html#274">ALIGN_D</a>(sizeof(struct <a href="net_ip.h.html#258">cmsghdr</a>)) + <a href="net_ip.h.html#271">ALIGN_H</a>(length))</div><div id="322" class="line none">  322 #endif</div><div id="323" class="line none">  323 </div><div id="324" class="line none">  324 #if !defined(<a href="net_ip.h.html#330">CMSG_LEN</a>)</div><div id="325" class="line none">  325 /**</div><div id="326" class="line none">  326  * Returns the value to store in the cmsg_len member of the cmsghdr structure,</div><div id="327" class="line none">  327  * taking into account any necessary alignment.</div><div id="328" class="line none">  328  * It takes the data length as an argument.</div><div id="329" class="line none">  329  */</div><div id="330" class="line none">  330 #define <a href="net_ip.h.html#330">CMSG_LEN</a>(length) (<a href="net_ip.h.html#274">ALIGN_D</a>(sizeof(struct <a href="net_ip.h.html#258">cmsghdr</a>)) + length)</div><div id="331" class="line none">  331 #endif</div><div id="332" class="line none">  332 </div><div id="333" class="line none">  333 /** @cond INTERNAL_HIDDEN */</div><div id="334" class="line none">  334 </div><div id="335" class="line none">  335 /* Packet types.  */</div><div id="336" class="line none">  336 #define <a href="net_ip.h.html#336">PACKET_HOST</a>         0     /* To us            */</div><div id="337" class="line none">  337 #define <a href="net_ip.h.html#337">PACKET_BROADCAST</a>    1     /* To all           */</div><div id="338" class="line none">  338 #define <a href="net_ip.h.html#338">PACKET_MULTICAST</a>    2     /* To group         */</div><div id="339" class="line none">  339 #define <a href="net_ip.h.html#339">PACKET_OTHERHOST</a>    3     /* To someone else  */</div><div id="340" class="line none">  340 #define <a href="net_ip.h.html#340">PACKET_OUTGOING</a>     4     /* Originated by us */</div><div id="341" class="line none">  341 #define <a href="net_ip.h.html#341">PACKET_LOOPBACK</a>     5</div><div id="342" class="line none">  342 #define <a href="net_ip.h.html#342">PACKET_FASTROUTE</a>    6</div><div id="343" class="line none">  343 </div><div id="344" class="line none">  344 /* ARP protocol HARDWARE identifiers. */</div><div id="345" class="line none">  345 #define <a href="net_ip.h.html#345">ARPHRD_ETHER</a> 1</div><div id="346" class="line none">  346 </div><div id="347" class="line none">  347 /* Note: These macros are defined in a specific order.</div><div id="348" class="line none">  348  * The largest sockaddr size is the last one.</div><div id="349" class="line none">  349  */</div><div id="350" class="line none">  350 #if defined(CONFIG_NET_IPV4)</div><div id="351" class="line none">  351 #undef <a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a></div><div id="352" class="line none">  352 #undef <a href="net_ip.h.html#354">NET_SOCKADDR_PTR_MAX_SIZE</a></div><div id="353" class="line none">  353 #define <a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a> (sizeof(struct <a href="net_ip.h.html#186">sockaddr_in</a>))</div><div id="354" class="line none">  354 #define <a href="net_ip.h.html#354">NET_SOCKADDR_PTR_MAX_SIZE</a> (sizeof(struct <a href="net_ip.h.html#214">sockaddr_in_ptr</a>))</div><div id="355" class="line none">  355 #endif</div><div id="356" class="line none">  356 </div><div id="357" class="line none">  357 #if defined(CONFIG_NET_SOCKETS_PACKET)</div><div id="358" class="line none">  358 #undef <a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a></div><div id="359" class="line none">  359 #undef <a href="net_ip.h.html#354">NET_SOCKADDR_PTR_MAX_SIZE</a></div><div id="360" class="line none">  360 #define <a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a> (sizeof(struct <a href="net_ip.h.html#193">sockaddr_ll</a>))</div><div id="361" class="line none">  361 #define <a href="net_ip.h.html#354">NET_SOCKADDR_PTR_MAX_SIZE</a> (sizeof(struct <a href="net_ip.h.html#221">sockaddr_ll_ptr</a>))</div><div id="362" class="line none">  362 #endif</div><div id="363" class="line none">  363 </div><div id="364" class="line none">  364 #if defined(CONFIG_NET_IPV6)</div><div id="365" class="line none">  365 #undef <a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a></div><div id="366" class="line none">  366 #define <a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a> (sizeof(struct <a href="net_ip.h.html#178">sockaddr_in6</a>))</div><div id="367" class="line none">  367 #if !defined(CONFIG_NET_SOCKETS_PACKET)</div><div id="368" class="line none">  368 #undef <a href="net_ip.h.html#354">NET_SOCKADDR_PTR_MAX_SIZE</a></div><div id="369" class="line none">  369 #define <a href="net_ip.h.html#354">NET_SOCKADDR_PTR_MAX_SIZE</a> (sizeof(struct <a href="net_ip.h.html#206">sockaddr_in6_ptr</a>))</div><div id="370" class="line none">  370 #endif</div><div id="371" class="line none">  371 #endif</div><div id="372" class="line none">  372 </div><div id="373" class="line none">  373 #if !defined(CONFIG_NET_IPV4)</div><div id="374" class="line none">  374 #if !defined(CONFIG_NET_IPV6)</div><div id="375" class="line none">  375 #if !defined(CONFIG_NET_SOCKETS_PACKET)</div><div id="376" class="line none">  376 #define <a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a> (sizeof(struct <a href="net_ip.h.html#178">sockaddr_in6</a>))</div><div id="377" class="line none">  377 #define <a href="net_ip.h.html#354">NET_SOCKADDR_PTR_MAX_SIZE</a> (sizeof(struct <a href="net_ip.h.html#206">sockaddr_in6_ptr</a>))</div><div id="378" class="line none">  378 #endif</div><div id="379" class="line none">  379 #endif</div><div id="380" class="line none">  380 #endif</div><div id="381" class="line none">  381 </div><div id="382" class="line none">  382 /** @endcond */</div><div id="383" class="line none">  383 </div><div id="384" class="line none">  384 /** Generic sockaddr struct. Must be cast to proper type. */</div><div id="385" class="line none">  385 struct <a href="net_ip.h.html#385">sockaddr</a> {</div><div id="386" class="line none">  386         <a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#386">sa_family</a>; /**&lt; Address family */</div><div id="387" class="line none">  387 /** @cond INTERNAL_HIDDEN */</div><div id="388" class="line none">  388         char <a href="buf.h.html#89">data</a>[<a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a> - sizeof(<a href="net_ip.h.html#164">sa_family_t</a>)];</div><div id="389" class="line none">  389 /** @endcond */</div><div id="390" class="line none">  390 };</div><div id="391" class="line none">  391 </div><div id="392" class="line none">  392 /** @cond INTERNAL_HIDDEN */</div><div id="393" class="line none">  393 </div><div id="394" class="line none">  394 struct <a href="net_ip.h.html#394">sockaddr_ptr</a> {</div><div id="395" class="line none">  395         <a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#395">family</a>;</div><div id="396" class="line none">  396         char <a href="buf.h.html#89">data</a>[<a href="net_ip.h.html#354">NET_SOCKADDR_PTR_MAX_SIZE</a> - sizeof(<a href="net_ip.h.html#164">sa_family_t</a>)];</div><div id="397" class="line none">  397 };</div><div id="398" class="line none">  398 </div><div id="399" class="line none">  399 /* Same as sockaddr in our case */</div><div id="400" class="line none">  400 struct <a href="net_ip.h.html#400">sockaddr_storage</a> {</div><div id="401" class="line none">  401         <a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#401">ss_family</a>;</div><div id="402" class="line none">  402         char <a href="buf.h.html#89">data</a>[<a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a> - sizeof(<a href="net_ip.h.html#164">sa_family_t</a>)];</div><div id="403" class="line none">  403 };</div><div id="404" class="line none">  404 </div><div id="405" class="line none">  405 /* Socket address struct for UNIX domain sockets */</div><div id="406" class="line none">  406 struct <a href="net_ip.h.html#406">sockaddr_un</a> {</div><div id="407" class="line none">  407         <a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#407">sun_family</a>;    /* AF_UNIX */</div><div id="408" class="line none">  408         char        <a href="net_ip.h.html#408">sun_path</a>[<a href="net_ip.h.html#353">NET_SOCKADDR_MAX_SIZE</a> - sizeof(<a href="net_ip.h.html#164">sa_family_t</a>)];</div><div id="409" class="line none">  409 };</div><div id="410" class="line none">  410 </div><div id="411" class="line none">  411 struct <a href="net_ip.h.html#411">net_addr</a> {</div><div id="412" class="line none">  412         <a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#395">family</a>;</div><div id="413" class="line none">  413         union {</div><div id="414" class="line none">  414                 struct <a href="net_ip.h.html#139">in6_addr</a> <a href="net_ip.h.html#139">in6_addr</a>;</div><div id="415" class="line none">  415                 struct <a href="net_ip.h.html#151">in_addr</a> <a href="net_ip.h.html#151">in_addr</a>;</div><div id="416" class="line none">  416         };</div><div id="417" class="line none">  417 };</div><div id="418" class="line none">  418 </div><div id="419" class="line none">  419 /** A pointer to IPv6 any address (all values zero) */</div><div id="420" class="line none">  420 extern const struct <a href="net_ip.h.html#139">in6_addr</a> in6addr_any;</div><div id="421" class="line none">  421 </div><div id="422" class="line none">  422 /** A pointer to IPv6 loopback address (::1) */</div><div id="423" class="line none">  423 extern const struct <a href="net_ip.h.html#139">in6_addr</a> in6addr_loopback;</div><div id="424" class="line none">  424 </div><div id="425" class="line none">  425 /** @endcond */</div><div id="426" class="line none">  426 </div><div id="427" class="line none">  427 /** IPv6 address initializer */</div><div id="428" class="line none">  428 #define <a href="net_ip.h.html#428">IN6ADDR_ANY_INIT</a> { { { 0, 0, 0, 0, 0, 0, 0, 0, 0, \</div><div id="429" class="line none">  429                                 0, 0, 0, 0, 0, 0, 0 } } }</div><div id="430" class="line none">  430 </div><div id="431" class="line none">  431 /** IPv6 loopback address initializer */</div><div id="432" class="line none">  432 #define <a href="net_ip.h.html#432">IN6ADDR_LOOPBACK_INIT</a> { { { 0, 0, 0, 0, 0, 0, 0, \</div><div id="433" class="line none">  433                                 0, 0, 0, 0, 0, 0, 0, 0, 1 } } }</div><div id="434" class="line none">  434 </div><div id="435" class="line none">  435 /** IPv4 any address */</div><div id="436" class="line none">  436 #define <a href="net_ip.h.html#436">INADDR_ANY</a> 0</div><div id="437" class="line none">  437 </div><div id="438" class="line none">  438 /** IPv4 address initializer */</div><div id="439" class="line none">  439 #define <a href="net_ip.h.html#439">INADDR_ANY_INIT</a> { { { <a href="net_ip.h.html#436">INADDR_ANY</a> } } }</div><div id="440" class="line none">  440 </div><div id="441" class="line none">  441 /** IPv6 loopback address initializer */</div><div id="442" class="line none">  442 #define <a href="net_ip.h.html#442">INADDR_LOOPBACK_INIT</a>  { { { 127, 0, 0, 1 } } }</div><div id="443" class="line none">  443 </div><div id="444" class="line none">  444 /** Max length of the IPv4 address as a string. Defined by POSIX. */</div><div id="445" class="line none">  445 #define <a href="net_ip.h.html#445">INET_ADDRSTRLEN</a> 16</div><div id="446" class="line none">  446 /** Max length of the IPv6 address as a string. Takes into account possible</div><div id="447" class="line none">  447  * mapped IPv4 addresses.</div><div id="448" class="line none">  448  */</div><div id="449" class="line none">  449 #define <a href="net_ip.h.html#449">INET6_ADDRSTRLEN</a> 46</div><div id="450" class="line none">  450 </div><div id="451" class="line none">  451 /** @cond INTERNAL_HIDDEN */</div><div id="452" class="line none">  452 </div><div id="453" class="line none">  453 /* These are for internal usage of the stack */</div><div id="454" class="line none">  454 #define <a href="net_ip.h.html#454">NET_IPV6_ADDR_LEN</a> sizeof("xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx")</div><div id="455" class="line none">  455 #define <a href="net_ip.h.html#455">NET_IPV4_ADDR_LEN</a> sizeof("xxx.xxx.xxx.xxx")</div><div id="456" class="line none">  456 </div><div id="457" class="line none">  457 /** @endcond */</div><div id="458" class="line none">  458 </div><div id="459" class="line none">  459 /** @brief IP Maximum Transfer Unit */</div><div id="460" class="line none">  460 enum <a href="net_ip.h.html#460">net_ip_mtu</a> {</div><div id="461" class="line none">  461         /** IPv6 MTU length. We must be able to receive this size IPv6 packet</div><div id="462" class="line none">  462          * without fragmentation.</div><div id="463" class="line none">  463          */</div><div id="464" class="line none">  464 #if defined(CONFIG_NET_NATIVE_IPV6)</div><div id="465" class="line none">  465         <a href="net_ip.h.html#465">NET_IPV6_MTU</a> = CONFIG_NET_IPV6_MTU,</div><div id="466" class="line none">  466 #else</div><div id="467" class="line none">  467         <a href="net_ip.h.html#465">NET_IPV6_MTU</a> = 1280,</div><div id="468" class="line none">  468 #endif</div><div id="469" class="line none">  469 </div><div id="470" class="line none">  470         /** IPv4 MTU length. We must be able to receive this size IPv4 packet</div><div id="471" class="line none">  471          * without fragmentation.</div><div id="472" class="line none">  472          */</div><div id="473" class="line none">  473         <a href="net_ip.h.html#473">NET_IPV4_MTU</a> = 576,</div><div id="474" class="line none">  474 };</div><div id="475" class="line none">  475 </div><div id="476" class="line none">  476 /** @brief Network packet priority settings described in IEEE 802.1Q Annex I.1 */</div><div id="477" class="line none">  477 enum <a href="net_ip.h.html#477">net_priority</a> {</div><div id="478" class="line none">  478         <a href="net_ip.h.html#478">NET_PRIORITY_BK</a> = 1, /**&lt; Background (lowest)                */</div><div id="479" class="line none">  479         <a href="net_ip.h.html#479">NET_PRIORITY_BE</a> = 0, /**&lt; Best effort (default)              */</div><div id="480" class="line none">  480         <a href="net_ip.h.html#480">NET_PRIORITY_EE</a> = 2, /**&lt; Excellent effort                   */</div><div id="481" class="line none">  481         <a href="net_ip.h.html#481">NET_PRIORITY_CA</a> = 3, /**&lt; Critical applications              */</div><div id="482" class="line none">  482         <a href="net_ip.h.html#482">NET_PRIORITY_VI</a> = 4, /**&lt; Video, &lt; 100 ms latency and jitter */</div><div id="483" class="line none">  483         <a href="net_ip.h.html#483">NET_PRIORITY_VO</a> = 5, /**&lt; Voice, &lt; 10 ms latency and jitter  */</div><div id="484" class="line none">  484         <a href="net_ip.h.html#484">NET_PRIORITY_IC</a> = 6, /**&lt; Internetwork control               */</div><div id="485" class="line none">  485         <a href="net_ip.h.html#485">NET_PRIORITY_NC</a> = 7  /**&lt; Network control (highest)          */</div><div id="486" class="line none">  486 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="487" class="line none">  487 </div><div id="488" class="line none">  488 #define <a href="net_ip.h.html#488">NET_MAX_PRIORITIES</a> 8 /**&lt; How many priority values there are */</div><div id="489" class="line none">  489 </div><div id="490" class="line none">  490 /** @brief IPv6/IPv4 network connection tuple */</div><div id="491" class="line none">  491 struct <a href="net_ip.h.html#491">net_tuple</a> {</div><div id="492" class="line none">  492         struct <a href="net_ip.h.html#411">net_addr</a> *<a href="net_ip.h.html#492">remote_addr</a>;  /**&lt; IPv6/IPv4 remote address */</div><div id="493" class="line none">  493         struct <a href="net_ip.h.html#411">net_addr</a> *<a href="net_ip.h.html#493">local_addr</a>;   /**&lt; IPv6/IPv4 local address  */</div><div id="494" class="line none">  494         uint16_t <a href="net_ip.h.html#494">remote_port</a>;          /**&lt; UDP/TCP remote port      */</div><div id="495" class="line none">  495         uint16_t <a href="net_ip.h.html#495">local_port</a>;           /**&lt; UDP/TCP local port       */</div><div id="496" class="line none">  496         enum <a href="net_ip.h.html#62">net_ip_protocol</a> <a href="net_ip.h.html#496">ip_proto</a>; /**&lt; IP protocol              */</div><div id="497" class="line none">  497 };</div><div id="498" class="line none">  498 </div><div id="499" class="line none">  499 /** @brief What is the current state of the network address */</div><div id="500" class="line none">  500 enum <a href="net_ip.h.html#500">net_addr_state</a> {</div><div id="501" class="line none">  501         <a href="net_ip.h.html#501">NET_ADDR_ANY_STATE</a> = -1, /**&lt; Default (invalid) address type */</div><div id="502" class="line none">  502         <a href="net_ip.h.html#502">NET_ADDR_TENTATIVE</a> = 0,  /**&lt; Tentative address              */</div><div id="503" class="line none">  503         <a href="net_ip.h.html#503">NET_ADDR_PREFERRED</a>,      /**&lt; Preferred address              */</div><div id="504" class="line none">  504         <a href="net_ip.h.html#504">NET_ADDR_DEPRECATED</a>,     /**&lt; Deprecated address             */</div><div id="505" class="line none">  505 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="506" class="line none">  506 </div><div id="507" class="line none">  507 /** @brief How the network address is assigned to network interface */</div><div id="508" class="line none">  508 enum <a href="net_ip.h.html#508">net_addr_type</a> {</div><div id="509" class="line none">  509         /** Default value. This is not a valid value. */</div><div id="510" class="line none">  510         <a href="net_ip.h.html#510">NET_ADDR_ANY</a> = 0,</div><div id="511" class="line none">  511         /** Auto configured address */</div><div id="512" class="line none">  512         <a href="net_ip.h.html#512">NET_ADDR_AUTOCONF</a>,</div><div id="513" class="line none">  513         /** Address is from DHCP */</div><div id="514" class="line none">  514         <a href="net_ip.h.html#514">NET_ADDR_DHCP</a>,</div><div id="515" class="line none">  515         /** Manually set address */</div><div id="516" class="line none">  516         <a href="net_ip.h.html#516">NET_ADDR_MANUAL</a>,</div><div id="517" class="line none">  517         /** Manually set address which is overridable by DHCP */</div><div id="518" class="line none">  518         <a href="net_ip.h.html#518">NET_ADDR_OVERRIDABLE</a>,</div><div id="519" class="line none">  519 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="520" class="line none">  520 </div><div id="521" class="line none">  521 /** @cond INTERNAL_HIDDEN */</div><div id="522" class="line none">  522 </div><div id="523" class="line none">  523 struct <a href="net_ip.h.html#523">net_ipv6_hdr</a> {</div><div id="524" class="line none">  524         uint8_t <a href="net_ip.h.html#524">vtc</a>;</div><div id="525" class="line none">  525         uint8_t <a href="net_ip.h.html#525">tcflow</a>;</div><div id="526" class="line none">  526         uint16_t <a href="net_ip.h.html#526">flow</a>;</div><div id="527" class="line none">  527         uint16_t <a href="buf.h.html#96">len</a>;</div><div id="528" class="line none">  528         uint8_t <a href="net_ip.h.html#528">nexthdr</a>;</div><div id="529" class="line none">  529         uint8_t <a href="net_ip.h.html#529">hop_limit</a>;</div><div id="530" class="line none">  530         uint8_t <a href="net_ip.h.html#530">src</a>[<a href="net_ip.h.html#148">NET_IPV6_ADDR_SIZE</a>];</div><div id="531" class="line none">  531         uint8_t <a href="net_ip.h.html#531">dst</a>[<a href="net_ip.h.html#148">NET_IPV6_ADDR_SIZE</a>];</div><div id="532" class="line none">  532 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="533" class="line none">  533 </div><div id="534" class="line none">  534 struct <a href="net_ip.h.html#534">net_ipv6_frag_hdr</a> {</div><div id="535" class="line none">  535         uint8_t <a href="net_ip.h.html#528">nexthdr</a>;</div><div id="536" class="line none">  536         uint8_t <a href="net_ip.h.html#536">reserved</a>;</div><div id="537" class="line none">  537         uint16_t <a href="buf.h.html#950">offset</a>;</div><div id="538" class="line none">  538         uint32_t <a href="net_ip.h.html#538">id</a>;</div><div id="539" class="line none">  539 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="540" class="line none">  540 </div><div id="541" class="line none">  541 struct <a href="net_ip.h.html#541">net_ipv4_hdr</a> {</div><div id="542" class="line none">  542         uint8_t <a href="net_ip.h.html#542">vhl</a>;</div><div id="543" class="line none">  543         uint8_t <a href="net_ip.h.html#543">tos</a>;</div><div id="544" class="line none">  544         uint16_t <a href="buf.h.html#96">len</a>;</div><div id="545" class="line none">  545         uint8_t <a href="net_ip.h.html#538">id</a>[2];</div><div id="546" class="line none">  546         uint8_t <a href="buf.h.html#950">offset</a>[2];</div><div id="547" class="line none">  547         uint8_t <a href="net_ip.h.html#547">ttl</a>;</div><div id="548" class="line none">  548         uint8_t <a href="net_ip.h.html#548">proto</a>;</div><div id="549" class="line none">  549         uint16_t <a href="net_ip.h.html#549">chksum</a>;</div><div id="550" class="line none">  550         uint8_t <a href="net_ip.h.html#530">src</a>[<a href="net_ip.h.html#161">NET_IPV4_ADDR_SIZE</a>];</div><div id="551" class="line none">  551         uint8_t <a href="net_ip.h.html#531">dst</a>[<a href="net_ip.h.html#161">NET_IPV4_ADDR_SIZE</a>];</div><div id="552" class="line none">  552 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="553" class="line none">  553 </div><div id="554" class="line none">  554 struct <a href="net_ip.h.html#554">net_icmp_hdr</a> {</div><div id="555" class="line none">  555         uint8_t <a href="net_ip.h.html#555">type</a>;</div><div id="556" class="line none">  556         uint8_t <a href="net_ip.h.html#556">code</a>;</div><div id="557" class="line none">  557         uint16_t <a href="net_ip.h.html#549">chksum</a>;</div><div id="558" class="line none">  558 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="559" class="line none">  559 </div><div id="560" class="line none">  560 struct <a href="net_ip.h.html#560">net_udp_hdr</a> {</div><div id="561" class="line none">  561         uint16_t <a href="net_ip.h.html#561">src_port</a>;</div><div id="562" class="line none">  562         uint16_t <a href="net_ip.h.html#562">dst_port</a>;</div><div id="563" class="line none">  563         uint16_t <a href="buf.h.html#96">len</a>;</div><div id="564" class="line none">  564         uint16_t <a href="net_ip.h.html#549">chksum</a>;</div><div id="565" class="line none">  565 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="566" class="line none">  566 </div><div id="567" class="line none">  567 struct <a href="net_ip.h.html#567">net_tcp_hdr</a> {</div><div id="568" class="line none">  568         uint16_t <a href="net_ip.h.html#561">src_port</a>;</div><div id="569" class="line none">  569         uint16_t <a href="net_ip.h.html#562">dst_port</a>;</div><div id="570" class="line none">  570         uint8_t <a href="net_ip.h.html#570">seq</a>[4];</div><div id="571" class="line none">  571         uint8_t <a href="net_ip.h.html#571">ack</a>[4];</div><div id="572" class="line none">  572         uint8_t <a href="buf.h.html#950">offset</a>;</div><div id="573" class="line none">  573         uint8_t <a href="buf.h.html#1015">flags</a>;</div><div id="574" class="line none">  574         uint8_t <a href="net_ip.h.html#574">wnd</a>[2];</div><div id="575" class="line none">  575         uint16_t <a href="net_ip.h.html#549">chksum</a>;</div><div id="576" class="line none">  576         uint8_t <a href="net_ip.h.html#576">urg</a>[2];</div><div id="577" class="line none">  577         uint8_t <a href="net_ip.h.html#577">optdata</a>[0];</div><div id="578" class="line none">  578 } <a href="net_ip.h.html#486">__packed</a>;</div><div id="579" class="line none">  579 </div><div id="580" class="line none">  580 static inline const char *<a href="net_ip.h.html#580">net_addr_type2str</a>(enum <a href="net_ip.h.html#508">net_addr_type</a> <a href="net_ip.h.html#555">type</a>)</div><div id="581" class="line none">  581 {</div><div id="582" class="line none">  582         switch (<a href="net_ip.h.html#555">type</a>) {</div><div id="583" class="line none">  583         case <a href="net_ip.h.html#512">NET_ADDR_AUTOCONF</a>:</div><div id="584" class="line none">  584                 return "AUTO";</div><div id="585" class="line none">  585         case <a href="net_ip.h.html#514">NET_ADDR_DHCP</a>:</div><div id="586" class="line none">  586                 return "DHCP";</div><div id="587" class="line none">  587         case <a href="net_ip.h.html#516">NET_ADDR_MANUAL</a>:</div><div id="588" class="line none">  588                 return "MANUAL";</div><div id="589" class="line none">  589         case <a href="net_ip.h.html#518">NET_ADDR_OVERRIDABLE</a>:</div><div id="590" class="line none">  590                 return "OVERRIDE";</div><div id="591" class="line none">  591         case <a href="net_ip.h.html#510">NET_ADDR_ANY</a>:</div><div id="592" class="line none">  592         default:</div><div id="593" class="line none">  593                 break;</div><div id="594" class="line none">  594         }</div><div id="595" class="line none">  595 </div><div id="596" class="line none">  596         return "&lt;unknown&gt;";</div><div id="597" class="line none">  597 }</div><div id="598" class="line none">  598 </div><div id="599" class="line none">  599 /* IPv6 extension headers types */</div><div id="600" class="line none">  600 #define <a href="net_ip.h.html#600">NET_IPV6_NEXTHDR_HBHO</a>        0</div><div id="601" class="line none">  601 #define <a href="net_ip.h.html#601">NET_IPV6_NEXTHDR_DESTO</a>       60</div><div id="602" class="line none">  602 #define <a href="net_ip.h.html#602">NET_IPV6_NEXTHDR_ROUTING</a>     43</div><div id="603" class="line none">  603 #define <a href="net_ip.h.html#603">NET_IPV6_NEXTHDR_FRAG</a>        44</div><div id="604" class="line none">  604 #define <a href="net_ip.h.html#604">NET_IPV6_NEXTHDR_NONE</a>        59</div><div id="605" class="line none">  605 </div><div id="606" class="line none">  606 /**</div><div id="607" class="line none">  607  * This 2 unions are here temporarily, as long as net_context.h will</div><div id="608" class="line none">  608  * be still public and not part of the core only.</div><div id="609" class="line none">  609  */</div><div id="610" class="line none">  610 union <a href="net_ip.h.html#610">net_ip_header</a> {</div><div id="611" class="line none">  611         struct <a href="net_ip.h.html#541">net_ipv4_hdr</a> *<a href="net_ip.h.html#611">ipv4</a>;</div><div id="612" class="line none">  612         struct <a href="net_ip.h.html#523">net_ipv6_hdr</a> *<a href="net_ip.h.html#612">ipv6</a>;</div><div id="613" class="line none">  613 };</div><div id="614" class="line none">  614 </div><div id="615" class="line none">  615 union <a href="net_ip.h.html#615">net_proto_header</a> {</div><div id="616" class="line none">  616         struct <a href="net_ip.h.html#560">net_udp_hdr</a> *<a href="net_ip.h.html#616">udp</a>;</div><div id="617" class="line none">  617         struct <a href="net_ip.h.html#567">net_tcp_hdr</a> *<a href="net_ip.h.html#617">tcp</a>;</div><div id="618" class="line none">  618 };</div><div id="619" class="line none">  619 </div><div id="620" class="line none">  620 #define <a href="net_ip.h.html#620">NET_UDPH_LEN</a>    8                       /* Size of UDP header */</div><div id="621" class="line none">  621 #define <a href="net_ip.h.html#621">NET_TCPH_LEN</a>    20                      /* Size of TCP header */</div><div id="622" class="line none">  622 #define <a href="net_ip.h.html#622">NET_ICMPH_LEN</a>   4                       /* Size of ICMP header */</div><div id="623" class="line none">  623 </div><div id="624" class="line none">  624 #define <a href="net_ip.h.html#624">NET_IPV6H_LEN</a>      40                   /* Size of IPv6 header */</div><div id="625" class="line none">  625 #define <a href="net_ip.h.html#625">NET_ICMPV6H_LEN</a>    <a href="net_ip.h.html#622">NET_ICMPH_LEN</a>        /* Size of ICMPv6 header */</div><div id="626" class="line none">  626 #define <a href="net_ip.h.html#626">NET_IPV6UDPH_LEN</a>   (<a href="net_ip.h.html#620">NET_UDPH_LEN</a> + <a href="net_ip.h.html#624">NET_IPV6H_LEN</a>) /* IPv6 + UDP */</div><div id="627" class="line none">  627 #define <a href="net_ip.h.html#627">NET_IPV6TCPH_LEN</a>   (<a href="net_ip.h.html#621">NET_TCPH_LEN</a> + <a href="net_ip.h.html#624">NET_IPV6H_LEN</a>) /* IPv6 + TCP */</div><div id="628" class="line none">  628 #define <a href="net_ip.h.html#628">NET_IPV6ICMPH_LEN</a>  (<a href="net_ip.h.html#624">NET_IPV6H_LEN</a> + <a href="net_ip.h.html#622">NET_ICMPH_LEN</a>) /* ICMPv6 + IPv6 */</div><div id="629" class="line none">  629 #define <a href="net_ip.h.html#629">NET_IPV6_FRAGH_LEN</a> 8</div><div id="630" class="line none">  630 </div><div id="631" class="line none">  631 #define <a href="net_ip.h.html#631">NET_IPV4H_LEN</a>      20                   /* Size of IPv4 header */</div><div id="632" class="line none">  632 #define <a href="net_ip.h.html#632">NET_ICMPV4H_LEN</a>    <a href="net_ip.h.html#622">NET_ICMPH_LEN</a>        /* Size of ICMPv4 header */</div><div id="633" class="line none">  633 #define <a href="net_ip.h.html#633">NET_IPV4UDPH_LEN</a>   (<a href="net_ip.h.html#620">NET_UDPH_LEN</a> + <a href="net_ip.h.html#631">NET_IPV4H_LEN</a>) /* IPv4 + UDP */</div><div id="634" class="line none">  634 #define <a href="net_ip.h.html#634">NET_IPV4TCPH_LEN</a>   (<a href="net_ip.h.html#621">NET_TCPH_LEN</a> + <a href="net_ip.h.html#631">NET_IPV4H_LEN</a>) /* IPv4 + TCP */</div><div id="635" class="line none">  635 #define <a href="net_ip.h.html#635">NET_IPV4ICMPH_LEN</a>  (<a href="net_ip.h.html#631">NET_IPV4H_LEN</a> + <a href="net_ip.h.html#622">NET_ICMPH_LEN</a>) /* ICMPv4 + IPv4 */</div><div id="636" class="line none">  636 </div><div id="637" class="line none">  637 #define <a href="net_ip.h.html#637">NET_IPV6H_LENGTH_OFFSET</a>         0x04    /* Offset of the Length field in the IPv6 header */</div><div id="638" class="line none">  638 </div><div id="639" class="line none">  639 #define <a href="net_ip.h.html#639">NET_IPV6_FRAGH_OFFSET_MASK</a>      0xfff8  /* Mask for the 13-bit Fragment Offset field */</div><div id="640" class="line none">  640 #define <a href="net_ip.h.html#640">NET_IPV4_FRAGH_OFFSET_MASK</a>      0x1fff  /* Mask for the 13-bit Fragment Offset field */</div><div id="641" class="line none">  641 #define <a href="net_ip.h.html#641">NET_IPV4_MORE_FRAG_MASK</a>         0x2000  /* Mask for the 1-bit More Fragments field */</div><div id="642" class="line none">  642 #define <a href="net_ip.h.html#642">NET_IPV4_DO_NOT_FRAG_MASK</a>       0x4000  /* Mask for the 1-bit Do Not Fragment field */</div><div id="643" class="line none">  643 </div><div id="644" class="line none">  644 /** @endcond */</div><div id="645" class="line none">  645 </div><div id="646" class="line none">  646 /**</div><div id="647" class="line none">  647  * @brief Check if the IPv6 address is a loopback address (::1).</div><div id="648" class="line none">  648  *</div><div id="649" class="line none">  649  * @param addr IPv6 address</div><div id="650" class="line none">  650  *</div><div id="651" class="line none">  651  * @return True if address is a loopback address, False otherwise.</div><div id="652" class="line none">  652  */</div><div id="653" class="line none">  653 static inline bool <a href="net_ip.h.html#653">net_ipv6_is_addr_loopback</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="654" class="line none">  654 {</div><div id="655" class="line none">  655         return UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[0]) == 0 &amp;&amp;</div><div id="656" class="line none">  656                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[1]) == 0 &amp;&amp;</div><div id="657" class="line none">  657                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[2]) == 0 &amp;&amp;</div><div id="658" class="line none">  658                 <a href="net_ip.h.html#104">ntohl</a>(UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[3])) == 1;</div><div id="659" class="line none">  659 }</div><div id="660" class="line none">  660 </div><div id="661" class="line none">  661 /**</div><div id="662" class="line none">  662  * @brief Check if the IPv6 address is a multicast address.</div><div id="663" class="line none">  663  *</div><div id="664" class="line none">  664  * @param addr IPv6 address</div><div id="665" class="line none">  665  *</div><div id="666" class="line none">  666  * @return True if address is multicast address, False otherwise.</div><div id="667" class="line none">  667  */</div><div id="668" class="line none">  668 static inline bool <a href="net_ip.h.html#668">net_ipv6_is_addr_mcast</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="669" class="line none">  669 {</div><div id="670" class="line none">  670         return addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[0] == 0xFF;</div><div id="671" class="line none">  671 }</div><div id="672" class="line none">  672 </div><div id="673" class="line none">  673 struct net_if;</div><div id="674" class="line none">  674 struct net_if_config;</div><div id="675" class="line none">  675 </div><div id="676" class="line none">  676 extern struct net_if_addr *net_if_ipv6_addr_lookup(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr,</div><div id="677" class="line none">  677                                                    struct net_if **iface);</div><div id="678" class="line none">  678 </div><div id="679" class="line none">  679 /**</div><div id="680" class="line none">  680  * @brief Check if IPv6 address is found in one of the network interfaces.</div><div id="681" class="line none">  681  *</div><div id="682" class="line none">  682  * @param addr IPv6 address</div><div id="683" class="line none">  683  *</div><div id="684" class="line none">  684  * @return True if address was found, False otherwise.</div><div id="685" class="line none">  685  */</div><div id="686" class="line none">  686 static inline bool <a href="net_ip.h.html#686">net_ipv6_is_my_addr</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="687" class="line none">  687 {</div><div id="688" class="line none">  688         return net_if_ipv6_addr_lookup(addr, NULL) != NULL;</div><div id="689" class="line none">  689 }</div><div id="690" class="line none">  690 </div><div id="691" class="line none">  691 extern struct net_if_mcast_addr *net_if_ipv6_maddr_lookup(</div><div id="692" class="line none">  692         const struct <a href="net_ip.h.html#139">in6_addr</a> *addr, struct net_if **iface);</div><div id="693" class="line none">  693 </div><div id="694" class="line none">  694 /**</div><div id="695" class="line none">  695  * @brief Check if IPv6 multicast address is found in one of the</div><div id="696" class="line none">  696  * network interfaces.</div><div id="697" class="line none">  697  *</div><div id="698" class="line none">  698  * @param maddr Multicast IPv6 address</div><div id="699" class="line none">  699  *</div><div id="700" class="line none">  700  * @return True if address was found, False otherwise.</div><div id="701" class="line none">  701  */</div><div id="702" class="line none">  702 static inline bool <a href="net_ip.h.html#702">net_ipv6_is_my_maddr</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *maddr)</div><div id="703" class="line none">  703 {</div><div id="704" class="line none">  704         return net_if_ipv6_maddr_lookup(maddr, NULL) != NULL;</div><div id="705" class="line none">  705 }</div><div id="706" class="line none">  706 </div><div id="707" class="line none">  707 /**</div><div id="708" class="line none">  708  * @brief Check if two IPv6 addresses are same when compared after prefix mask.</div><div id="709" class="line none">  709  *</div><div id="710" class="line none">  710  * @param addr1 First IPv6 address.</div><div id="711" class="line none">  711  * @param addr2 Second IPv6 address.</div><div id="712" class="line none">  712  * @param length Prefix length (max length is 128).</div><div id="713" class="line none">  713  *</div><div id="714" class="line none">  714  * @return True if IPv6 prefixes are the same, False otherwise.</div><div id="715" class="line none">  715  */</div><div id="716" class="line none">  716 static inline bool <a href="net_ip.h.html#716">net_ipv6_is_prefix</a>(const uint8_t *addr1,</div><div id="717" class="line none">  717                                       const uint8_t *addr2,</div><div id="718" class="line none">  718                                       uint8_t length)</div><div id="719" class="line none">  719 {</div><div id="720" class="line none">  720         uint8_t bits = 128 - length;</div><div id="721" class="line none">  721         uint8_t bytes = length / 8U;</div><div id="722" class="line none">  722         uint8_t remain = bits % 8;</div><div id="723" class="line none">  723         uint8_t mask;</div><div id="724" class="line none">  724 </div><div id="725" class="line none">  725         if (length &gt; 128) {</div><div id="726" class="line none">  726                 return false;</div><div id="727" class="line none">  727         }</div><div id="728" class="line none">  728 </div><div id="729" class="line none">  729         if (memcmp(addr1, addr2, bytes)) {</div><div id="730" class="line none">  730                 return false;</div><div id="731" class="line none">  731         }</div><div id="732" class="line none">  732 </div><div id="733" class="line none">  733         if (!remain) {</div><div id="734" class="line none">  734                 /* No remaining bits, the prefixes are the same as first</div><div id="735" class="line none">  735                  * bytes are the same.</div><div id="736" class="line none">  736                  */</div><div id="737" class="line none">  737                 return true;</div><div id="738" class="line none">  738         }</div><div id="739" class="line none">  739 </div><div id="740" class="line none">  740         /* Create a mask that has remaining most significant bits set */</div><div id="741" class="line none">  741         mask = (uint8_t)((0xff &lt;&lt; (8 - remain)) ^ 0xff) &lt;&lt; remain;</div><div id="742" class="line none">  742 </div><div id="743" class="line none">  743         return (addr1[bytes] &amp; mask) == (addr2[bytes] &amp; mask);</div><div id="744" class="line none">  744 }</div><div id="745" class="line none">  745 </div><div id="746" class="line none">  746 /**</div><div id="747" class="line none">  747  * @brief Check if the IPv4 address is a loopback address (127.0.0.0/8).</div><div id="748" class="line none">  748  *</div><div id="749" class="line none">  749  * @param addr IPv4 address</div><div id="750" class="line none">  750  *</div><div id="751" class="line none">  751  * @return True if address is a loopback address, False otherwise.</div><div id="752" class="line none">  752  */</div><div id="753" class="line none">  753 static inline bool <a href="net_ip.h.html#753">net_ipv4_is_addr_loopback</a>(struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="754" class="line none">  754 {</div><div id="755" class="line none">  755         return addr-&gt;<a href="net_ip.h.html#153">s4_addr</a>[0] == 127U;</div><div id="756" class="line none">  756 }</div><div id="757" class="line none">  757 </div><div id="758" class="line none">  758 /**</div><div id="759" class="line none">  759  *  @brief Check if the IPv4 address is unspecified (all bits zero)</div><div id="760" class="line none">  760  *</div><div id="761" class="line none">  761  *  @param addr IPv4 address.</div><div id="762" class="line none">  762  *</div><div id="763" class="line none">  763  *  @return True if the address is unspecified, false otherwise.</div><div id="764" class="line none">  764  */</div><div id="765" class="line none">  765 static inline bool <a href="net_ip.h.html#765">net_ipv4_is_addr_unspecified</a>(const struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="766" class="line none">  766 {</div><div id="767" class="line none">  767         return UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#156">s_addr</a>) == 0;</div><div id="768" class="line none">  768 }</div><div id="769" class="line none">  769 </div><div id="770" class="line none">  770 /**</div><div id="771" class="line none">  771  * @brief Check if the IPv4 address is a multicast address.</div><div id="772" class="line none">  772  *</div><div id="773" class="line none">  773  * @param addr IPv4 address</div><div id="774" class="line none">  774  *</div><div id="775" class="line none">  775  * @return True if address is multicast address, False otherwise.</div><div id="776" class="line none">  776  */</div><div id="777" class="line none">  777 static inline bool <a href="net_ip.h.html#777">net_ipv4_is_addr_mcast</a>(const struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="778" class="line none">  778 {</div><div id="779" class="line none">  779         return (<a href="net_ip.h.html#104">ntohl</a>(UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#156">s_addr</a>)) &amp; 0xF0000000) == 0xE0000000;</div><div id="780" class="line none">  780 }</div><div id="781" class="line none">  781 </div><div id="782" class="line none">  782 /**</div><div id="783" class="line none">  783  * @brief Check if the given IPv4 address is a link local address.</div><div id="784" class="line none">  784  *</div><div id="785" class="line none">  785  * @param addr A valid pointer on an IPv4 address</div><div id="786" class="line none">  786  *</div><div id="787" class="line none">  787  * @return True if it is, false otherwise.</div><div id="788" class="line none">  788  */</div><div id="789" class="line none">  789 static inline bool <a href="net_ip.h.html#789">net_ipv4_is_ll_addr</a>(const struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="790" class="line none">  790 {</div><div id="791" class="line none">  791         return (<a href="net_ip.h.html#104">ntohl</a>(UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#156">s_addr</a>)) &amp; 0xFFFF0000) == 0xA9FE0000;</div><div id="792" class="line none">  792 }</div><div id="793" class="line none">  793 </div><div id="794" class="line none">  794 /**</div><div id="795" class="line none">  795  * @brief Check if the given IPv4 address is from a private address range.</div><div id="796" class="line none">  796  *</div><div id="797" class="line none">  797  * See https://en.wikipedia.org/wiki/Reserved_IP_addresses for details.</div><div id="798" class="line none">  798  *</div><div id="799" class="line none">  799  * @param addr A valid pointer on an IPv4 address</div><div id="800" class="line none">  800  *</div><div id="801" class="line none">  801  * @return True if it is, false otherwise.</div><div id="802" class="line none">  802  */</div><div id="803" class="line none">  803 static inline bool <a href="net_ip.h.html#803">net_ipv4_is_private_addr</a>(const struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="804" class="line none">  804 {</div><div id="805" class="line none">  805         uint32_t masked_24, masked_16, masked_12, masked_10, masked_8;</div><div id="806" class="line none">  806 </div><div id="807" class="line none">  807         masked_24 = <a href="net_ip.h.html#104">ntohl</a>(UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#156">s_addr</a>)) &amp; 0xFFFFFF00;</div><div id="808" class="line none">  808         masked_16 = masked_24 &amp; 0xFFFF0000;</div><div id="809" class="line none">  809         masked_12 = masked_24 &amp; 0xFFF00000;</div><div id="810" class="line none">  810         masked_10 = masked_24 &amp; 0xFFC00000;</div><div id="811" class="line none">  811         masked_8 = masked_24 &amp; 0xFF000000;</div><div id="812" class="line none">  812 </div><div id="813" class="line none">  813         return masked_8  == 0x0A000000 || /* 10.0.0.0/8      */</div><div id="814" class="line none">  814                masked_10 == 0x64400000 || /* 100.64.0.0/10   */</div><div id="815" class="line none">  815                masked_12 == 0xAC100000 || /* 172.16.0.0/12   */</div><div id="816" class="line none">  816                masked_16 == 0xC0A80000 || /* 192.168.0.0/16  */</div><div id="817" class="line none">  817                masked_24 == 0xC0000200 || /* 192.0.2.0/24    */</div><div id="818" class="line none">  818                masked_24 == 0xC0336400 || /* 192.51.100.0/24 */</div><div id="819" class="line none">  819                masked_24 == 0xCB007100;   /* 203.0.113.0/24  */</div><div id="820" class="line none">  820 }</div><div id="821" class="line none">  821 </div><div id="822" class="line none">  822 /**</div><div id="823" class="line none">  823  *  @brief Copy an IPv4 or IPv6 address</div><div id="824" class="line none">  824  *</div><div id="825" class="line none">  825  *  @param dest Destination IP address.</div><div id="826" class="line none">  826  *  @param src Source IP address.</div><div id="827" class="line none">  827  *</div><div id="828" class="line none">  828  *  @return Destination address.</div><div id="829" class="line none">  829  */</div><div id="830" class="line none">  830 #define <a href="net_ip.h.html#830">net_ipaddr_copy</a>(dest, <a href="net_ip.h.html#530">src</a>) \</div><div id="831" class="line none">  831         UNALIGNED_PUT(UNALIGNED_GET(<a href="net_ip.h.html#530">src</a>), dest)</div><div id="832" class="line none">  832 </div><div id="833" class="line none">  833 /**</div><div id="834" class="line none">  834  *  @brief Copy an IPv4 address raw buffer</div><div id="835" class="line none">  835  *</div><div id="836" class="line none">  836  *  @param dest Destination IP address.</div><div id="837" class="line none">  837  *  @param src Source IP address.</div><div id="838" class="line none">  838  */</div><div id="839" class="line none">  839 static inline void <a href="net_ip.h.html#839">net_ipv4_addr_copy_raw</a>(uint8_t *dest,</div><div id="840" class="line none">  840                                           const uint8_t *<a href="net_ip.h.html#530">src</a>)</div><div id="841" class="line none">  841 {</div><div id="842" class="line none">  842         <a href="net_ip.h.html#830">net_ipaddr_copy</a>((struct <a href="net_ip.h.html#151">in_addr</a> *)dest, (const struct <a href="net_ip.h.html#151">in_addr</a> *)<a href="net_ip.h.html#530">src</a>);</div><div id="843" class="line none">  843 }</div><div id="844" class="line none">  844 </div><div id="845" class="line none">  845 /**</div><div id="846" class="line none">  846  *  @brief Copy an IPv6 address raw buffer</div><div id="847" class="line none">  847  *</div><div id="848" class="line none">  848  *  @param dest Destination IP address.</div><div id="849" class="line none">  849  *  @param src Source IP address.</div><div id="850" class="line none">  850  */</div><div id="851" class="line none">  851 static inline void <a href="net_ip.h.html#851">net_ipv6_addr_copy_raw</a>(uint8_t *dest,</div><div id="852" class="line none">  852                                           const uint8_t *<a href="net_ip.h.html#530">src</a>)</div><div id="853" class="line none">  853 {</div><div id="854" class="line none">  854         memcpy(dest, <a href="net_ip.h.html#530">src</a>, sizeof(struct <a href="net_ip.h.html#139">in6_addr</a>));</div><div id="855" class="line none">  855 }</div><div id="856" class="line none">  856 </div><div id="857" class="line none">  857 /**</div><div id="858" class="line none">  858  *  @brief Compare two IPv4 addresses</div><div id="859" class="line none">  859  *</div><div id="860" class="line none">  860  *  @param addr1 Pointer to IPv4 address.</div><div id="861" class="line none">  861  *  @param addr2 Pointer to IPv4 address.</div><div id="862" class="line none">  862  *</div><div id="863" class="line none">  863  *  @return True if the addresses are the same, false otherwise.</div><div id="864" class="line none">  864  */</div><div id="865" class="line none">  865 static inline bool <a href="net_ip.h.html#865">net_ipv4_addr_cmp</a>(const struct <a href="net_ip.h.html#151">in_addr</a> *addr1,</div><div id="866" class="line none">  866                                      const struct <a href="net_ip.h.html#151">in_addr</a> *addr2)</div><div id="867" class="line none">  867 {</div><div id="868" class="line none">  868         return UNALIGNED_GET(&amp;addr1-&gt;<a href="net_ip.h.html#156">s_addr</a>) == UNALIGNED_GET(&amp;addr2-&gt;<a href="net_ip.h.html#156">s_addr</a>);</div><div id="869" class="line none">  869 }</div><div id="870" class="line none">  870 </div><div id="871" class="line none">  871 /**</div><div id="872" class="line none">  872  *  @brief Compare two raw IPv4 address buffers</div><div id="873" class="line none">  873  *</div><div id="874" class="line none">  874  *  @param addr1 Pointer to IPv4 address buffer.</div><div id="875" class="line none">  875  *  @param addr2 Pointer to IPv4 address buffer.</div><div id="876" class="line none">  876  *</div><div id="877" class="line none">  877  *  @return True if the addresses are the same, false otherwise.</div><div id="878" class="line none">  878  */</div><div id="879" class="line none">  879 static inline bool <a href="net_ip.h.html#879">net_ipv4_addr_cmp_raw</a>(const uint8_t *addr1,</div><div id="880" class="line none">  880                                          const uint8_t *addr2)</div><div id="881" class="line none">  881 {</div><div id="882" class="line none">  882         return <a href="net_ip.h.html#865">net_ipv4_addr_cmp</a>((const struct <a href="net_ip.h.html#151">in_addr</a> *)addr1,</div><div id="883" class="line none">  883                                  (const struct <a href="net_ip.h.html#151">in_addr</a> *)addr2);</div><div id="884" class="line none">  884 }</div><div id="885" class="line none">  885 </div><div id="886" class="line none">  886 /**</div><div id="887" class="line none">  887  *  @brief Compare two IPv6 addresses</div><div id="888" class="line none">  888  *</div><div id="889" class="line none">  889  *  @param addr1 Pointer to IPv6 address.</div><div id="890" class="line none">  890  *  @param addr2 Pointer to IPv6 address.</div><div id="891" class="line none">  891  *</div><div id="892" class="line none">  892  *  @return True if the addresses are the same, false otherwise.</div><div id="893" class="line none">  893  */</div><div id="894" class="line none">  894 static inline bool <a href="net_ip.h.html#894">net_ipv6_addr_cmp</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr1,</div><div id="895" class="line none">  895                                      const struct <a href="net_ip.h.html#139">in6_addr</a> *addr2)</div><div id="896" class="line none">  896 {</div><div id="897" class="line none">  897         return !memcmp(addr1, addr2, sizeof(struct <a href="net_ip.h.html#139">in6_addr</a>));</div><div id="898" class="line none">  898 }</div><div id="899" class="line none">  899 </div><div id="900" class="line none">  900 /**</div><div id="901" class="line none">  901  *  @brief Compare two raw IPv6 address buffers</div><div id="902" class="line none">  902  *</div><div id="903" class="line none">  903  *  @param addr1 Pointer to IPv6 address buffer.</div><div id="904" class="line none">  904  *  @param addr2 Pointer to IPv6 address buffer.</div><div id="905" class="line none">  905  *</div><div id="906" class="line none">  906  *  @return True if the addresses are the same, false otherwise.</div><div id="907" class="line none">  907  */</div><div id="908" class="line none">  908 static inline bool <a href="net_ip.h.html#908">net_ipv6_addr_cmp_raw</a>(const uint8_t *addr1,</div><div id="909" class="line none">  909                                          const uint8_t *addr2)</div><div id="910" class="line none">  910 {</div><div id="911" class="line none">  911         return <a href="net_ip.h.html#894">net_ipv6_addr_cmp</a>((const struct <a href="net_ip.h.html#139">in6_addr</a> *)addr1,</div><div id="912" class="line none">  912                                  (const struct <a href="net_ip.h.html#139">in6_addr</a> *)addr2);</div><div id="913" class="line none">  913 }</div><div id="914" class="line none">  914 </div><div id="915" class="line none">  915 /**</div><div id="916" class="line none">  916  * @brief Check if the given IPv6 address is a link local address.</div><div id="917" class="line none">  917  *</div><div id="918" class="line none">  918  * @param addr A valid pointer on an IPv6 address</div><div id="919" class="line none">  919  *</div><div id="920" class="line none">  920  * @return True if it is, false otherwise.</div><div id="921" class="line none">  921  */</div><div id="922" class="line none">  922 static inline bool <a href="net_ip.h.html#922">net_ipv6_is_ll_addr</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="923" class="line none">  923 {</div><div id="924" class="line none">  924         return UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[0]) == <a href="net_ip.h.html#120">htons</a>(0xFE80);</div><div id="925" class="line none">  925 }</div><div id="926" class="line none">  926 </div><div id="927" class="line none">  927 /**</div><div id="928" class="line none">  928  * @brief Check if the given IPv6 address is a site local address.</div><div id="929" class="line none">  929  *</div><div id="930" class="line none">  930  * @param addr A valid pointer on an IPv6 address</div><div id="931" class="line none">  931  *</div><div id="932" class="line none">  932  * @return True if it is, false otherwise.</div><div id="933" class="line none">  933  */</div><div id="934" class="line none">  934 static inline bool <a href="net_ip.h.html#934">net_ipv6_is_sl_addr</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="935" class="line none">  935 {</div><div id="936" class="line none">  936         return UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[0]) == <a href="net_ip.h.html#120">htons</a>(0xFEC0);</div><div id="937" class="line none">  937 }</div><div id="938" class="line none">  938 </div><div id="939" class="line none">  939 </div><div id="940" class="line none">  940 /**</div><div id="941" class="line none">  941  * @brief Check if the given IPv6 address is a unique local address.</div><div id="942" class="line none">  942  *</div><div id="943" class="line none">  943  * @param addr A valid pointer on an IPv6 address</div><div id="944" class="line none">  944  *</div><div id="945" class="line none">  945  * @return True if it is, false otherwise.</div><div id="946" class="line none">  946  */</div><div id="947" class="line none">  947 static inline bool <a href="net_ip.h.html#947">net_ipv6_is_ula_addr</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="948" class="line none">  948 {</div><div id="949" class="line none">  949         return addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[0] == 0xFD;</div><div id="950" class="line none">  950 }</div><div id="951" class="line none">  951 </div><div id="952" class="line none">  952 /**</div><div id="953" class="line none">  953  * @brief Check if the given IPv6 address is a global address.</div><div id="954" class="line none">  954  *</div><div id="955" class="line none">  955  * @param addr A valid pointer on an IPv6 address</div><div id="956" class="line none">  956  *</div><div id="957" class="line none">  957  * @return True if it is, false otherwise.</div><div id="958" class="line none">  958  */</div><div id="959" class="line none">  959 static inline bool <a href="net_ip.h.html#959">net_ipv6_is_global_addr</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="960" class="line none">  960 {</div><div id="961" class="line none">  961         return (addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[0] &amp; 0xE0) == 0x20;</div><div id="962" class="line none">  962 }</div><div id="963" class="line none">  963 </div><div id="964" class="line none">  964 /**</div><div id="965" class="line none">  965  * @brief Check if the given IPv6 address is from a private/local address range.</div><div id="966" class="line none">  966  *</div><div id="967" class="line none">  967  * See https://en.wikipedia.org/wiki/Reserved_IP_addresses for details.</div><div id="968" class="line none">  968  *</div><div id="969" class="line none">  969  * @param addr A valid pointer on an IPv6 address</div><div id="970" class="line none">  970  *</div><div id="971" class="line none">  971  * @return True if it is, false otherwise.</div><div id="972" class="line none">  972  */</div><div id="973" class="line none">  973 static inline bool <a href="net_ip.h.html#973">net_ipv6_is_private_addr</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="974" class="line none">  974 {</div><div id="975" class="line none">  975         uint32_t masked_32, masked_7;</div><div id="976" class="line none">  976 </div><div id="977" class="line none">  977         masked_32 = <a href="net_ip.h.html#104">ntohl</a>(UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[0]));</div><div id="978" class="line none">  978         masked_7 = masked_32 &amp; 0xfc000000;</div><div id="979" class="line none">  979 </div><div id="980" class="line none">  980         return masked_32 == 0x20010db8 || /* 2001:db8::/32 */</div><div id="981" class="line none">  981                masked_7  == 0xfc000000;   /* fc00::/7      */</div><div id="982" class="line none">  982 }</div><div id="983" class="line none">  983 </div><div id="984" class="line none">  984 /**</div><div id="985" class="line none">  985  * @brief Return pointer to any (all bits zeros) IPv6 address.</div><div id="986" class="line none">  986  *</div><div id="987" class="line none">  987  * @return Any IPv6 address.</div><div id="988" class="line none">  988  */</div><div id="989" class="line none">  989 const struct <a href="net_ip.h.html#139">in6_addr</a> *net_ipv6_unspecified_address(void);</div><div id="990" class="line none">  990 </div><div id="991" class="line none">  991 /**</div><div id="992" class="line none">  992  * @brief Return pointer to any (all bits zeros) IPv4 address.</div><div id="993" class="line none">  993  *</div><div id="994" class="line none">  994  * @return Any IPv4 address.</div><div id="995" class="line none">  995  */</div><div id="996" class="line none">  996 const struct <a href="net_ip.h.html#151">in_addr</a> *net_ipv4_unspecified_address(void);</div><div id="997" class="line none">  997 </div><div id="998" class="line none">  998 /**</div><div id="999" class="line none">  999  * @brief Return pointer to broadcast (all bits ones) IPv4 address.</div><div id="1000" class="line none"> 1000  *</div><div id="1001" class="line none"> 1001  * @return Broadcast IPv4 address.</div><div id="1002" class="line none"> 1002  */</div><div id="1003" class="line none"> 1003 const struct <a href="net_ip.h.html#151">in_addr</a> *net_ipv4_broadcast_address(void);</div><div id="1004" class="line none"> 1004 </div><div id="1005" class="line none"> 1005 struct net_if;</div><div id="1006" class="line none"> 1006 extern bool net_if_ipv4_addr_mask_cmp(struct net_if *iface,</div><div id="1007" class="line none"> 1007                                       const struct <a href="net_ip.h.html#151">in_addr</a> *addr);</div><div id="1008" class="line none"> 1008 </div><div id="1009" class="line none"> 1009 /**</div><div id="1010" class="line none"> 1010  * @brief Check if the given address belongs to same subnet that</div><div id="1011" class="line none"> 1011  * has been configured for the interface.</div><div id="1012" class="line none"> 1012  *</div><div id="1013" class="line none"> 1013  * @param iface A valid pointer on an interface</div><div id="1014" class="line none"> 1014  * @param addr IPv4 address</div><div id="1015" class="line none"> 1015  *</div><div id="1016" class="line none"> 1016  * @return True if address is in same subnet, false otherwise.</div><div id="1017" class="line none"> 1017  */</div><div id="1018" class="line none"> 1018 static inline bool <a href="net_ip.h.html#1018">net_ipv4_addr_mask_cmp</a>(struct net_if *iface,</div><div id="1019" class="line none"> 1019                                           const struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="1020" class="line none"> 1020 {</div><div id="1021" class="line none"> 1021         return net_if_ipv4_addr_mask_cmp(iface, addr);</div><div id="1022" class="line none"> 1022 }</div><div id="1023" class="line none"> 1023 </div><div id="1024" class="line none"> 1024 extern bool net_if_ipv4_is_addr_bcast(struct net_if *iface,</div><div id="1025" class="line none"> 1025                                       const struct <a href="net_ip.h.html#151">in_addr</a> *addr);</div><div id="1026" class="line none"> 1026 </div><div id="1027" class="line none"> 1027 /**</div><div id="1028" class="line none"> 1028  * @brief Check if the given IPv4 address is a broadcast address.</div><div id="1029" class="line none"> 1029  *</div><div id="1030" class="line none"> 1030  * @param iface Interface to use. Must be a valid pointer to an interface.</div><div id="1031" class="line none"> 1031  * @param addr IPv4 address</div><div id="1032" class="line none"> 1032  *</div><div id="1033" class="line none"> 1033  * @return True if address is a broadcast address, false otherwise.</div><div id="1034" class="line none"> 1034  */</div><div id="1035" class="line none"> 1035 #if defined(CONFIG_NET_NATIVE_IPV4)</div><div id="1036" class="line none"> 1036 static inline bool <a href="net_ip.h.html#1036">net_ipv4_is_addr_bcast</a>(struct net_if *iface,</div><div id="1037" class="line none"> 1037                                           const struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="1038" class="line none"> 1038 {</div><div id="1039" class="line none"> 1039         if (<a href="net_ip.h.html#865">net_ipv4_addr_cmp</a>(addr, net_ipv4_broadcast_address())) {</div><div id="1040" class="line none"> 1040                 return true;</div><div id="1041" class="line none"> 1041         }</div><div id="1042" class="line none"> 1042 </div><div id="1043" class="line none"> 1043         return net_if_ipv4_is_addr_bcast(iface, addr);</div><div id="1044" class="line none"> 1044 }</div><div id="1045" class="line none"> 1045 #else</div><div id="1046" class="line none"> 1046 static inline bool <a href="net_ip.h.html#1036">net_ipv4_is_addr_bcast</a>(struct net_if *iface,</div><div id="1047" class="line none"> 1047                                           const struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="1048" class="line none"> 1048 {</div><div id="1049" class="line none"> 1049         ARG_UNUSED(iface);</div><div id="1050" class="line none"> 1050         ARG_UNUSED(addr);</div><div id="1051" class="line none"> 1051 </div><div id="1052" class="line none"> 1052         return false;</div><div id="1053" class="line none"> 1053 }</div><div id="1054" class="line none"> 1054 #endif</div><div id="1055" class="line none"> 1055 </div><div id="1056" class="line none"> 1056 extern struct net_if_addr *net_if_ipv4_addr_lookup(const struct <a href="net_ip.h.html#151">in_addr</a> *addr,</div><div id="1057" class="line none"> 1057                                                    struct net_if **iface);</div><div id="1058" class="line none"> 1058 </div><div id="1059" class="line none"> 1059 /**</div><div id="1060" class="line none"> 1060  * @brief Check if the IPv4 address is assigned to any network interface</div><div id="1061" class="line none"> 1061  * in the system.</div><div id="1062" class="line none"> 1062  *</div><div id="1063" class="line none"> 1063  * @param addr A valid pointer on an IPv4 address</div><div id="1064" class="line none"> 1064  *</div><div id="1065" class="line none"> 1065  * @return True if IPv4 address is found in one of the network interfaces,</div><div id="1066" class="line none"> 1066  * False otherwise.</div><div id="1067" class="line none"> 1067  */</div><div id="1068" class="line none"> 1068 static inline bool <a href="net_ip.h.html#1068">net_ipv4_is_my_addr</a>(const struct <a href="net_ip.h.html#151">in_addr</a> *addr)</div><div id="1069" class="line none"> 1069 {</div><div id="1070" class="line none"> 1070         bool ret;</div><div id="1071" class="line none"> 1071 </div><div id="1072" class="line none"> 1072         ret = net_if_ipv4_addr_lookup(addr, NULL) != NULL;</div><div id="1073" class="line none"> 1073         if (!ret) {</div><div id="1074" class="line none"> 1074                 ret = <a href="net_ip.h.html#1036">net_ipv4_is_addr_bcast</a>(NULL, addr);</div><div id="1075" class="line none"> 1075         }</div><div id="1076" class="line none"> 1076 </div><div id="1077" class="line none"> 1077         return ret;</div><div id="1078" class="line none"> 1078 }</div><div id="1079" class="line none"> 1079 </div><div id="1080" class="line none"> 1080 /**</div><div id="1081" class="line none"> 1081  *  @brief Check if the IPv6 address is unspecified (all bits zero)</div><div id="1082" class="line none"> 1082  *</div><div id="1083" class="line none"> 1083  *  @param addr IPv6 address.</div><div id="1084" class="line none"> 1084  *</div><div id="1085" class="line none"> 1085  *  @return True if the address is unspecified, false otherwise.</div><div id="1086" class="line none"> 1086  */</div><div id="1087" class="line none"> 1087 static inline bool <a href="net_ip.h.html#1087">net_ipv6_is_addr_unspecified</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1088" class="line none"> 1088 {</div><div id="1089" class="line none"> 1089         return UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[0]) == 0 &amp;&amp;</div><div id="1090" class="line none"> 1090                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[1]) == 0 &amp;&amp;</div><div id="1091" class="line none"> 1091                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[2]) == 0 &amp;&amp;</div><div id="1092" class="line none"> 1092                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[3]) == 0;</div><div id="1093" class="line none"> 1093 }</div><div id="1094" class="line none"> 1094 </div><div id="1095" class="line none"> 1095 /**</div><div id="1096" class="line none"> 1096  *  @brief Check if the IPv6 address is solicited node multicast address</div><div id="1097" class="line none"> 1097  *  FF02:0:0:0:0:1:FFXX:XXXX defined in RFC 3513</div><div id="1098" class="line none"> 1098  *</div><div id="1099" class="line none"> 1099  *  @param addr IPv6 address.</div><div id="1100" class="line none"> 1100  *</div><div id="1101" class="line none"> 1101  *  @return True if the address is solicited node address, false otherwise.</div><div id="1102" class="line none"> 1102  */</div><div id="1103" class="line none"> 1103 static inline bool <a href="net_ip.h.html#1103">net_ipv6_is_addr_solicited_node</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1104" class="line none"> 1104 {</div><div id="1105" class="line none"> 1105         return UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[0]) == <a href="net_ip.h.html#128">htonl</a>(0xff020000) &amp;&amp;</div><div id="1106" class="line none"> 1106                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[1]) == 0x00000000 &amp;&amp;</div><div id="1107" class="line none"> 1107                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[2]) == <a href="net_ip.h.html#128">htonl</a>(0x00000001) &amp;&amp;</div><div id="1108" class="line none"> 1108                 ((UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[3]) &amp; <a href="net_ip.h.html#128">htonl</a>(0xff000000)) ==</div><div id="1109" class="line none"> 1109                  <a href="net_ip.h.html#128">htonl</a>(0xff000000));</div><div id="1110" class="line none"> 1110 }</div><div id="1111" class="line none"> 1111 </div><div id="1112" class="line none"> 1112 /**</div><div id="1113" class="line none"> 1113  * @brief Check if the IPv6 address is a given scope multicast</div><div id="1114" class="line none"> 1114  * address (FFyx::).</div><div id="1115" class="line none"> 1115  *</div><div id="1116" class="line none"> 1116  * @param addr IPv6 address</div><div id="1117" class="line none"> 1117  * @param scope Scope to check</div><div id="1118" class="line none"> 1118  *</div><div id="1119" class="line none"> 1119  * @return True if the address is in given scope multicast address,</div><div id="1120" class="line none"> 1120  * false otherwise.</div><div id="1121" class="line none"> 1121  */</div><div id="1122" class="line none"> 1122 static inline bool <a href="net_ip.h.html#1122">net_ipv6_is_addr_mcast_scope</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr,</div><div id="1123" class="line none"> 1123                                                 int scope)</div><div id="1124" class="line none"> 1124 {</div><div id="1125" class="line none"> 1125         return (addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[0] == 0xff) &amp;&amp; ((addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[1] &amp; 0xF) == scope);</div><div id="1126" class="line none"> 1126 }</div><div id="1127" class="line none"> 1127 </div><div id="1128" class="line none"> 1128 /**</div><div id="1129" class="line none"> 1129  * @brief Check if the IPv6 addresses have the same multicast scope (FFyx::).</div><div id="1130" class="line none"> 1130  *</div><div id="1131" class="line none"> 1131  * @param addr_1 IPv6 address 1</div><div id="1132" class="line none"> 1132  * @param addr_2 IPv6 address 2</div><div id="1133" class="line none"> 1133  *</div><div id="1134" class="line none"> 1134  * @return True if both addresses have same multicast scope,</div><div id="1135" class="line none"> 1135  * false otherwise.</div><div id="1136" class="line none"> 1136  */</div><div id="1137" class="line none"> 1137 static inline bool <a href="net_ip.h.html#1137">net_ipv6_is_same_mcast_scope</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr_1,</div><div id="1138" class="line none"> 1138                                                 const struct <a href="net_ip.h.html#139">in6_addr</a> *addr_2)</div><div id="1139" class="line none"> 1139 {</div><div id="1140" class="line none"> 1140         return (addr_1-&gt;<a href="net_ip.h.html#141">s6_addr</a>[0] == 0xff) &amp;&amp; (addr_2-&gt;<a href="net_ip.h.html#141">s6_addr</a>[0] == 0xff) &amp;&amp;</div><div id="1141" class="line none"> 1141                         (addr_1-&gt;<a href="net_ip.h.html#141">s6_addr</a>[1] == addr_2-&gt;<a href="net_ip.h.html#141">s6_addr</a>[1]);</div><div id="1142" class="line none"> 1142 }</div><div id="1143" class="line none"> 1143 </div><div id="1144" class="line none"> 1144 /**</div><div id="1145" class="line none"> 1145  * @brief Check if the IPv6 address is a global multicast address (FFxE::/16).</div><div id="1146" class="line none"> 1146  *</div><div id="1147" class="line none"> 1147  * @param addr IPv6 address.</div><div id="1148" class="line none"> 1148  *</div><div id="1149" class="line none"> 1149  * @return True if the address is global multicast address, false otherwise.</div><div id="1150" class="line none"> 1150  */</div><div id="1151" class="line none"> 1151 static inline bool <a href="net_ip.h.html#1151">net_ipv6_is_addr_mcast_global</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1152" class="line none"> 1152 {</div><div id="1153" class="line none"> 1153         return <a href="net_ip.h.html#1122">net_ipv6_is_addr_mcast_scope</a>(addr, 0x0e);</div><div id="1154" class="line none"> 1154 }</div><div id="1155" class="line none"> 1155 </div><div id="1156" class="line none"> 1156 /**</div><div id="1157" class="line none"> 1157  * @brief Check if the IPv6 address is a interface scope multicast</div><div id="1158" class="line none"> 1158  * address (FFx1::).</div><div id="1159" class="line none"> 1159  *</div><div id="1160" class="line none"> 1160  * @param addr IPv6 address.</div><div id="1161" class="line none"> 1161  *</div><div id="1162" class="line none"> 1162  * @return True if the address is a interface scope multicast address,</div><div id="1163" class="line none"> 1163  * false otherwise.</div><div id="1164" class="line none"> 1164  */</div><div id="1165" class="line none"> 1165 static inline bool <a href="net_ip.h.html#1165">net_ipv6_is_addr_mcast_iface</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1166" class="line none"> 1166 {</div><div id="1167" class="line none"> 1167         return <a href="net_ip.h.html#1122">net_ipv6_is_addr_mcast_scope</a>(addr, 0x01);</div><div id="1168" class="line none"> 1168 }</div><div id="1169" class="line none"> 1169 </div><div id="1170" class="line none"> 1170 /**</div><div id="1171" class="line none"> 1171  * @brief Check if the IPv6 address is a link local scope multicast</div><div id="1172" class="line none"> 1172  * address (FFx2::).</div><div id="1173" class="line none"> 1173  *</div><div id="1174" class="line none"> 1174  * @param addr IPv6 address.</div><div id="1175" class="line none"> 1175  *</div><div id="1176" class="line none"> 1176  * @return True if the address is a link local scope multicast address,</div><div id="1177" class="line none"> 1177  * false otherwise.</div><div id="1178" class="line none"> 1178  */</div><div id="1179" class="line none"> 1179 static inline bool <a href="net_ip.h.html#1179">net_ipv6_is_addr_mcast_link</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1180" class="line none"> 1180 {</div><div id="1181" class="line none"> 1181         return <a href="net_ip.h.html#1122">net_ipv6_is_addr_mcast_scope</a>(addr, 0x02);</div><div id="1182" class="line none"> 1182 }</div><div id="1183" class="line none"> 1183 </div><div id="1184" class="line none"> 1184 /**</div><div id="1185" class="line none"> 1185  * @brief Check if the IPv6 address is a mesh-local scope multicast</div><div id="1186" class="line none"> 1186  * address (FFx3::).</div><div id="1187" class="line none"> 1187  *</div><div id="1188" class="line none"> 1188  * @param addr IPv6 address.</div><div id="1189" class="line none"> 1189  *</div><div id="1190" class="line none"> 1190  * @return True if the address is a mesh-local scope multicast address,</div><div id="1191" class="line none"> 1191  * false otherwise.</div><div id="1192" class="line none"> 1192  */</div><div id="1193" class="line none"> 1193 static inline bool <a href="net_ip.h.html#1193">net_ipv6_is_addr_mcast_mesh</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1194" class="line none"> 1194 {</div><div id="1195" class="line none"> 1195         return <a href="net_ip.h.html#1122">net_ipv6_is_addr_mcast_scope</a>(addr, 0x03);</div><div id="1196" class="line none"> 1196 }</div><div id="1197" class="line none"> 1197 </div><div id="1198" class="line none"> 1198 /**</div><div id="1199" class="line none"> 1199  * @brief Check if the IPv6 address is a site scope multicast</div><div id="1200" class="line none"> 1200  * address (FFx5::).</div><div id="1201" class="line none"> 1201  *</div><div id="1202" class="line none"> 1202  * @param addr IPv6 address.</div><div id="1203" class="line none"> 1203  *</div><div id="1204" class="line none"> 1204  * @return True if the address is a site scope multicast address,</div><div id="1205" class="line none"> 1205  * false otherwise.</div><div id="1206" class="line none"> 1206  */</div><div id="1207" class="line none"> 1207 static inline bool <a href="net_ip.h.html#1207">net_ipv6_is_addr_mcast_site</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1208" class="line none"> 1208 {</div><div id="1209" class="line none"> 1209         return <a href="net_ip.h.html#1122">net_ipv6_is_addr_mcast_scope</a>(addr, 0x05);</div><div id="1210" class="line none"> 1210 }</div><div id="1211" class="line none"> 1211 </div><div id="1212" class="line none"> 1212 /**</div><div id="1213" class="line none"> 1213  * @brief Check if the IPv6 address is an organization scope multicast</div><div id="1214" class="line none"> 1214  * address (FFx8::).</div><div id="1215" class="line none"> 1215  *</div><div id="1216" class="line none"> 1216  * @param addr IPv6 address.</div><div id="1217" class="line none"> 1217  *</div><div id="1218" class="line none"> 1218  * @return True if the address is an organization scope multicast address,</div><div id="1219" class="line none"> 1219  * false otherwise.</div><div id="1220" class="line none"> 1220  */</div><div id="1221" class="line none"> 1221 static inline bool <a href="net_ip.h.html#1221">net_ipv6_is_addr_mcast_org</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1222" class="line none"> 1222 {</div><div id="1223" class="line none"> 1223         return <a href="net_ip.h.html#1122">net_ipv6_is_addr_mcast_scope</a>(addr, 0x08);</div><div id="1224" class="line none"> 1224 }</div><div id="1225" class="line none"> 1225 </div><div id="1226" class="line none"> 1226 /**</div><div id="1227" class="line none"> 1227  * @brief Check if the IPv6 address belongs to certain multicast group</div><div id="1228" class="line none"> 1228  *</div><div id="1229" class="line none"> 1229  * @param addr IPv6 address.</div><div id="1230" class="line none"> 1230  * @param group Group id IPv6 address, the values must be in network</div><div id="1231" class="line none"> 1231  * byte order</div><div id="1232" class="line none"> 1232  *</div><div id="1233" class="line none"> 1233  * @return True if the IPv6 multicast address belongs to given multicast</div><div id="1234" class="line none"> 1234  * group, false otherwise.</div><div id="1235" class="line none"> 1235  */</div><div id="1236" class="line none"> 1236 static inline bool <a href="net_ip.h.html#1236">net_ipv6_is_addr_mcast_group</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr,</div><div id="1237" class="line none"> 1237                                                 const struct <a href="net_ip.h.html#139">in6_addr</a> *group)</div><div id="1238" class="line none"> 1238 {</div><div id="1239" class="line none"> 1239         return UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[1]) == group-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[1] &amp;&amp;</div><div id="1240" class="line none"> 1240                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[2]) == group-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[2] &amp;&amp;</div><div id="1241" class="line none"> 1241                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[3]) == group-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[3] &amp;&amp;</div><div id="1242" class="line none"> 1242                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[1]) == group-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[1] &amp;&amp;</div><div id="1243" class="line none"> 1243                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[2]) == group-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[1] &amp;&amp;</div><div id="1244" class="line none"> 1244                 UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[3]) == group-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[3];</div><div id="1245" class="line none"> 1245 }</div><div id="1246" class="line none"> 1246 </div><div id="1247" class="line none"> 1247 /**</div><div id="1248" class="line none"> 1248  * @brief Check if the IPv6 address belongs to the all nodes multicast group</div><div id="1249" class="line none"> 1249  *</div><div id="1250" class="line none"> 1250  * @param addr IPv6 address</div><div id="1251" class="line none"> 1251  *</div><div id="1252" class="line none"> 1252  * @return True if the IPv6 multicast address belongs to the all nodes multicast</div><div id="1253" class="line none"> 1253  * group, false otherwise</div><div id="1254" class="line none"> 1254  */</div><div id="1255" class="line none"> 1255 static inline bool</div><div id="1256" class="line none"> 1256 <a href="net_ip.h.html#1256">net_ipv6_is_addr_mcast_all_nodes_group</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1257" class="line none"> 1257 {</div><div id="1258" class="line none"> 1258         static const struct <a href="net_ip.h.html#139">in6_addr</a> all_nodes_mcast_group = {</div><div id="1259" class="line none"> 1259                 { { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div><div id="1260" class="line none"> 1260                     0x00, 0x00, 0x00, 0x00, 0x00, 0x01 } }</div><div id="1261" class="line none"> 1261         };</div><div id="1262" class="line none"> 1262 </div><div id="1263" class="line none"> 1263         return <a href="net_ip.h.html#1236">net_ipv6_is_addr_mcast_group</a>(addr, &amp;all_nodes_mcast_group);</div><div id="1264" class="line none"> 1264 }</div><div id="1265" class="line none"> 1265 </div><div id="1266" class="line none"> 1266 /**</div><div id="1267" class="line none"> 1267  * @brief Check if the IPv6 address is a interface scope all nodes multicast</div><div id="1268" class="line none"> 1268  * address (FF01::1).</div><div id="1269" class="line none"> 1269  *</div><div id="1270" class="line none"> 1270  * @param addr IPv6 address.</div><div id="1271" class="line none"> 1271  *</div><div id="1272" class="line none"> 1272  * @return True if the address is a interface scope all nodes multicast address,</div><div id="1273" class="line none"> 1273  * false otherwise.</div><div id="1274" class="line none"> 1274  */</div><div id="1275" class="line none"> 1275 static inline bool</div><div id="1276" class="line none"> 1276 <a href="net_ip.h.html#1276">net_ipv6_is_addr_mcast_iface_all_nodes</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1277" class="line none"> 1277 {</div><div id="1278" class="line none"> 1278         return <a href="net_ip.h.html#1165">net_ipv6_is_addr_mcast_iface</a>(addr) &amp;&amp;</div><div id="1279" class="line none"> 1279                <a href="net_ip.h.html#1256">net_ipv6_is_addr_mcast_all_nodes_group</a>(addr);</div><div id="1280" class="line none"> 1280 }</div><div id="1281" class="line none"> 1281 </div><div id="1282" class="line none"> 1282 /**</div><div id="1283" class="line none"> 1283  * @brief Check if the IPv6 address is a link local scope all nodes multicast</div><div id="1284" class="line none"> 1284  * address (FF02::1).</div><div id="1285" class="line none"> 1285  *</div><div id="1286" class="line none"> 1286  * @param addr IPv6 address.</div><div id="1287" class="line none"> 1287  *</div><div id="1288" class="line none"> 1288  * @return True if the address is a link local scope all nodes multicast</div><div id="1289" class="line none"> 1289  * address, false otherwise.</div><div id="1290" class="line none"> 1290  */</div><div id="1291" class="line none"> 1291 static inline bool</div><div id="1292" class="line none"> 1292 <a href="net_ip.h.html#1292">net_ipv6_is_addr_mcast_link_all_nodes</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1293" class="line none"> 1293 {</div><div id="1294" class="line none"> 1294         return <a href="net_ip.h.html#1179">net_ipv6_is_addr_mcast_link</a>(addr) &amp;&amp;</div><div id="1295" class="line none"> 1295                <a href="net_ip.h.html#1256">net_ipv6_is_addr_mcast_all_nodes_group</a>(addr);</div><div id="1296" class="line none"> 1296 }</div><div id="1297" class="line none"> 1297 </div><div id="1298" class="line none"> 1298 /**</div><div id="1299" class="line none"> 1299  *  @brief Create solicited node IPv6 multicast address</div><div id="1300" class="line none"> 1300  *  FF02:0:0:0:0:1:FFXX:XXXX defined in RFC 3513</div><div id="1301" class="line none"> 1301  *</div><div id="1302" class="line none"> 1302  *  @param src IPv6 address.</div><div id="1303" class="line none"> 1303  *  @param dst IPv6 address.</div><div id="1304" class="line none"> 1304  */</div><div id="1305" class="line none"> 1305 static inline</div><div id="1306" class="line none"> 1306 void <a href="net_ip.h.html#1306">net_ipv6_addr_create_solicited_node</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *<a href="net_ip.h.html#530">src</a>,</div><div id="1307" class="line none"> 1307                                          struct <a href="net_ip.h.html#139">in6_addr</a> *<a href="net_ip.h.html#531">dst</a>)</div><div id="1308" class="line none"> 1308 {</div><div id="1309" class="line none"> 1309         <a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#141">s6_addr</a>[0]   = 0xFF;</div><div id="1310" class="line none"> 1310         <a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#141">s6_addr</a>[1]   = 0x02;</div><div id="1311" class="line none"> 1311         UNALIGNED_PUT(0, &amp;<a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[1]);</div><div id="1312" class="line none"> 1312         UNALIGNED_PUT(0, &amp;<a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[2]);</div><div id="1313" class="line none"> 1313         UNALIGNED_PUT(0, &amp;<a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[3]);</div><div id="1314" class="line none"> 1314         UNALIGNED_PUT(0, &amp;<a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[4]);</div><div id="1315" class="line none"> 1315         <a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#141">s6_addr</a>[10]  = 0U;</div><div id="1316" class="line none"> 1316         <a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#141">s6_addr</a>[11]  = 0x01;</div><div id="1317" class="line none"> 1317         <a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#141">s6_addr</a>[12]  = 0xFF;</div><div id="1318" class="line none"> 1318         <a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#141">s6_addr</a>[13]  = <a href="net_ip.h.html#530">src</a>-&gt;<a href="net_ip.h.html#141">s6_addr</a>[13];</div><div id="1319" class="line none"> 1319         UNALIGNED_PUT(UNALIGNED_GET(&amp;<a href="net_ip.h.html#530">src</a>-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[7]), &amp;<a href="net_ip.h.html#531">dst</a>-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[7]);</div><div id="1320" class="line none"> 1320 }</div><div id="1321" class="line none"> 1321 </div><div id="1322" class="line none"> 1322 /** @brief Construct an IPv6 address from eight 16-bit words.</div><div id="1323" class="line none"> 1323  *</div><div id="1324" class="line none"> 1324  *  @param addr IPv6 address</div><div id="1325" class="line none"> 1325  *  @param addr0 16-bit word which is part of the address</div><div id="1326" class="line none"> 1326  *  @param addr1 16-bit word which is part of the address</div><div id="1327" class="line none"> 1327  *  @param addr2 16-bit word which is part of the address</div><div id="1328" class="line none"> 1328  *  @param addr3 16-bit word which is part of the address</div><div id="1329" class="line none"> 1329  *  @param addr4 16-bit word which is part of the address</div><div id="1330" class="line none"> 1330  *  @param addr5 16-bit word which is part of the address</div><div id="1331" class="line none"> 1331  *  @param addr6 16-bit word which is part of the address</div><div id="1332" class="line none"> 1332  *  @param addr7 16-bit word which is part of the address</div><div id="1333" class="line none"> 1333  */</div><div id="1334" class="line none"> 1334 static inline void <a href="net_ip.h.html#1334">net_ipv6_addr_create</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr,</div><div id="1335" class="line none"> 1335                                         uint16_t addr0, uint16_t addr1,</div><div id="1336" class="line none"> 1336                                         uint16_t addr2, uint16_t addr3,</div><div id="1337" class="line none"> 1337                                         uint16_t addr4, uint16_t addr5,</div><div id="1338" class="line none"> 1338                                         uint16_t addr6, uint16_t addr7)</div><div id="1339" class="line none"> 1339 {</div><div id="1340" class="line none"> 1340         UNALIGNED_PUT(<a href="net_ip.h.html#120">htons</a>(addr0), &amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[0]);</div><div id="1341" class="line none"> 1341         UNALIGNED_PUT(<a href="net_ip.h.html#120">htons</a>(addr1), &amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[1]);</div><div id="1342" class="line none"> 1342         UNALIGNED_PUT(<a href="net_ip.h.html#120">htons</a>(addr2), &amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[2]);</div><div id="1343" class="line none"> 1343         UNALIGNED_PUT(<a href="net_ip.h.html#120">htons</a>(addr3), &amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[3]);</div><div id="1344" class="line none"> 1344         UNALIGNED_PUT(<a href="net_ip.h.html#120">htons</a>(addr4), &amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[4]);</div><div id="1345" class="line none"> 1345         UNALIGNED_PUT(<a href="net_ip.h.html#120">htons</a>(addr5), &amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[5]);</div><div id="1346" class="line none"> 1346         UNALIGNED_PUT(<a href="net_ip.h.html#120">htons</a>(addr6), &amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[6]);</div><div id="1347" class="line none"> 1347         UNALIGNED_PUT(<a href="net_ip.h.html#120">htons</a>(addr7), &amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[7]);</div><div id="1348" class="line none"> 1348 }</div><div id="1349" class="line none"> 1349 </div><div id="1350" class="line none"> 1350 /**</div><div id="1351" class="line none"> 1351  *  @brief Create link local allnodes multicast IPv6 address</div><div id="1352" class="line none"> 1352  *</div><div id="1353" class="line none"> 1353  *  @param addr IPv6 address</div><div id="1354" class="line none"> 1354  */</div><div id="1355" class="line none"> 1355 static inline void <a href="net_ip.h.html#1355">net_ipv6_addr_create_ll_allnodes_mcast</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1356" class="line none"> 1356 {</div><div id="1357" class="line none"> 1357         <a href="net_ip.h.html#1334">net_ipv6_addr_create</a>(addr, 0xff02, 0, 0, 0, 0, 0, 0, 0x0001);</div><div id="1358" class="line none"> 1358 }</div><div id="1359" class="line none"> 1359 </div><div id="1360" class="line none"> 1360 /**</div><div id="1361" class="line none"> 1361  *  @brief Create link local allrouters multicast IPv6 address</div><div id="1362" class="line none"> 1362  *</div><div id="1363" class="line none"> 1363  *  @param addr IPv6 address</div><div id="1364" class="line none"> 1364  */</div><div id="1365" class="line none"> 1365 static inline void <a href="net_ip.h.html#1365">net_ipv6_addr_create_ll_allrouters_mcast</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1366" class="line none"> 1366 {</div><div id="1367" class="line none"> 1367         <a href="net_ip.h.html#1334">net_ipv6_addr_create</a>(addr, 0xff02, 0, 0, 0, 0, 0, 0, 0x0002);</div><div id="1368" class="line none"> 1368 }</div><div id="1369" class="line none"> 1369 </div><div id="1370" class="line none"> 1370 /**</div><div id="1371" class="line none"> 1371  *  @brief Create IPv4 mapped IPv6 address</div><div id="1372" class="line none"> 1372  *</div><div id="1373" class="line none"> 1373  *  @param addr4 IPv4 address</div><div id="1374" class="line none"> 1374  *  @param addr6 IPv6 address to be created</div><div id="1375" class="line none"> 1375  */</div><div id="1376" class="line none"> 1376 static inline void <a href="net_ip.h.html#1376">net_ipv6_addr_create_v4_mapped</a>(const struct <a href="net_ip.h.html#151">in_addr</a> *addr4,</div><div id="1377" class="line none"> 1377                                                   struct <a href="net_ip.h.html#139">in6_addr</a> *addr6)</div><div id="1378" class="line none"> 1378 {</div><div id="1379" class="line none"> 1379         <a href="net_ip.h.html#1334">net_ipv6_addr_create</a>(addr6, 0, 0, 0, 0, 0, 0xffff,</div><div id="1380" class="line none"> 1380                              <a href="net_ip.h.html#96">ntohs</a>(addr4-&gt;<a href="net_ip.h.html#154">s4_addr16</a>[0]),</div><div id="1381" class="line none"> 1381                              <a href="net_ip.h.html#96">ntohs</a>(addr4-&gt;<a href="net_ip.h.html#154">s4_addr16</a>[1]));</div><div id="1382" class="line none"> 1382 }</div><div id="1383" class="line none"> 1383 </div><div id="1384" class="line none"> 1384 /**</div><div id="1385" class="line none"> 1385  *  @brief Is the IPv6 address an IPv4 mapped one. The v4 mapped addresses</div><div id="1386" class="line none"> 1386  *         look like \::ffff:a.b.c.d</div><div id="1387" class="line none"> 1387  *</div><div id="1388" class="line none"> 1388  *  @param addr IPv6 address</div><div id="1389" class="line none"> 1389  *</div><div id="1390" class="line none"> 1390  *  @return True if IPv6 address is a IPv4 mapped address, False otherwise.</div><div id="1391" class="line none"> 1391  */</div><div id="1392" class="line none"> 1392 static inline bool <a href="net_ip.h.html#1392">net_ipv6_addr_is_v4_mapped</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1393" class="line none"> 1393 {</div><div id="1394" class="line none"> 1394         if (UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[0]) == 0 &amp;&amp;</div><div id="1395" class="line none"> 1395             UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[1]) == 0 &amp;&amp;</div><div id="1396" class="line none"> 1396             UNALIGNED_GET(&amp;addr-&gt;<a href="net_ip.h.html#142">s6_addr16</a>[5]) == 0xffff) {</div><div id="1397" class="line none"> 1397                 return true;</div><div id="1398" class="line none"> 1398         }</div><div id="1399" class="line none"> 1399 </div><div id="1400" class="line none"> 1400         return false;</div><div id="1401" class="line none"> 1401 }</div><div id="1402" class="line none"> 1402 </div><div id="1403" class="line none"> 1403 /**</div><div id="1404" class="line none"> 1404  *  @brief Create IPv6 address interface identifier</div><div id="1405" class="line none"> 1405  *</div><div id="1406" class="line none"> 1406  *  @param addr IPv6 address</div><div id="1407" class="line none"> 1407  *  @param lladdr Link local address</div><div id="1408" class="line none"> 1408  */</div><div id="1409" class="line none"> 1409 static inline void <a href="net_ip.h.html#1409">net_ipv6_addr_create_iid</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr,</div><div id="1410" class="line none"> 1410                                             struct net_linkaddr *lladdr)</div><div id="1411" class="line none"> 1411 {</div><div id="1412" class="line none"> 1412         UNALIGNED_PUT(<a href="net_ip.h.html#128">htonl</a>(0xfe800000), &amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[0]);</div><div id="1413" class="line none"> 1413         UNALIGNED_PUT(0, &amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[1]);</div><div id="1414" class="line none"> 1414 </div><div id="1415" class="line none"> 1415         switch (lladdr-&gt;<a href="buf.h.html#96">len</a>) {</div><div id="1416" class="line none"> 1416         case 2:</div><div id="1417" class="line none"> 1417                 /* The generated IPv6 shall not toggle the</div><div id="1418" class="line none"> 1418                  * Universal/Local bit. RFC 6282 ch 3.2.2</div><div id="1419" class="line none"> 1419                  */</div><div id="1420" class="line none"> 1420                 if (lladdr-&gt;<a href="net_ip.h.html#555">type</a> == NET_LINK_IEEE802154) {</div><div id="1421" class="line none"> 1421                         UNALIGNED_PUT(0, &amp;addr-&gt;<a href="net_ip.h.html#143">s6_addr32</a>[2]);</div><div id="1422" class="line none"> 1422                         addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[11] = 0xff;</div><div id="1423" class="line none"> 1423                         addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[12] = 0xfe;</div><div id="1424" class="line none"> 1424                         addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[13] = 0U;</div><div id="1425" class="line none"> 1425                         addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[14] = lladdr-&gt;addr[0];</div><div id="1426" class="line none"> 1426                         addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[15] = lladdr-&gt;addr[1];</div><div id="1427" class="line none"> 1427                 }</div><div id="1428" class="line none"> 1428 </div><div id="1429" class="line none"> 1429                 break;</div><div id="1430" class="line none"> 1430         case 6:</div><div id="1431" class="line none"> 1431                 /* We do not toggle the Universal/Local bit</div><div id="1432" class="line none"> 1432                  * in Bluetooth. See RFC 7668 ch 3.2.2</div><div id="1433" class="line none"> 1433                  */</div><div id="1434" class="line none"> 1434                 memcpy(&amp;addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[8], lladdr-&gt;addr, 3);</div><div id="1435" class="line none"> 1435                 addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[11] = 0xff;</div><div id="1436" class="line none"> 1436                 addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[12] = 0xfe;</div><div id="1437" class="line none"> 1437                 memcpy(&amp;addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[13], lladdr-&gt;addr + 3, 3);</div><div id="1438" class="line none"> 1438 </div><div id="1439" class="line none"> 1439                 if (lladdr-&gt;<a href="net_ip.h.html#555">type</a> == NET_LINK_ETHERNET) {</div><div id="1440" class="line none"> 1440                         addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[8] ^= 0x02;</div><div id="1441" class="line none"> 1441                 }</div><div id="1442" class="line none"> 1442 </div><div id="1443" class="line none"> 1443                 break;</div><div id="1444" class="line none"> 1444         case 8:</div><div id="1445" class="line none"> 1445                 memcpy(&amp;addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[8], lladdr-&gt;addr, lladdr-&gt;<a href="buf.h.html#96">len</a>);</div><div id="1446" class="line none"> 1446                 addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[8] ^= 0x02;</div><div id="1447" class="line none"> 1447                 break;</div><div id="1448" class="line none"> 1448         }</div><div id="1449" class="line none"> 1449 }</div><div id="1450" class="line none"> 1450 </div><div id="1451" class="line none"> 1451 /**</div><div id="1452" class="line none"> 1452  *  @brief Check if given address is based on link layer address</div><div id="1453" class="line none"> 1453  *</div><div id="1454" class="line none"> 1454  *  @return True if it is, False otherwise</div><div id="1455" class="line none"> 1455  */</div><div id="1456" class="line none"> 1456 static inline bool <a href="net_ip.h.html#1456">net_ipv6_addr_based_on_ll</a>(const struct <a href="net_ip.h.html#139">in6_addr</a> *addr,</div><div id="1457" class="line none"> 1457                                              const struct net_linkaddr *lladdr)</div><div id="1458" class="line none"> 1458 {</div><div id="1459" class="line none"> 1459         if (!addr || !lladdr) {</div><div id="1460" class="line none"> 1460                 return false;</div><div id="1461" class="line none"> 1461         }</div><div id="1462" class="line none"> 1462 </div><div id="1463" class="line none"> 1463         switch (lladdr-&gt;<a href="buf.h.html#96">len</a>) {</div><div id="1464" class="line none"> 1464         case 2:</div><div id="1465" class="line none"> 1465                 if (!memcmp(&amp;addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[14], lladdr-&gt;addr, lladdr-&gt;<a href="buf.h.html#96">len</a>) &amp;&amp;</div><div id="1466" class="line none"> 1466                     addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[8]  == 0U &amp;&amp;</div><div id="1467" class="line none"> 1467                     addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[9]  == 0U &amp;&amp;</div><div id="1468" class="line none"> 1468                     addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[10] == 0U &amp;&amp;</div><div id="1469" class="line none"> 1469                     addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[11] == 0xff &amp;&amp;</div><div id="1470" class="line none"> 1470                     addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[12] == 0xfe) {</div><div id="1471" class="line none"> 1471                         return true;</div><div id="1472" class="line none"> 1472                 }</div><div id="1473" class="line none"> 1473 </div><div id="1474" class="line none"> 1474                 break;</div><div id="1475" class="line none"> 1475         case 6:</div><div id="1476" class="line none"> 1476                 if (lladdr-&gt;<a href="net_ip.h.html#555">type</a> == NET_LINK_ETHERNET) {</div><div id="1477" class="line none"> 1477                         if (!memcmp(&amp;addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[9], &amp;lladdr-&gt;addr[1], 2) &amp;&amp;</div><div id="1478" class="line none"> 1478                             !memcmp(&amp;addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[13], &amp;lladdr-&gt;addr[3], 3) &amp;&amp;</div><div id="1479" class="line none"> 1479                             addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[11] == 0xff &amp;&amp;</div><div id="1480" class="line none"> 1480                             addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[12] == 0xfe &amp;&amp;</div><div id="1481" class="line none"> 1481                             (addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[8] ^ 0x02) == lladdr-&gt;addr[0]) {</div><div id="1482" class="line none"> 1482                                 return true;</div><div id="1483" class="line none"> 1483                         }</div><div id="1484" class="line none"> 1484                 }</div><div id="1485" class="line none"> 1485 </div><div id="1486" class="line none"> 1486                 break;</div><div id="1487" class="line none"> 1487         case 8:</div><div id="1488" class="line none"> 1488                 if (!memcmp(&amp;addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[9], &amp;lladdr-&gt;addr[1],</div><div id="1489" class="line none"> 1489                             lladdr-&gt;<a href="buf.h.html#96">len</a> - 1) &amp;&amp;</div><div id="1490" class="line none"> 1490                     (addr-&gt;<a href="net_ip.h.html#141">s6_addr</a>[8] ^ 0x02) == lladdr-&gt;addr[0]) {</div><div id="1491" class="line none"> 1491                         return true;</div><div id="1492" class="line none"> 1492                 }</div><div id="1493" class="line none"> 1493 </div><div id="1494" class="line none"> 1494                 break;</div><div id="1495" class="line none"> 1495         }</div><div id="1496" class="line none"> 1496 </div><div id="1497" class="line none"> 1497         return false;</div><div id="1498" class="line none"> 1498 }</div><div id="1499" class="line none"> 1499 </div><div id="1500" class="line none"> 1500 /**</div><div id="1501" class="line none"> 1501  * @brief Get sockaddr_in6 from sockaddr. This is a helper so that</div><div id="1502" class="line none"> 1502  * the code calling this function can be made shorter.</div><div id="1503" class="line none"> 1503  *</div><div id="1504" class="line none"> 1504  * @param addr Socket address</div><div id="1505" class="line none"> 1505  *</div><div id="1506" class="line none"> 1506  * @return Pointer to IPv6 socket address</div><div id="1507" class="line none"> 1507  */</div><div id="1508" class="line none"> 1508 static inline struct <a href="net_ip.h.html#178">sockaddr_in6</a> *<a href="net_ip.h.html#1508">net_sin6</a>(const struct <a href="net_ip.h.html#385">sockaddr</a> *addr)</div><div id="1509" class="line none"> 1509 {</div><div id="1510" class="line none"> 1510         return (struct <a href="net_ip.h.html#178">sockaddr_in6</a> *)addr;</div><div id="1511" class="line none"> 1511 }</div><div id="1512" class="line none"> 1512 </div><div id="1513" class="line none"> 1513 /**</div><div id="1514" class="line none"> 1514  * @brief Get sockaddr_in from sockaddr. This is a helper so that</div><div id="1515" class="line none"> 1515  * the code calling this function can be made shorter.</div><div id="1516" class="line none"> 1516  *</div><div id="1517" class="line none"> 1517  * @param addr Socket address</div><div id="1518" class="line none"> 1518  *</div><div id="1519" class="line none"> 1519  * @return Pointer to IPv4 socket address</div><div id="1520" class="line none"> 1520  */</div><div id="1521" class="line none"> 1521 static inline struct <a href="net_ip.h.html#186">sockaddr_in</a> *<a href="net_ip.h.html#1521">net_sin</a>(const struct <a href="net_ip.h.html#385">sockaddr</a> *addr)</div><div id="1522" class="line none"> 1522 {</div><div id="1523" class="line none"> 1523         return (struct <a href="net_ip.h.html#186">sockaddr_in</a> *)addr;</div><div id="1524" class="line none"> 1524 }</div><div id="1525" class="line none"> 1525 </div><div id="1526" class="line none"> 1526 /**</div><div id="1527" class="line none"> 1527  * @brief Get sockaddr_in6_ptr from sockaddr_ptr. This is a helper so that</div><div id="1528" class="line none"> 1528  * the code calling this function can be made shorter.</div><div id="1529" class="line none"> 1529  *</div><div id="1530" class="line none"> 1530  * @param addr Socket address</div><div id="1531" class="line none"> 1531  *</div><div id="1532" class="line none"> 1532  * @return Pointer to IPv6 socket address</div><div id="1533" class="line none"> 1533  */</div><div id="1534" class="line none"> 1534 static inline</div><div id="1535" class="line none"> 1535 struct <a href="net_ip.h.html#206">sockaddr_in6_ptr</a> *<a href="net_ip.h.html#1535">net_sin6_ptr</a>(const struct <a href="net_ip.h.html#394">sockaddr_ptr</a> *addr)</div><div id="1536" class="line none"> 1536 {</div><div id="1537" class="line none"> 1537         return (struct <a href="net_ip.h.html#206">sockaddr_in6_ptr</a> *)addr;</div><div id="1538" class="line none"> 1538 }</div><div id="1539" class="line none"> 1539 </div><div id="1540" class="line none"> 1540 /**</div><div id="1541" class="line none"> 1541  * @brief Get sockaddr_in_ptr from sockaddr_ptr. This is a helper so that</div><div id="1542" class="line none"> 1542  * the code calling this function can be made shorter.</div><div id="1543" class="line none"> 1543  *</div><div id="1544" class="line none"> 1544  * @param addr Socket address</div><div id="1545" class="line none"> 1545  *</div><div id="1546" class="line none"> 1546  * @return Pointer to IPv4 socket address</div><div id="1547" class="line none"> 1547  */</div><div id="1548" class="line none"> 1548 static inline</div><div id="1549" class="line none"> 1549 struct <a href="net_ip.h.html#214">sockaddr_in_ptr</a> *<a href="net_ip.h.html#1549">net_sin_ptr</a>(const struct <a href="net_ip.h.html#394">sockaddr_ptr</a> *addr)</div><div id="1550" class="line none"> 1550 {</div><div id="1551" class="line none"> 1551         return (struct <a href="net_ip.h.html#214">sockaddr_in_ptr</a> *)addr;</div><div id="1552" class="line none"> 1552 }</div><div id="1553" class="line none"> 1553 </div><div id="1554" class="line none"> 1554 /**</div><div id="1555" class="line none"> 1555  * @brief Get sockaddr_ll_ptr from sockaddr_ptr. This is a helper so that</div><div id="1556" class="line none"> 1556  * the code calling this function can be made shorter.</div><div id="1557" class="line none"> 1557  *</div><div id="1558" class="line none"> 1558  * @param addr Socket address</div><div id="1559" class="line none"> 1559  *</div><div id="1560" class="line none"> 1560  * @return Pointer to linklayer socket address</div><div id="1561" class="line none"> 1561  */</div><div id="1562" class="line none"> 1562 static inline</div><div id="1563" class="line none"> 1563 struct <a href="net_ip.h.html#221">sockaddr_ll_ptr</a> *<a href="net_ip.h.html#1563">net_sll_ptr</a>(const struct <a href="net_ip.h.html#394">sockaddr_ptr</a> *addr)</div><div id="1564" class="line none"> 1564 {</div><div id="1565" class="line none"> 1565         return (struct <a href="net_ip.h.html#221">sockaddr_ll_ptr</a> *)addr;</div><div id="1566" class="line none"> 1566 }</div><div id="1567" class="line none"> 1567 </div><div id="1568" class="line none"> 1568 /**</div><div id="1569" class="line none"> 1569  * @brief Get sockaddr_can_ptr from sockaddr_ptr. This is a helper so that</div><div id="1570" class="line none"> 1570  * the code needing this functionality can be made shorter.</div><div id="1571" class="line none"> 1571  *</div><div id="1572" class="line none"> 1572  * @param addr Socket address</div><div id="1573" class="line none"> 1573  *</div><div id="1574" class="line none"> 1574  * @return Pointer to CAN socket address</div><div id="1575" class="line none"> 1575  */</div><div id="1576" class="line none"> 1576 static inline</div><div id="1577" class="line none"> 1577 struct <a href="net_ip.h.html#231">sockaddr_can_ptr</a> *<a href="net_ip.h.html#1577">net_can_ptr</a>(const struct <a href="net_ip.h.html#394">sockaddr_ptr</a> *addr)</div><div id="1578" class="line none"> 1578 {</div><div id="1579" class="line none"> 1579         return (struct <a href="net_ip.h.html#231">sockaddr_can_ptr</a> *)addr;</div><div id="1580" class="line none"> 1580 }</div><div id="1581" class="line none"> 1581 </div><div id="1582" class="line none"> 1582 /**</div><div id="1583" class="line none"> 1583  * @brief Convert a string to IP address.</div><div id="1584" class="line none"> 1584  *</div><div id="1585" class="line none"> 1585  * @param family IP address family (AF_INET or AF_INET6)</div><div id="1586" class="line none"> 1586  * @param src IP address in a null terminated string</div><div id="1587" class="line none"> 1587  * @param dst Pointer to struct in_addr if family is AF_INET or</div><div id="1588" class="line none"> 1588  * pointer to struct in6_addr if family is AF_INET6</div><div id="1589" class="line none"> 1589  *</div><div id="1590" class="line none"> 1590  * @note This function doesn't do precise error checking,</div><div id="1591" class="line none"> 1591  * do not use for untrusted strings.</div><div id="1592" class="line none"> 1592  *</div><div id="1593" class="line none"> 1593  * @return 0 if ok, &lt; 0 if error</div><div id="1594" class="line none"> 1594  */</div><div id="1595" class="line none"> 1595 __syscall int net_addr_pton(<a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#395">family</a>, const char *<a href="net_ip.h.html#530">src</a>, void *<a href="net_ip.h.html#531">dst</a>);</div><div id="1596" class="line none"> 1596 </div><div id="1597" class="line none"> 1597 /**</div><div id="1598" class="line none"> 1598  * @brief Convert IP address to string form.</div><div id="1599" class="line none"> 1599  *</div><div id="1600" class="line none"> 1600  * @param family IP address family (AF_INET or AF_INET6)</div><div id="1601" class="line none"> 1601  * @param src Pointer to struct in_addr if family is AF_INET or</div><div id="1602" class="line none"> 1602  *        pointer to struct in6_addr if family is AF_INET6</div><div id="1603" class="line none"> 1603  * @param dst Buffer for IP address as a null terminated string</div><div id="1604" class="line none"> 1604  * @param size Number of bytes available in the buffer</div><div id="1605" class="line none"> 1605  *</div><div id="1606" class="line none"> 1606  * @return dst pointer if ok, NULL if error</div><div id="1607" class="line none"> 1607  */</div><div id="1608" class="line none"> 1608 __syscall char *net_addr_ntop(<a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#395">family</a>, const void *<a href="net_ip.h.html#530">src</a>,</div><div id="1609" class="line none"> 1609                               char *<a href="net_ip.h.html#531">dst</a>, size_t <a href="buf.h.html#99">size</a>);</div><div id="1610" class="line none"> 1610 </div><div id="1611" class="line none"> 1611 /**</div><div id="1612" class="line none"> 1612  * @brief Parse a string that contains either IPv4 or IPv6 address</div><div id="1613" class="line none"> 1613  * and optional port, and store the information in user supplied</div><div id="1614" class="line none"> 1614  * sockaddr struct.</div><div id="1615" class="line none"> 1615  *</div><div id="1616" class="line none"> 1616  * @details Syntax of the IP address string:</div><div id="1617" class="line none"> 1617  *   192.0.2.1:80</div><div id="1618" class="line none"> 1618  *   192.0.2.42</div><div id="1619" class="line none"> 1619  *   [2001:db8::1]:8080</div><div id="1620" class="line none"> 1620  *   [2001:db8::2]</div><div id="1621" class="line none"> 1621  *   2001:db::42</div><div id="1622" class="line none"> 1622  * Note that the str_len parameter is used to restrict the amount of</div><div id="1623" class="line none"> 1623  * characters that are checked. If the string does not contain port</div><div id="1624" class="line none"> 1624  * number, then the port number in sockaddr is not modified.</div><div id="1625" class="line none"> 1625  *</div><div id="1626" class="line none"> 1626  * @param str String that contains the IP address.</div><div id="1627" class="line none"> 1627  * @param str_len Length of the string to be parsed.</div><div id="1628" class="line none"> 1628  * @param addr Pointer to user supplied struct sockaddr.</div><div id="1629" class="line none"> 1629  *</div><div id="1630" class="line none"> 1630  * @return True if parsing could be done, false otherwise.</div><div id="1631" class="line none"> 1631  */</div><div id="1632" class="line none"> 1632 bool net_ipaddr_parse(const char *str, size_t str_len,</div><div id="1633" class="line none"> 1633                       struct <a href="net_ip.h.html#385">sockaddr</a> *addr);</div><div id="1634" class="line none"> 1634 </div><div id="1635" class="line none"> 1635 /**</div><div id="1636" class="line none"> 1636  * @brief Set the default port in the sockaddr structure.</div><div id="1637" class="line none"> 1637  * If the port is already set, then do nothing.</div><div id="1638" class="line none"> 1638  *</div><div id="1639" class="line none"> 1639  * @param addr Pointer to user supplied struct sockaddr.</div><div id="1640" class="line none"> 1640  * @param default_port Default port number to set.</div><div id="1641" class="line none"> 1641  *</div><div id="1642" class="line none"> 1642  * @return 0 if ok, &lt;0 if error</div><div id="1643" class="line none"> 1643  */</div><div id="1644" class="line none"> 1644 int net_port_set_default(struct <a href="net_ip.h.html#385">sockaddr</a> *addr, uint16_t default_port);</div><div id="1645" class="line none"> 1645 </div><div id="1646" class="line none"> 1646 /**</div><div id="1647" class="line none"> 1647  * @brief Compare TCP sequence numbers.</div><div id="1648" class="line none"> 1648  *</div><div id="1649" class="line none"> 1649  * @details This function compares TCP sequence numbers,</div><div id="1650" class="line none"> 1650  *          accounting for wraparound effects.</div><div id="1651" class="line none"> 1651  *</div><div id="1652" class="line none"> 1652  * @param seq1 First sequence number</div><div id="1653" class="line none"> 1653  * @param seq2 Seconds sequence number</div><div id="1654" class="line none"> 1654  *</div><div id="1655" class="line none"> 1655  * @return &lt; 0 if seq1 &lt; seq2, 0 if seq1 == seq2, &gt; 0 if seq &gt; seq2</div><div id="1656" class="line none"> 1656  */</div><div id="1657" class="line none"> 1657 static inline int32_t <a href="net_ip.h.html#1657">net_tcp_seq_cmp</a>(uint32_t seq1, uint32_t seq2)</div><div id="1658" class="line none"> 1658 {</div><div id="1659" class="line none"> 1659         return (int32_t)(seq1 - seq2);</div><div id="1660" class="line none"> 1660 }</div><div id="1661" class="line none"> 1661 </div><div id="1662" class="line none"> 1662 /**</div><div id="1663" class="line none"> 1663  * @brief Check that one TCP sequence number is greater.</div><div id="1664" class="line none"> 1664  *</div><div id="1665" class="line none"> 1665  * @details This is convenience function on top of net_tcp_seq_cmp().</div><div id="1666" class="line none"> 1666  *</div><div id="1667" class="line none"> 1667  * @param seq1 First sequence number</div><div id="1668" class="line none"> 1668  * @param seq2 Seconds sequence number</div><div id="1669" class="line none"> 1669  *</div><div id="1670" class="line none"> 1670  * @return True if seq &gt; seq2</div><div id="1671" class="line none"> 1671  */</div><div id="1672" class="line none"> 1672 static inline bool <a href="net_ip.h.html#1672">net_tcp_seq_greater</a>(uint32_t seq1, uint32_t seq2)</div><div id="1673" class="line none"> 1673 {</div><div id="1674" class="line none"> 1674         return <a href="net_ip.h.html#1657">net_tcp_seq_cmp</a>(seq1, seq2) &gt; 0;</div><div id="1675" class="line none"> 1675 }</div><div id="1676" class="line none"> 1676 </div><div id="1677" class="line none"> 1677 /**</div><div id="1678" class="line none"> 1678  * @brief Convert a string of hex values to array of bytes.</div><div id="1679" class="line none"> 1679  *</div><div id="1680" class="line none"> 1680  * @details The syntax of the string is "ab:02:98:fa:42:01"</div><div id="1681" class="line none"> 1681  *</div><div id="1682" class="line none"> 1682  * @param buf Pointer to memory where the bytes are written.</div><div id="1683" class="line none"> 1683  * @param buf_len Length of the memory area.</div><div id="1684" class="line none"> 1684  * @param src String of bytes.</div><div id="1685" class="line none"> 1685  *</div><div id="1686" class="line none"> 1686  * @return 0 if ok, &lt;0 if error</div><div id="1687" class="line none"> 1687  */</div><div id="1688" class="line none"> 1688 int net_bytes_from_str(uint8_t *buf, int buf_len, const char *<a href="net_ip.h.html#530">src</a>);</div><div id="1689" class="line none"> 1689 </div><div id="1690" class="line none"> 1690 /**</div><div id="1691" class="line none"> 1691  * @brief Convert Tx network packet priority to traffic class so we can place</div><div id="1692" class="line none"> 1692  * the packet into correct Tx queue.</div><div id="1693" class="line none"> 1693  *</div><div id="1694" class="line none"> 1694  * @param prio Network priority</div><div id="1695" class="line none"> 1695  *</div><div id="1696" class="line none"> 1696  * @return Tx traffic class that handles that priority network traffic.</div><div id="1697" class="line none"> 1697  */</div><div id="1698" class="line none"> 1698 int net_tx_priority2tc(enum <a href="net_ip.h.html#477">net_priority</a> prio);</div><div id="1699" class="line none"> 1699 </div><div id="1700" class="line none"> 1700 /**</div><div id="1701" class="line none"> 1701  * @brief Convert Rx network packet priority to traffic class so we can place</div><div id="1702" class="line none"> 1702  * the packet into correct Rx queue.</div><div id="1703" class="line none"> 1703  *</div><div id="1704" class="line none"> 1704  * @param prio Network priority</div><div id="1705" class="line none"> 1705  *</div><div id="1706" class="line none"> 1706  * @return Rx traffic class that handles that priority network traffic.</div><div id="1707" class="line none"> 1707  */</div><div id="1708" class="line none"> 1708 int net_rx_priority2tc(enum <a href="net_ip.h.html#477">net_priority</a> prio);</div><div id="1709" class="line none"> 1709 </div><div id="1710" class="line none"> 1710 /**</div><div id="1711" class="line none"> 1711  * @brief Convert network packet VLAN priority to network packet priority so we</div><div id="1712" class="line none"> 1712  * can place the packet into correct queue.</div><div id="1713" class="line none"> 1713  *</div><div id="1714" class="line none"> 1714  * @param priority VLAN priority</div><div id="1715" class="line none"> 1715  *</div><div id="1716" class="line none"> 1716  * @return Network priority</div><div id="1717" class="line none"> 1717  */</div><div id="1718" class="line none"> 1718 static inline enum <a href="net_ip.h.html#477">net_priority</a> <a href="net_ip.h.html#1718">net_vlan2priority</a>(uint8_t <a href="../../../subsys/net/lib/dns/dns_pack.h.html#170">priority</a>)</div><div id="1719" class="line none"> 1719 {</div><div id="1720" class="line none"> 1720         /* Map according to IEEE 802.1Q */</div><div id="1721" class="line none"> 1721         static const uint8_t vlan2priority[] = {</div><div id="1722" class="line none"> 1722                 <a href="net_ip.h.html#479">NET_PRIORITY_BE</a>,</div><div id="1723" class="line none"> 1723                 <a href="net_ip.h.html#478">NET_PRIORITY_BK</a>,</div><div id="1724" class="line none"> 1724                 <a href="net_ip.h.html#480">NET_PRIORITY_EE</a>,</div><div id="1725" class="line none"> 1725                 <a href="net_ip.h.html#481">NET_PRIORITY_CA</a>,</div><div id="1726" class="line none"> 1726                 <a href="net_ip.h.html#482">NET_PRIORITY_VI</a>,</div><div id="1727" class="line none"> 1727                 <a href="net_ip.h.html#483">NET_PRIORITY_VO</a>,</div><div id="1728" class="line none"> 1728                 <a href="net_ip.h.html#484">NET_PRIORITY_IC</a>,</div><div id="1729" class="line none"> 1729                 <a href="net_ip.h.html#485">NET_PRIORITY_NC</a></div><div id="1730" class="line none"> 1730         };</div><div id="1731" class="line none"> 1731 </div><div id="1732" class="line none"> 1732         if (<a href="../../../subsys/net/lib/dns/dns_pack.h.html#170">priority</a> &gt;= ARRAY_SIZE(vlan2priority)) {</div><div id="1733" class="line none"> 1733                 /* Use Best Effort as the default priority */</div><div id="1734" class="line none"> 1734                 return <a href="net_ip.h.html#479">NET_PRIORITY_BE</a>;</div><div id="1735" class="line none"> 1735         }</div><div id="1736" class="line none"> 1736 </div><div id="1737" class="line none"> 1737         return (enum <a href="net_ip.h.html#477">net_priority</a>)vlan2priority[<a href="../../../subsys/net/lib/dns/dns_pack.h.html#170">priority</a>];</div><div id="1738" class="line none"> 1738 }</div><div id="1739" class="line none"> 1739 </div><div id="1740" class="line none"> 1740 /**</div><div id="1741" class="line none"> 1741  * @brief Convert network packet priority to network packet VLAN priority.</div><div id="1742" class="line none"> 1742  *</div><div id="1743" class="line none"> 1743  * @param priority Packet priority</div><div id="1744" class="line none"> 1744  *</div><div id="1745" class="line none"> 1745  * @return VLAN priority (PCP)</div><div id="1746" class="line none"> 1746  */</div><div id="1747" class="line none"> 1747 static inline uint8_t <a href="net_ip.h.html#1747">net_priority2vlan</a>(enum <a href="net_ip.h.html#477">net_priority</a> <a href="../../../subsys/net/lib/dns/dns_pack.h.html#170">priority</a>)</div><div id="1748" class="line none"> 1748 {</div><div id="1749" class="line none"> 1749         /* The conversion works both ways */</div><div id="1750" class="line none"> 1750         return (uint8_t)<a href="net_ip.h.html#1718">net_vlan2priority</a>(<a href="../../../subsys/net/lib/dns/dns_pack.h.html#170">priority</a>);</div><div id="1751" class="line none"> 1751 }</div><div id="1752" class="line none"> 1752 </div><div id="1753" class="line none"> 1753 /**</div><div id="1754" class="line none"> 1754  * @brief Return network address family value as a string. This is only usable</div><div id="1755" class="line none"> 1755  * for debugging.</div><div id="1756" class="line none"> 1756  *</div><div id="1757" class="line none"> 1757  * @param family Network address family code</div><div id="1758" class="line none"> 1758  *</div><div id="1759" class="line none"> 1759  * @return Network address family as a string, or NULL if family is unknown.</div><div id="1760" class="line none"> 1760  */</div><div id="1761" class="line none"> 1761 const char *net_family2str(<a href="net_ip.h.html#164">sa_family_t</a> <a href="net_ip.h.html#395">family</a>);</div><div id="1762" class="line none"> 1762 </div><div id="1763" class="line none"> 1763 /**</div><div id="1764" class="line none"> 1764  * @brief Add IPv6 prefix as a privacy extension filter.</div><div id="1765" class="line none"> 1765  *</div><div id="1766" class="line none"> 1766  * @details Note that the filters can either allow or deny listing.</div><div id="1767" class="line none"> 1767  *</div><div id="1768" class="line none"> 1768  * @param addr IPv6 prefix</div><div id="1769" class="line none"> 1769  * @param is_denylist Tells if this filter is for allowing or denying listing.</div><div id="1770" class="line none"> 1770  *</div><div id="1771" class="line none"> 1771  * @return 0 if ok, &lt;0 if error</div><div id="1772" class="line none"> 1772  */</div><div id="1773" class="line none"> 1773 #if defined(CONFIG_NET_IPV6_PE)</div><div id="1774" class="line none"> 1774 int <a href="net_ip.h.html#1776">net_ipv6_pe_add_filter</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr, bool is_denylist);</div><div id="1775" class="line none"> 1775 #else</div><div id="1776" class="line none"> 1776 static inline int <a href="net_ip.h.html#1776">net_ipv6_pe_add_filter</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr,</div><div id="1777" class="line none"> 1777                                          bool is_denylist)</div><div id="1778" class="line none"> 1778 {</div><div id="1779" class="line none"> 1779         ARG_UNUSED(addr);</div><div id="1780" class="line none"> 1780         ARG_UNUSED(is_denylist);</div><div id="1781" class="line none"> 1781 </div><div id="1782" class="line none"> 1782         return -ENOTSUP;</div><div id="1783" class="line none"> 1783 }</div><div id="1784" class="line none"> 1784 #endif /* CONFIG_NET_IPV6_PE */</div><div id="1785" class="line none"> 1785 </div><div id="1786" class="line none"> 1786 /**</div><div id="1787" class="line none"> 1787  * @brief Delete IPv6 prefix from privacy extension filter list.</div><div id="1788" class="line none"> 1788  *</div><div id="1789" class="line none"> 1789  * @param addr IPv6 prefix</div><div id="1790" class="line none"> 1790  *</div><div id="1791" class="line none"> 1791  * @return 0 if ok, &lt;0 if error</div><div id="1792" class="line none"> 1792  */</div><div id="1793" class="line none"> 1793 #if defined(CONFIG_NET_IPV6_PE)</div><div id="1794" class="line none"> 1794 int <a href="net_ip.h.html#1796">net_ipv6_pe_del_filter</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr);</div><div id="1795" class="line none"> 1795 #else</div><div id="1796" class="line none"> 1796 static inline int <a href="net_ip.h.html#1796">net_ipv6_pe_del_filter</a>(struct <a href="net_ip.h.html#139">in6_addr</a> *addr)</div><div id="1797" class="line none"> 1797 {</div><div id="1798" class="line none"> 1798         ARG_UNUSED(addr);</div><div id="1799" class="line none"> 1799 </div><div id="1800" class="line none"> 1800         return -ENOTSUP;</div><div id="1801" class="line none"> 1801 }</div><div id="1802" class="line none"> 1802 #endif /* CONFIG_NET_IPV6_PE */</div><div id="1803" class="line none"> 1803 </div><div id="1804" class="line none"> 1804 #ifdef __cplusplus</div><div id="1805" class="line none"> 1805 }</div><div id="1806" class="line none"> 1806 #endif</div><div id="1807" class="line none"> 1807 </div><div id="1808" class="line none"> 1808 #include &lt;zephyr/syscalls/net_ip.h&gt;</div><div id="1809" class="line none"> 1809 </div><div id="1810" class="line none"> 1810 /**</div><div id="1811" class="line none"> 1811  * @}</div><div id="1812" class="line none"> 1812  */</div><div id="1813" class="line none"> 1813 </div><div id="1814" class="line none"> 1814 </div><div id="1815" class="line none"> 1815 #endif /* ZEPHYR_INCLUDE_NET_NET_IP_H_ */</div>
</div>
</body>
</html>
